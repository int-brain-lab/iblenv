<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Plotting brain region values on the Swanson flat map &mdash; IBL Library  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with wheel data" href="docs_wheel_moves.html" />
    <link rel="prev" title="Plotting cluster locations on histology slices" href="atlas_plotting_points_on_slice.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            IBL Library
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The Open Neurophysiology Environment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="one_quickstart.html">ONE Quick Start</a></li>
<li class="toctree-l1"><a class="reference external" href="https://int-brain-lab.github.io/ONE/">Full documentation Website for ONE</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Public</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/public_introduction.html">Publicly available IBL data</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_release_behavior.html">Data Release - Behavior</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/data_release_pilot.html">Data Release - Pilot Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_release_repro_ephys.html">Data Release - Reproducible Ephys Paper</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_release_brainwidemap.html">Data Release - Brain Wide Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_release_spikesorting_benchmarks.html">Data Release - Spike sorting benchmark datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/information_contact.html">Information and troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exploring IBL Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data_structure.html">Get to know the datasets and folder structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_download.html">Download the public datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../loading_examples.html">Loading Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_installation.html">Unified Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09_contribution.html">How to contribute</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples &amp; Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../atlas_examples.html">Atlas Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="atlas_mapping.html">Atlas mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="atlas_plotting_scalar_on_slice.html">Plotting brain region values on histology slices</a></li>
<li class="toctree-l2"><a class="reference internal" href="atlas_dorsal_cortex_flatmap.html">Plotting brain region values on cortical flatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="atlas_circular_pyramidal_flatmap.html">Plotting brain region values on circular flatmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="atlas_plotting_points_on_slice.html">Plotting cluster locations on histology slices</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Plotting brain region values on the Swanson flat map</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#The-swanson-flatmap-with-annotations">The swanson flatmap with annotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Plotting-values-on-the-swanson-flatmap">Plotting values on the swanson flatmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Lateralized-display">Lateralized display</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Portrait-orientation">Portrait orientation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="docs_wheel_moves.html">Working with wheel data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../010_api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IBL Library</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../atlas_examples.html">Atlas Examples</a></li>
      <li class="breadcrumb-item active">Plotting brain region values on the Swanson flat map</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks_external/atlas_swanson_flatmap.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Plotting-brain-region-values-on-the-Swanson-flat-map">
<h1>Plotting brain region values on the Swanson flat map<a class="headerlink" href="#Plotting-brain-region-values-on-the-Swanson-flat-map" title="Permalink to this heading"></a></h1>
<p>The Swanson flatmap is a 2D representation of the mouse brain to facilitate comparative analysis of brain data. We extended the mouse atlas presented by <a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1002/cne.24966?casa_token=kRb4fuUae6wAAAAA%3AHoiNx1MNVgZNUXT-MZN_mU6LAjKBiz5OE5cFj2Aj-GUE9l-oBllFUaM11XwCtEbpJyxKrwaMRnXC7MjY">Hahn et al.</a> to interface programmatically with the Allen Atlas regions.</p>
<section id="The-swanson-flatmap-with-annotations">
<h2>The swanson flatmap with annotations<a class="headerlink" href="#The-swanson-flatmap-with-annotations" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">ibllib.atlas.flatmaps</span> <span class="kn">import</span> <span class="n">plot_swanson</span>
<span class="kn">from</span> <span class="nn">ibllib.atlas</span> <span class="kn">import</span> <span class="n">BrainRegions</span>
<span class="n">br</span> <span class="o">=</span> <span class="n">BrainRegions</span><span class="p">()</span>

<span class="n">plot_swanson</span><span class="p">(</span><span class="n">br</span><span class="o">=</span><span class="n">br</span><span class="p">,</span> <span class="n">annotate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/runner/work/iblenv/ibllib-repo/ibllib/atlas/regions.py:439: RuntimeWarning: invalid value encountered in cast
  level=df_regions.depth.to_numpy().astype(np.uint16),
/home/runner/work/iblenv/ibllib-repo/ibllib/atlas/regions.py:441: RuntimeWarning: invalid value encountered in cast
  order=df_regions.graph_order.to_numpy().astype(np.uint16))
/home/runner/Downloads/ONE/openalyx.internationalbrainlab.org/histology/ATLAS/Needles/Allen/flatmaps/swanson2allen.npz: 100%|██████████| 498k/498k [00:00&lt;00:00, 2.32MB/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>Out[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_external_atlas_swanson_flatmap_3_2.png" src="../_images/notebooks_external_atlas_swanson_flatmap_3_2.png" />
</div>
</div>
</section>
<section id="Plotting-values-on-the-swanson-flatmap">
<h2>Plotting values on the swanson flatmap<a class="headerlink" href="#Plotting-values-on-the-swanson-flatmap" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># prepare array of acronyms</span>
<span class="n">acronyms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;VPLpc&#39;</span><span class="p">,</span> <span class="s1">&#39;PO&#39;</span><span class="p">,</span> <span class="s1">&#39;LP&#39;</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">,</span> <span class="s1">&#39;CA1&#39;</span><span class="p">,</span> <span class="s1">&#39;PTLp&#39;</span><span class="p">,</span> <span class="s1">&#39;MRN&#39;</span><span class="p">,</span> <span class="s1">&#39;APN&#39;</span><span class="p">,</span> <span class="s1">&#39;POL&#39;</span><span class="p">,</span>
       <span class="s1">&#39;VISam&#39;</span><span class="p">,</span> <span class="s1">&#39;MY&#39;</span><span class="p">,</span> <span class="s1">&#39;PGRNl&#39;</span><span class="p">,</span> <span class="s1">&#39;IRN&#39;</span><span class="p">,</span> <span class="s1">&#39;PARN&#39;</span><span class="p">,</span> <span class="s1">&#39;SPVI&#39;</span><span class="p">,</span> <span class="s1">&#39;NTS&#39;</span><span class="p">,</span> <span class="s1">&#39;SPIV&#39;</span><span class="p">,</span>
       <span class="s1">&#39;NOD&#39;</span><span class="p">,</span> <span class="s1">&#39;IP&#39;</span><span class="p">,</span> <span class="s1">&#39;AON&#39;</span><span class="p">,</span> <span class="s1">&#39;ORBl&#39;</span><span class="p">,</span> <span class="s1">&#39;AId&#39;</span><span class="p">,</span> <span class="s1">&#39;MOs&#39;</span><span class="p">,</span> <span class="s1">&#39;GRN&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;CENT&#39;</span><span class="p">,</span>
       <span class="s1">&#39;CUL&#39;</span><span class="p">,</span> <span class="s1">&#39;COApm&#39;</span><span class="p">,</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span> <span class="s1">&#39;CA2&#39;</span><span class="p">,</span> <span class="s1">&#39;CA3&#39;</span><span class="p">,</span> <span class="s1">&#39;HY&#39;</span><span class="p">,</span> <span class="s1">&#39;ZI&#39;</span><span class="p">,</span> <span class="s1">&#39;MGv&#39;</span><span class="p">,</span> <span class="s1">&#39;LGd&#39;</span><span class="p">,</span>
       <span class="s1">&#39;LHA&#39;</span><span class="p">,</span> <span class="s1">&#39;SF&#39;</span><span class="p">,</span> <span class="s1">&#39;TRS&#39;</span><span class="p">,</span> <span class="s1">&#39;PVT&#39;</span><span class="p">,</span> <span class="s1">&#39;LSc&#39;</span><span class="p">,</span> <span class="s1">&#39;ACAv&#39;</span><span class="p">,</span> <span class="s1">&#39;ACAd&#39;</span><span class="p">,</span> <span class="s1">&#39;MDRNv&#39;</span><span class="p">,</span> <span class="s1">&#39;MDRNd&#39;</span><span class="p">,</span>
       <span class="s1">&#39;COPY&#39;</span><span class="p">,</span> <span class="s1">&#39;PRM&#39;</span><span class="p">,</span> <span class="s1">&#39;DCO&#39;</span><span class="p">,</span> <span class="s1">&#39;DN&#39;</span><span class="p">,</span> <span class="s1">&#39;SIM&#39;</span><span class="p">,</span> <span class="s1">&#39;MEA&#39;</span><span class="p">,</span> <span class="s1">&#39;SI&#39;</span><span class="p">,</span> <span class="s1">&#39;RT&#39;</span><span class="p">,</span> <span class="s1">&#39;MOp&#39;</span><span class="p">,</span> <span class="s1">&#39;PCG&#39;</span><span class="p">,</span>
       <span class="s1">&#39;ICd&#39;</span><span class="p">,</span> <span class="s1">&#39;CS&#39;</span><span class="p">,</span> <span class="s1">&#39;PAG&#39;</span><span class="p">,</span> <span class="s1">&#39;SCdg&#39;</span><span class="p">,</span> <span class="s1">&#39;SCiw&#39;</span><span class="p">,</span> <span class="s1">&#39;VCO&#39;</span><span class="p">,</span> <span class="s1">&#39;ANcr1&#39;</span><span class="p">,</span> <span class="s1">&#39;ENTm&#39;</span><span class="p">,</span> <span class="s1">&#39;ENTl&#39;</span><span class="p">,</span>
       <span class="s1">&#39;NOT&#39;</span><span class="p">,</span> <span class="s1">&#39;VPM&#39;</span><span class="p">,</span> <span class="s1">&#39;VAL&#39;</span><span class="p">,</span> <span class="s1">&#39;VPL&#39;</span><span class="p">,</span> <span class="s1">&#39;CP&#39;</span><span class="p">,</span> <span class="s1">&#39;SSp-ul&#39;</span><span class="p">,</span> <span class="s1">&#39;MV&#39;</span><span class="p">,</span> <span class="s1">&#39;VISl&#39;</span><span class="p">,</span> <span class="s1">&#39;LGv&#39;</span><span class="p">,</span>
       <span class="s1">&#39;SSp-bfd&#39;</span><span class="p">,</span> <span class="s1">&#39;ANcr2&#39;</span><span class="p">,</span> <span class="s1">&#39;DEC&#39;</span><span class="p">,</span> <span class="s1">&#39;LD&#39;</span><span class="p">,</span> <span class="s1">&#39;SSp-ll&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;SUT&#39;</span><span class="p">,</span> <span class="s1">&#39;PB&#39;</span><span class="p">,</span> <span class="s1">&#39;CUN&#39;</span><span class="p">,</span>
       <span class="s1">&#39;ICc&#39;</span><span class="p">,</span> <span class="s1">&#39;PAA&#39;</span><span class="p">,</span> <span class="s1">&#39;EPv&#39;</span><span class="p">,</span> <span class="s1">&#39;BLAa&#39;</span><span class="p">,</span> <span class="s1">&#39;CEAl&#39;</span><span class="p">,</span> <span class="s1">&#39;GPe&#39;</span><span class="p">,</span> <span class="s1">&#39;PPN&#39;</span><span class="p">,</span> <span class="s1">&#39;SCig&#39;</span><span class="p">,</span> <span class="s1">&#39;SCop&#39;</span><span class="p">,</span>
       <span class="s1">&#39;SCsg&#39;</span><span class="p">,</span> <span class="s1">&#39;RSPd&#39;</span><span class="p">,</span> <span class="s1">&#39;RSPagl&#39;</span><span class="p">,</span> <span class="s1">&#39;VISp&#39;</span><span class="p">,</span> <span class="s1">&#39;HPF&#39;</span><span class="p">,</span> <span class="s1">&#39;MGm&#39;</span><span class="p">,</span> <span class="s1">&#39;SGN&#39;</span><span class="p">,</span> <span class="s1">&#39;TTd&#39;</span><span class="p">,</span> <span class="s1">&#39;DP&#39;</span><span class="p">,</span>
       <span class="s1">&#39;ILA&#39;</span><span class="p">,</span> <span class="s1">&#39;PL&#39;</span><span class="p">,</span> <span class="s1">&#39;RSPv&#39;</span><span class="p">,</span> <span class="s1">&#39;SSp-n&#39;</span><span class="p">,</span> <span class="s1">&#39;ORBm&#39;</span><span class="p">,</span> <span class="s1">&#39;ORBvl&#39;</span><span class="p">,</span> <span class="s1">&#39;PRNc&#39;</span><span class="p">,</span> <span class="s1">&#39;ACB&#39;</span><span class="p">,</span>
       <span class="s1">&#39;SPFp&#39;</span><span class="p">,</span> <span class="s1">&#39;VM&#39;</span><span class="p">,</span> <span class="s1">&#39;SUV&#39;</span><span class="p">,</span> <span class="s1">&#39;OT&#39;</span><span class="p">,</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="s1">&#39;BST&#39;</span><span class="p">,</span> <span class="s1">&#39;LSv&#39;</span><span class="p">,</span> <span class="s1">&#39;LSr&#39;</span><span class="p">,</span> <span class="s1">&#39;UVU&#39;</span><span class="p">,</span>
       <span class="s1">&#39;SSp-m&#39;</span><span class="p">,</span> <span class="s1">&#39;LA&#39;</span><span class="p">,</span> <span class="s1">&#39;CM&#39;</span><span class="p">,</span> <span class="s1">&#39;MD&#39;</span><span class="p">,</span> <span class="s1">&#39;SMT&#39;</span><span class="p">,</span> <span class="s1">&#39;PFL&#39;</span><span class="p">,</span> <span class="s1">&#39;MARN&#39;</span><span class="p">,</span> <span class="s1">&#39;PRE&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
       <span class="s1">&#39;PRNr&#39;</span><span class="p">,</span> <span class="s1">&#39;SSp-tr&#39;</span><span class="p">,</span> <span class="s1">&#39;PIR&#39;</span><span class="p">,</span> <span class="s1">&#39;CTXsp&#39;</span><span class="p">,</span> <span class="s1">&#39;RN&#39;</span><span class="p">,</span> <span class="s1">&#39;PSV&#39;</span><span class="p">,</span> <span class="s1">&#39;SUB&#39;</span><span class="p">,</span> <span class="s1">&#39;LDT&#39;</span><span class="p">,</span> <span class="s1">&#39;PAR&#39;</span><span class="p">,</span>
       <span class="s1">&#39;SPVO&#39;</span><span class="p">,</span> <span class="s1">&#39;TR&#39;</span><span class="p">,</span> <span class="s1">&#39;VISpm&#39;</span><span class="p">,</span> <span class="s1">&#39;MS&#39;</span><span class="p">,</span> <span class="s1">&#39;COApl&#39;</span><span class="p">,</span> <span class="s1">&#39;BMAp&#39;</span><span class="p">,</span> <span class="s1">&#39;AMd&#39;</span><span class="p">,</span> <span class="s1">&#39;ICe&#39;</span><span class="p">,</span> <span class="s1">&#39;TEa&#39;</span><span class="p">,</span>
       <span class="s1">&#39;MOB&#39;</span><span class="p">,</span> <span class="s1">&#39;SNr&#39;</span><span class="p">,</span> <span class="s1">&#39;GU&#39;</span><span class="p">,</span> <span class="s1">&#39;VISC&#39;</span><span class="p">,</span> <span class="s1">&#39;SSs&#39;</span><span class="p">,</span> <span class="s1">&#39;AIp&#39;</span><span class="p">,</span> <span class="s1">&#39;NPC&#39;</span><span class="p">,</span> <span class="s1">&#39;BLAp&#39;</span><span class="p">,</span> <span class="s1">&#39;SPVC&#39;</span><span class="p">,</span>
       <span class="s1">&#39;PYR&#39;</span><span class="p">,</span> <span class="s1">&#39;AV&#39;</span><span class="p">,</span> <span class="s1">&#39;EPd&#39;</span><span class="p">,</span> <span class="s1">&#39;NLL&#39;</span><span class="p">,</span> <span class="s1">&#39;AIv&#39;</span><span class="p">,</span> <span class="s1">&#39;CLA&#39;</span><span class="p">,</span> <span class="s1">&#39;AAA&#39;</span><span class="p">,</span> <span class="s1">&#39;AUDv&#39;</span><span class="p">,</span> <span class="s1">&#39;TRN&#39;</span><span class="p">],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U8&#39;</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">7.76948616</span><span class="p">,</span> <span class="mf">25.51506047</span><span class="p">,</span> <span class="mf">21.31094194</span><span class="p">,</span> <span class="mf">23.11353701</span><span class="p">,</span> <span class="mf">26.18071135</span><span class="p">,</span>
       <span class="mf">16.42116195</span><span class="p">,</span> <span class="mf">22.4522099</span> <span class="p">,</span> <span class="mf">20.04564731</span><span class="p">,</span>  <span class="mf">9.98702368</span><span class="p">,</span> <span class="mf">11.00518771</span><span class="p">,</span>
       <span class="mf">11.23163309</span><span class="p">,</span>  <span class="mf">3.90841049</span><span class="p">,</span> <span class="mf">11.44982496</span><span class="p">,</span>  <span class="mf">7.49984019</span><span class="p">,</span> <span class="mf">10.59146742</span><span class="p">,</span>
        <span class="mf">7.68845853</span><span class="p">,</span> <span class="mf">10.38817938</span><span class="p">,</span>  <span class="mf">6.53187499</span><span class="p">,</span> <span class="mf">14.22331705</span><span class="p">,</span> <span class="mf">19.26731921</span><span class="p">,</span>
       <span class="mf">14.6739601</span> <span class="p">,</span> <span class="mf">10.37711987</span><span class="p">,</span> <span class="mf">19.87087356</span><span class="p">,</span> <span class="mf">12.56497513</span><span class="p">,</span> <span class="mf">11.03204901</span><span class="p">,</span>
       <span class="mf">12.85149192</span><span class="p">,</span> <span class="mf">10.39367399</span><span class="p">,</span>  <span class="mf">5.26234078</span><span class="p">,</span>  <span class="mf">7.36780286</span><span class="p">,</span>  <span class="mf">7.77672633</span><span class="p">,</span>
       <span class="mf">22.30843636</span><span class="p">,</span>  <span class="mf">9.63356153</span><span class="p">,</span> <span class="mf">11.33369508</span><span class="p">,</span>  <span class="mf">7.70210975</span><span class="p">,</span> <span class="mf">14.56984632</span><span class="p">,</span>
        <span class="mf">7.95488849</span><span class="p">,</span>  <span class="mf">9.85956065</span><span class="p">,</span> <span class="mf">10.40381726</span><span class="p">,</span>  <span class="mf">6.31529234</span><span class="p">,</span>  <span class="mf">7.82651245</span><span class="p">,</span>
       <span class="mf">11.3339313</span> <span class="p">,</span> <span class="mf">12.26268021</span><span class="p">,</span>  <span class="mf">8.67874273</span><span class="p">,</span>  <span class="mf">8.07579753</span><span class="p">,</span> <span class="mf">10.14307203</span><span class="p">,</span>
       <span class="mf">10.08081832</span><span class="p">,</span>  <span class="mf">7.88595354</span><span class="p">,</span>  <span class="mf">7.49586605</span><span class="p">,</span> <span class="mf">12.6491355</span> <span class="p">,</span>  <span class="mf">7.92629876</span><span class="p">,</span>
       <span class="mf">12.52110187</span><span class="p">,</span> <span class="mf">14.27405322</span><span class="p">,</span> <span class="mf">25.95808524</span><span class="p">,</span>  <span class="mf">6.52603939</span><span class="p">,</span>  <span class="mf">3.15160563</span><span class="p">,</span>
       <span class="mf">11.60061018</span><span class="p">,</span> <span class="mf">11.1043498</span> <span class="p">,</span>  <span class="mf">8.0733422</span> <span class="p">,</span> <span class="mf">11.71522066</span><span class="p">,</span>  <span class="mf">4.62765218</span><span class="p">,</span>
        <span class="mf">7.49833868</span><span class="p">,</span> <span class="mf">18.78977643</span><span class="p">,</span> <span class="mf">17.00685931</span><span class="p">,</span>  <span class="mf">6.3841865</span> <span class="p">,</span> <span class="mf">21.0516987</span> <span class="p">,</span>
       <span class="mf">13.16635271</span><span class="p">,</span> <span class="mf">13.32514284</span><span class="p">,</span> <span class="mf">39.00407907</span><span class="p">,</span> <span class="mf">10.17439742</span><span class="p">,</span> <span class="mf">10.71338756</span><span class="p">,</span>
       <span class="mf">12.98324876</span><span class="p">,</span>  <span class="mf">9.36698057</span><span class="p">,</span> <span class="mf">18.72583288</span><span class="p">,</span>  <span class="mf">8.86341551</span><span class="p">,</span>  <span class="mf">8.59402471</span><span class="p">,</span>
       <span class="mf">14.40309408</span><span class="p">,</span> <span class="mf">11.2151223</span> <span class="p">,</span>  <span class="mf">8.54318159</span><span class="p">,</span>  <span class="mf">7.27041139</span><span class="p">,</span>  <span class="mf">7.54384726</span><span class="p">,</span>
        <span class="mf">7.12004486</span><span class="p">,</span>  <span class="mf">8.61247715</span><span class="p">,</span>  <span class="mf">6.24836557</span><span class="p">,</span>  <span class="mf">7.61490273</span><span class="p">,</span>  <span class="mf">7.97743213</span><span class="p">,</span>
        <span class="mf">5.90638179</span><span class="p">,</span> <span class="mf">11.18067752</span><span class="p">,</span>  <span class="mf">9.60402511</span><span class="p">,</span> <span class="mf">10.27972062</span><span class="p">,</span>  <span class="mf">4.88568098</span><span class="p">,</span>
        <span class="mf">5.15238733</span><span class="p">,</span>  <span class="mf">9.48240265</span><span class="p">,</span>  <span class="mf">5.5200633</span> <span class="p">,</span> <span class="mf">17.34425384</span><span class="p">,</span> <span class="mf">20.51738915</span><span class="p">,</span>
        <span class="mf">8.67575586</span><span class="p">,</span> <span class="mf">10.13415575</span><span class="p">,</span> <span class="mf">12.55792577</span><span class="p">,</span> <span class="mf">11.28995505</span><span class="p">,</span> <span class="mf">12.01846393</span><span class="p">,</span>
       <span class="mf">16.44519718</span><span class="p">,</span> <span class="mf">11.55540348</span><span class="p">,</span> <span class="mf">12.6760064</span> <span class="p">,</span> <span class="mf">14.59124425</span><span class="p">,</span> <span class="mf">16.08650743</span><span class="p">,</span>
        <span class="mf">5.49252396</span><span class="p">,</span> <span class="mf">14.21853759</span><span class="p">,</span>  <span class="mf">9.80928243</span><span class="p">,</span> <span class="mf">11.1998899</span> <span class="p">,</span>  <span class="mf">8.53843453</span><span class="p">,</span>
        <span class="mf">8.95692822</span><span class="p">,</span>  <span class="mf">7.44622149</span><span class="p">,</span>  <span class="mf">9.41208445</span><span class="p">,</span> <span class="mf">10.00368097</span><span class="p">,</span> <span class="mf">18.36862111</span><span class="p">,</span>
        <span class="mf">5.90905433</span><span class="p">,</span> <span class="mf">18.73273459</span><span class="p">,</span> <span class="mf">10.41462726</span><span class="p">,</span> <span class="mf">10.38639344</span><span class="p">,</span> <span class="mf">13.71164211</span><span class="p">,</span>
        <span class="mf">8.1023596</span> <span class="p">,</span>  <span class="mf">7.57087137</span><span class="p">,</span>  <span class="mf">3.95315742</span><span class="p">,</span> <span class="mf">12.24423806</span><span class="p">,</span> <span class="mf">10.4316517</span> <span class="p">,</span>
       <span class="mf">10.75912468</span><span class="p">,</span>  <span class="mf">9.21246988</span><span class="p">,</span> <span class="mf">21.71756051</span><span class="p">,</span>  <span class="mf">8.55320981</span><span class="p">,</span> <span class="mf">10.69256597</span><span class="p">,</span>
        <span class="mf">8.20796144</span><span class="p">,</span> <span class="mf">24.13594074</span><span class="p">,</span>  <span class="mf">4.55095547</span><span class="p">,</span> <span class="mf">12.43055174</span><span class="p">,</span>  <span class="mf">7.00374928</span><span class="p">,</span>
        <span class="mf">4.72499044</span><span class="p">,</span>  <span class="mf">6.22081559</span><span class="p">,</span>  <span class="mf">6.50700078</span><span class="p">,</span>  <span class="mf">6.73499461</span><span class="p">,</span> <span class="mf">12.77964412</span><span class="p">,</span>
        <span class="mf">8.8475468</span> <span class="p">,</span> <span class="mf">11.20443401</span><span class="p">,</span>  <span class="mf">6.59475644</span><span class="p">,</span>  <span class="mf">8.59815892</span><span class="p">,</span>  <span class="mf">7.16696761</span><span class="p">,</span>
       <span class="mf">10.62813483</span><span class="p">,</span>  <span class="mf">7.77992602</span><span class="p">,</span> <span class="mf">16.02889234</span><span class="p">,</span>  <span class="mf">9.21649532</span><span class="p">,</span>  <span class="mf">7.08618021</span><span class="p">,</span>
        <span class="mf">5.56980282</span><span class="p">,</span>  <span class="mf">3.61976479</span><span class="p">,</span>  <span class="mf">6.86178595</span><span class="p">,</span> <span class="mf">13.44050831</span><span class="p">,</span> <span class="mf">11.9525432</span> <span class="p">,</span>
        <span class="mf">7.21974504</span><span class="p">,</span>  <span class="mf">6.28513041</span><span class="p">,</span>  <span class="mf">6.8381433</span> <span class="p">,</span>  <span class="mf">5.93095918</span><span class="p">,</span>  <span class="mf">8.12844537</span><span class="p">,</span>
        <span class="mf">8.62486916</span><span class="p">])</span>


<span class="c1"># and display on a single hemishphere, using a blue colormap</span>
<span class="n">plot_swanson</span><span class="p">(</span><span class="n">acronyms</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">br</span><span class="o">=</span><span class="n">br</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/numpy/lib/nanfunctions.py:1217: RuntimeWarning: All-NaN slice encountered
  return function_base._ureduce(a, func=_nanmedian, keepdims=keepdims,
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>Out[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_external_atlas_swanson_flatmap_5_2.png" src="../_images/notebooks_external_atlas_swanson_flatmap_5_2.png" />
</div>
</div>
<section id="Lateralized-display">
<h3>Lateralized display<a class="headerlink" href="#Lateralized-display" title="Permalink to this heading"></a></h3>
<p>A more advanced example is when each hemisphere is assigned a different value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># In our atlas convention, differentiating between hemishperes is done using negative indices</span>
<span class="n">regions_rl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">br</span><span class="o">.</span><span class="n">acronym2id</span><span class="p">(</span><span class="n">acronyms</span><span class="p">),</span> <span class="o">-</span><span class="n">br</span><span class="o">.</span><span class="n">acronym2id</span><span class="p">(</span><span class="n">acronyms</span><span class="p">)]</span>
<span class="c1"># assign random values for the sake of this example</span>
<span class="n">values_rl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">regions_rl</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="c1"># display with an explicit dual hemisphere setup</span>
<span class="n">plot_swanson</span><span class="p">(</span><span class="n">regions_rl</span><span class="p">,</span> <span class="n">values_rl</span><span class="p">,</span> <span class="n">hemisphere</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span> <span class="n">br</span><span class="o">=</span><span class="n">br</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>Out[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_external_atlas_swanson_flatmap_7_1.png" src="../_images/notebooks_external_atlas_swanson_flatmap_7_1.png" />
</div>
</div>
</section>
</section>
<section id="Portrait-orientation">
<h2>Portrait orientation<a class="headerlink" href="#Portrait-orientation" title="Permalink to this heading"></a></h2>
<p>One can also mirror the hemishperes and orient the display in portrait mode.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ibllib.atlas.flatmaps</span> <span class="kn">import</span> <span class="n">plot_swanson</span>
<span class="kn">from</span> <span class="nn">ibllib.atlas</span> <span class="kn">import</span> <span class="n">BrainRegions</span>

<span class="n">br</span> <span class="o">=</span> <span class="n">BrainRegions</span><span class="p">()</span>

<span class="n">plot_swanson</span><span class="p">(</span><span class="n">acronyms</span><span class="o">=</span><span class="n">acronyms</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;portrait&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greens&#39;</span><span class="p">,</span> <span class="n">hemisphere</span><span class="o">=</span><span class="s1">&#39;mirror&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/runner/work/iblenv/ibllib-repo/ibllib/atlas/regions.py:439: RuntimeWarning: invalid value encountered in cast
  level=df_regions.depth.to_numpy().astype(np.uint16),
/home/runner/work/iblenv/ibllib-repo/ibllib/atlas/regions.py:441: RuntimeWarning: invalid value encountered in cast
  order=df_regions.graph_order.to_numpy().astype(np.uint16))
/home/runner/work/iblenv/ibllib-repo/ibllib/atlas/regions.py:439: RuntimeWarning: invalid value encountered in cast
  level=df_regions.depth.to_numpy().astype(np.uint16),
/home/runner/work/iblenv/ibllib-repo/ibllib/atlas/regions.py:441: RuntimeWarning: invalid value encountered in cast
  order=df_regions.graph_order.to_numpy().astype(np.uint16))
/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/numpy/lib/nanfunctions.py:1217: RuntimeWarning: All-NaN slice encountered
  return function_base._ureduce(a, func=_nanmedian, keepdims=keepdims,
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>Out[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;Axes: &gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_external_atlas_swanson_flatmap_9_2.png" src="../_images/notebooks_external_atlas_swanson_flatmap_9_2.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="atlas_plotting_points_on_slice.html" class="btn btn-neutral float-left" title="Plotting cluster locations on histology slices" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="docs_wheel_moves.html" class="btn btn-neutral float-right" title="Working with wheel data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, International Brain Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>