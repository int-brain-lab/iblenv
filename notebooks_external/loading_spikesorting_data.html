<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Loading SpikeSorting Data &mdash; IBL Library  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Loading Spike Waveforms" href="loading_spike_waveforms.html" />
    <link rel="prev" title="Loading Wheel Data" href="loading_wheel_data.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> IBL Library
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The Open Neurophysiology Environment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="one_quickstart.html">ONE Quick Start</a></li>
<li class="toctree-l1"><a class="reference external" href="https://int-brain-lab.github.io/ONE/">Full documentation Website for ONE</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DataJoint</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dj_docs/dj_introduction.html">Introduction to DataJoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dj_docs/dj_public.html">Publicly available IBL data via Datajoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dj_docs/dj_credentials.html">DataJoint credentials for internal IBL users</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Public</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/public_introduction.html">Publicly available IBL data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/data_release_pilot.html">Data Release - Pilot Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_release_repro_ephys.html">Data Release - Reproducible Ephys Paper</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exploring IBL Data</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../loading_examples.html">Loading Data</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="loading_trials_data.html">Loading Trials Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="loading_wheel_data.html">Loading Wheel Data</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Loading SpikeSorting Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Relevant-Alf-objects">Relevant Alf objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Loading">Loading</a></li>
<li class="toctree-l3"><a class="reference internal" href="#More-details">More details</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Important-information">Important information</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Useful-modules">Useful modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Exploring-spikesorting-data">Exploring spikesorting data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Example-1:-Loading-different-spikesorting-versions">Example 1: Loading different spikesorting versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Example-2:-Loading-additional-data">Example 2: Loading additional data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Example-3:-Compute-firing-rate-across-session">Example 3: Compute firing rate across session</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Example-4:-Find-clusters-labelled-as-good">Example 4: Find clusters labelled as good</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Other-relevant-examples">Other relevant examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="loading_spike_waveforms.html">Loading Spike Waveforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="loading_passive_data.html">Loading Passive Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="loading_ephys_data.html">Loading Ephys Data (AP and LFP band)</a></li>
<li class="toctree-l2"><a class="reference internal" href="loading_raw_ephys_data.html">Loading Raw Ephys Data (AP and LFP band)</a></li>
<li class="toctree-l2"><a class="reference internal" href="loading_video_data.html">Loading Video Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="loading_raw_video_data.html">Loading Raw Video Data</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_installation.html">Unified Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09_contribution.html">How to contribute</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples &amp; Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../atlas_examples.html">Atlas Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="docs_wheel_moves.html">Working with wheel data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/dj_intro/dj_intro.html">Datajoint Introductory Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/dj_basics/dj_basics.html">Exploring the IBL Data Pipeline</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../010_api_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Detailed Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IBL Library</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../loading_examples.html">Loading Data</a> &raquo;</li>
      <li>Loading SpikeSorting Data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks_external/loading_spikesorting_data.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Loading-SpikeSorting-Data">
<h1>Loading SpikeSorting Data<a class="headerlink" href="#Loading-SpikeSorting-Data" title="Permalink to this headline"></a></h1>
<p>Spikesorted output of electrophysiology data.</p>
<section id="Relevant-Alf-objects">
<h2>Relevant Alf objects<a class="headerlink" href="#Relevant-Alf-objects" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>channels</p></li>
<li><p>clusters</p></li>
<li><p>spikes</p></li>
</ul>
</section>
<section id="Loading">
<h2>Loading<a class="headerlink" href="#Loading" title="Permalink to this headline"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">one.api</span> <span class="kn">import</span> <span class="n">ONE</span>
<span class="kn">from</span> <span class="nn">brainbox.io.one</span> <span class="kn">import</span> <span class="n">SpikeSortingLoader</span>
<span class="kn">from</span> <span class="nn">ibllib.atlas</span> <span class="kn">import</span> <span class="n">AllenAtlas</span>

<span class="n">one</span> <span class="o">=</span> <span class="n">ONE</span><span class="p">()</span>
<span class="n">ba</span> <span class="o">=</span> <span class="n">AllenAtlas</span><span class="p">()</span>
<span class="n">pid</span> <span class="o">=</span> <span class="s1">&#39;da8dfec1-d265-44e8-84ce-6ae9c109b8bd&#39;</span>

<span class="n">sl</span> <span class="o">=</span> <span class="n">SpikeSortingLoader</span><span class="p">(</span><span class="n">pid</span><span class="o">=</span><span class="n">pid</span><span class="p">,</span> <span class="n">one</span><span class="o">=</span><span class="n">one</span><span class="p">,</span> <span class="n">atlas</span><span class="o">=</span><span class="n">ba</span><span class="p">)</span>
<span class="n">spikes</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">channels</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">load_spike_sorting</span><span class="p">()</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">merge_clusters</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">channels</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="More-details">
<h2>More details<a class="headerlink" href="#More-details" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.google.com/document/d/1OqIqqakPakHXRAwceYLwFY9gOrm8_P62XIfCTnHwstg/edit#heading=h.5houj8bng5o">Description of spikesorting datasets</a></p></li>
<li><p>Available spikesorting algorithms</p>
<ul>
<li><p><a class="reference external" href="https://github.com/int-brain-lab/pykilosort#readme">pykilosort</a> (All data)</p></li>
<li><p><a class="reference external" href="https://github.com/MouseLand/Kilosort/releases/tag/v2.5">Kilosort 2.5</a> (Most data collected before August 2021)</p></li>
</ul>
</li>
</ul>
</section>
<section id="Important-information">
<h2>Important information<a class="headerlink" href="#Important-information" title="Permalink to this headline"></a></h2>
<ol class="arabic simple">
<li><p>Data sorted with pykilosort is loaded by default. If the pykilosort spikesorting data is not available, the matlab kilosort 2.5 version will be loaded. See <a class="reference external" href="#Example-1:-Loading-different-spikesorting-versions">Example 1</a> for more information.</p></li>
<li><p>The channel locations in the brain can come from several sources. it will load the most advanced version of the histology available, regardless of the spike sorting version loaded.
The steps, from most to least advanced, are:</p>
<ul class="simple">
<li><p><strong>alf</strong>: the final version of channel locations, same as resolved with the difference that data has been written out to files</p></li>
<li><p><strong>resolved</strong>: channel location alignments have been agreed upon</p></li>
<li><p><strong>aligned</strong>: channel locations have been aligned, but review or other alignments are pending, potentially not accurate</p></li>
<li><p><strong>traced</strong>: the histology track has been recovered from microscopy, however the depths may not match, inacurate data</p></li>
</ul>
</li>
<li><p>The attributes <code class="docutils literal notranslate"><span class="pre">mlapdv</span></code>, <code class="docutils literal notranslate"><span class="pre">atlas_ids</span></code> and <code class="docutils literal notranslate"><span class="pre">acronyms</span></code> in the <code class="docutils literal notranslate"><span class="pre">clusters</span></code> and <code class="docutils literal notranslate"><span class="pre">channels</span></code> objects are only available for probe insertions where <code class="docutils literal notranslate"><span class="pre">sl.histology</span></code> is equal to <strong>traced</strong>, <strong>aligned</strong>, <strong>resolved</strong> or <strong>alf</strong>.</p></li>
<li><p>The cluster and channel locations in the brain are only considered final for probe insertions with <code class="docutils literal notranslate"><span class="pre">sl.histology='resolved'</span></code>or <code class="docutils literal notranslate"><span class="pre">sl.histology='alf'</span></code>.</p></li>
</ol>
</section>
<section id="Useful-modules">
<h2>Useful modules<a class="headerlink" href="#Useful-modules" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://int-brain-lab.github.io/iblenv/_autosummary/brainbox.io.one.html#brainbox.io.one.SpikeSortingLoader">brainbox.io.one.SpikeSortingLoader</a></p></li>
<li><p><a class="reference external" href="https://int-brain-lab.github.io/iblenv/_autosummary/brainbox.ephys_plots.html">brainbox.ephys_plots</a></p></li>
<li><p><a class="reference external" href="https://int-brain-lab.github.io/iblenv/_autosummary/brainbox.population.decode.html#brainbox.population.decode.get_spike_counts_in_bins">brainbox.population.decode.get_spike_counts_in_bins</a></p></li>
<li><p><a class="reference external" href="https://int-brain-lab.github.io/iblenv/_autosummary/brainbox.processing.html#brainbox.processing">brainbox.processing</a></p></li>
<li><p><a class="reference external" href="https://int-brain-lab.github.io/iblenv/_autosummary/brainbox.metrics.single_units.html#module-brainbox.metrics.single_units">brainbox.metrics.single_units</a></p></li>
</ul>
</section>
<section id="Exploring-spikesorting-data">
<h2>Exploring spikesorting data<a class="headerlink" href="#Exploring-spikesorting-data" title="Permalink to this headline"></a></h2>
<section id="Example-1:-Loading-different-spikesorting-versions">
<h3>Example 1: Loading different spikesorting versions<a class="headerlink" href="#Example-1:-Loading-different-spikesorting-versions" title="Permalink to this headline"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># By default, if available, the data spikesorted with pykilosort is loaded.</span>
<span class="c1"># To find the spikesorting version that is loaded we can use</span>
<span class="n">sl</span><span class="o">.</span><span class="n">collection</span>

<span class="c1"># To see all available spikesorted data for this probe insertion we can list the collections.</span>
<span class="c1"># N.B. ks2.5 matlab spikesorted data is stored in the alf/probe00 folder</span>
<span class="n">sl</span><span class="o">.</span><span class="n">collections</span>

<span class="c1"># The following can be used to load a specific version of spikesorting</span>

<span class="c1"># pykilosort version</span>
<span class="n">spikes</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">channels</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">load_spike_sorting</span><span class="p">(</span><span class="n">spike_sorter</span><span class="o">=</span><span class="s1">&#39;pykilosort&#39;</span><span class="p">)</span>

<span class="c1"># ks2.5 matlab version</span>
<span class="n">spikes</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">channels</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">load_spike_sorting</span><span class="p">(</span><span class="n">spike_sorter</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Example-2:-Loading-additional-data">
<h3>Example 2: Loading additional data<a class="headerlink" href="#Example-2:-Loading-additional-data" title="Permalink to this headline"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># The default spikes and cluster attributes loaded are:</span>
<span class="c1"># spikes - amps, clusters, depths, times</span>
<span class="c1"># cluster - channels, depths, metrics</span>

<span class="c1">#Other attributes can additionally be loaded in the following way</span>
<span class="n">spikes</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">channels</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">load_spike_sorting</span><span class="p">(</span><span class="n">dataset_types</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;clusters.amps&#39;</span><span class="p">,</span> <span class="s1">&#39;spikes.samples&#39;</span><span class="p">])</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="n">sl</span><span class="o">.</span><span class="n">merge_clusters</span><span class="p">(</span><span class="n">spikes</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">channels</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Example-3:-Compute-firing-rate-across-session">
<h3>Example 3: Compute firing rate across session<a class="headerlink" href="#Example-3:-Compute-firing-rate-across-session" title="Permalink to this headline"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">brainbox.ephys_plots</span> <span class="kn">import</span> <span class="n">image_fr_plot</span>
<span class="kn">from</span> <span class="nn">brainbox.processing</span> <span class="kn">import</span> <span class="n">bincount2D</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">time_bin</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="c1"># time bin in seconds</span>
<span class="n">depth_bin</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># depth bin in um</span>

<span class="c1"># Remove any nan values</span>
<span class="n">kp_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">spikes</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">]),</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">spikes</span><span class="p">[</span><span class="s1">&#39;depths&#39;</span><span class="p">]))</span>

<span class="n">fr</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">depth</span> <span class="o">=</span> <span class="n">bincount2D</span><span class="p">(</span><span class="n">spikes</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">][</span><span class="n">kp_idx</span><span class="p">],</span> <span class="n">spikes</span><span class="p">[</span><span class="s1">&#39;depths&#39;</span><span class="p">][</span><span class="n">kp_idx</span><span class="p">],</span> <span class="n">time_bin</span><span class="p">,</span> <span class="n">depth_bin</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Example-4:-Find-clusters-labelled-as-good">
<h3>Example 4: Find clusters labelled as good<a class="headerlink" href="#Example-4:-Find-clusters-labelled-as-good" title="Permalink to this headline"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">good_clusterIDs</span> <span class="o">=</span> <span class="n">clusters</span><span class="p">[</span><span class="s1">&#39;cluster_id&#39;</span><span class="p">][</span><span class="n">clusters</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Other-relevant-examples">
<h2>Other relevant examples<a class="headerlink" href="#Other-relevant-examples" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>COMING SOON</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="loading_wheel_data.html" class="btn btn-neutral float-left" title="Loading Wheel Data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="loading_spike_waveforms.html" class="btn btn-neutral float-right" title="Loading Spike Waveforms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, International Brain Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>