

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>brainbox.modeling.glm &mdash; IBL Library  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="brainbox.modeling.parameter" href="brainbox.modeling.parameter.html" />
    <link rel="prev" title="brainbox.modeling.fitting_method" href="brainbox.modeling.fitting_method.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> IBL Library
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../01_overview.html">IBL data structure</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_installation.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../03_one.html">ONE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../04_datajoint.html">Datajoint</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../05_tutorials.html">Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../06_examples.html">Examples</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../07_developers.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="alf.html">alf</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibllib.html">ibllib</a></li>
<li class="toctree-l2"><a class="reference internal" href="oneibl.html">oneibl</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="brainbox.html">brainbox</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="brainbox.behavior.html">brainbox.behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.core.html">brainbox.core</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.experimental.html">brainbox.experimental</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.io.html">brainbox.io</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.lfp.html">brainbox.lfp</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.metrics.html">brainbox.metrics</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="brainbox.modeling.html">brainbox.modeling</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="brainbox.modeling.dataset.html">brainbox.modeling.dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="brainbox.modeling.fitting_method.html">brainbox.modeling.fitting_method</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">brainbox.modeling.glm</a></li>
<li class="toctree-l4"><a class="reference internal" href="brainbox.modeling.parameter.html">brainbox.modeling.parameter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.plot.html">brainbox.plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.population.html">brainbox.population</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.processing.html">brainbox.processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.quality.html">brainbox.quality</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.simulation.html">brainbox.simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.singlecell.html">brainbox.singlecell</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.spike_features.html">brainbox.spike_features</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.task.html">brainbox.task</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.tests.html">brainbox.tests</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IBL Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../07_developers.html">API Reference</a> &raquo;</li>
        
          <li><a href="brainbox.html">brainbox</a> &raquo;</li>
        
          <li><a href="brainbox.modeling.html">brainbox.modeling</a> &raquo;</li>
        
      <li>brainbox.modeling.glm</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/_autosummary/brainbox.modeling.glm.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-brainbox.modeling.glm">
<span id="brainbox-modeling-glm"></span><h1>brainbox.modeling.glm<a class="headerlink" href="#module-brainbox.modeling.glm" title="Permalink to this headline">¶</a></h1>
<p>GLM fitting utilities based on NeuroGLM by Il Memming Park, Jonathan Pillow:</p>
<p><a class="reference external" href="https://github.com/pillowlab/neuroGLM">https://github.com/pillowlab/neuroGLM</a></p>
<p>Berk Gercek
International Brain Lab, 2020</p>
<p class="rubric">Functions</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.modeling.glm.convbasis" title="brainbox.modeling.glm.convbasis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convbasis</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.modeling.glm.d_neglog" title="brainbox.modeling.glm.d_neglog"><code class="xref py py-obj docutils literal notranslate"><span class="pre">d_neglog</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.modeling.glm.dd_neglog" title="brainbox.modeling.glm.dd_neglog"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dd_neglog</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.modeling.glm.denseconv" title="brainbox.modeling.glm.denseconv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">denseconv</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.modeling.glm.full_rcos" title="brainbox.modeling.glm.full_rcos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">full_rcos</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.modeling.glm.neglog" title="brainbox.modeling.glm.neglog"><code class="xref py py-obj docutils literal notranslate"><span class="pre">neglog</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.modeling.glm.raised_cosine" title="brainbox.modeling.glm.raised_cosine"><code class="xref py py-obj docutils literal notranslate"><span class="pre">raised_cosine</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p class="rubric">Classes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.modeling.glm.NeuralGLM" title="brainbox.modeling.glm.NeuralGLM"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NeuralGLM</span></code></a></p></td>
<td><p>Generalized Linear Model which seeks to describe spiking activity as the output of a poisson process.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="brainbox.modeling.glm.NeuralGLM">
<em class="property">class </em><code class="sig-name descname">NeuralGLM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trialsdf</span></em>, <em class="sig-param"><span class="n">spk_times</span></em>, <em class="sig-param"><span class="n">spk_clu</span></em>, <em class="sig-param"><span class="n">vartypes</span></em>, <em class="sig-param"><span class="n">train</span><span class="o">=</span><span class="default_value">0.8</span></em>, <em class="sig-param"><span class="n">binwidth</span><span class="o">=</span><span class="default_value">0.02</span></em>, <em class="sig-param"><span class="n">mintrials</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#NeuralGLM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.NeuralGLM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generalized Linear Model which seeks to describe spiking activity as the output of a poisson
process. Uses sklearn’s GLM methods under the hood while providing useful routines for dealing
with neural data</p>
<dl class="py method">
<dt id="brainbox.modeling.glm.NeuralGLM.add_covariate_timing">
<code class="sig-name descname">add_covariate_timing</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">covlabel</span></em>, <em class="sig-param"><span class="n">eventname</span></em>, <em class="sig-param"><span class="n">bases</span></em>, <em class="sig-param"><span class="n">offset</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">deltaval</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cond</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">desc</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#NeuralGLM.add_covariate_timing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.NeuralGLM.add_covariate_timing" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience wrapper for adding timing event regressors to the GLM. Automatically generates
a one-hot vector for each trial as the regressor and adds the appropriate data structure
to the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covlabel</strong> (<em>str</em>) – Label which the covariate will use. Can be accessed via dot syntax of the instance
usually.</p></li>
<li><p><strong>eventname</strong> (<em>str</em>) – Label of the column in trialsdf which has the event timing for each trial.</p></li>
<li><p><strong>bases</strong> (<em>numpy.array</em>) – nTB x nB array, i.e. number of time bins for the bases functions by number of bases.
Each column in the array is used together to describe the response of a unit to that
timing event.</p></li>
<li><p><strong>offset</strong> (<em>float</em><em>, </em><em>seconds</em>) – Offset of bases functions relative to timing event. Negative values will ensure that</p></li>
<li><p><strong>deltaval</strong> (<em>None</em><em>, </em><em>str</em><em>, or </em><em>pandas series</em><em>, </em><em>optional</em>) – Values of the kronecker delta function peak used to encode the event. If a string, the
column in trialsdf with that label will be used. If a pandas series with indexes
matching trialsdf, corresponding elements of the series will be the delta funtion val.
If None (default) height is 1.</p></li>
<li><p><strong>cond</strong> (<em>None</em><em>, </em><em>list</em><em>, or </em><em>fun</em><em>, </em><em>optional</em>) – Condition which to apply this covariate. Can either be a list of trial indices, or a
function which takes in rows of the trialsdf and returns booleans.</p></li>
<li><p><strong>desc</strong> (<em>str</em><em>, </em><em>optional</em>) – Additional information about the covariate, if desired. by default ‘’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainbox.modeling.glm.NeuralGLM.add_covariate_boxcar">
<code class="sig-name descname">add_covariate_boxcar</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">covlabel</span></em>, <em class="sig-param"><span class="n">boxstart</span></em>, <em class="sig-param"><span class="n">boxend</span></em>, <em class="sig-param"><span class="n">cond</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">height</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">desc</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#NeuralGLM.add_covariate_boxcar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.NeuralGLM.add_covariate_boxcar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="brainbox.modeling.glm.NeuralGLM.add_covariate_raw">
<code class="sig-name descname">add_covariate_raw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">covlabel</span></em>, <em class="sig-param"><span class="n">raw</span></em>, <em class="sig-param"><span class="n">cond</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">desc</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#NeuralGLM.add_covariate_raw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.NeuralGLM.add_covariate_raw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="brainbox.modeling.glm.NeuralGLM.add_covariate">
<code class="sig-name descname">add_covariate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">covlabel</span></em>, <em class="sig-param"><span class="n">regressor</span></em>, <em class="sig-param"><span class="n">bases</span></em>, <em class="sig-param"><span class="n">offset</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">cond</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">desc</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#NeuralGLM.add_covariate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.NeuralGLM.add_covariate" title="Permalink to this definition">¶</a></dt>
<dd><p>Parent function to add covariates to model object. Takes a regressor in the form of a
pandas Series object, a T x M array of M bases, and stores them for use in the design
matrix generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>covlabel</strong> (<em>str</em>) – Label for the covariate being added. Will be exposed, if possible, through
(instance).(covlabel) attribute.</p></li>
<li><p><strong>regressor</strong> (<em>pandas.Series</em>) – Series in which each element is the value(s) of a regressor for a trial at that index.
These will be convolved with the bases functions (if provided) to produce the
components of the design matrix. <em>Regressor must be (T / dt) x 1 array for each trial</em></p></li>
<li><p><strong>bases</strong> (<em>numpy.array</em><em> or </em><em>None</em>) – T x M array of M basis functions over T timesteps. Columns will be convolved with the
elements of <cite>regressor</cite> to produce elements of the design matrix. If None, it is
assumed a raw regressor is being used.</p></li>
<li><p><strong>offset</strong> (<em>int</em><em>, </em><em>optional</em>) – Offset of the regressor from the bases during convolution. Negative values indicate
that the firing of the unit will be , by default 0</p></li>
<li><p><strong>cond</strong> (<em>list</em><em> or </em><em>func</em><em>, </em><em>optional</em>) – Condition for which to apply covariate. Either a list of trials which the covariate
applies to, or a function of the form f(dataframerow) which returns a boolean,
by default None</p></li>
<li><p><strong>desc</strong> (<em>str</em><em>, </em><em>optional</em>) – Description of the covariate for reference purposes, by default ‘’ (empty)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainbox.modeling.glm.NeuralGLM.bin_spike_trains">
<code class="sig-name descname">bin_spike_trains</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#NeuralGLM.bin_spike_trains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.NeuralGLM.bin_spike_trains" title="Permalink to this definition">¶</a></dt>
<dd><p>Bins spike times passed to class at instantiation. Will not bin spike trains which did
not meet the criteria for minimum number of spiking trials. Must be run before the
NeuralGLM.fit() method is called.</p>
</dd></dl>

<dl class="py method">
<dt id="brainbox.modeling.glm.NeuralGLM.compile_design_matrix">
<code class="sig-name descname">compile_design_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dense</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#NeuralGLM.compile_design_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.NeuralGLM.compile_design_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Compiles design matrix for the current experiment based on the covariates which were added
with the various NeuralGLM.add_covariate methods available. Can optionally compile a sparse
design matrix using the scipy.sparse package, however that method may take longer depending
on the degree of sparseness.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dense</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether or not to compute a dense design matrix or a sparse one, by default True</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainbox.modeling.glm.NeuralGLM.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'sklearn'</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#NeuralGLM.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.NeuralGLM.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the current set of binned spikes as a function of the current design matrix. Requires
NeuralGLM.bin_spike_trains and NeuralGLM.compile_design_matrix to be run first. Will store
the fit weights to an internal variable. To access these fit weights in a pandas DataFrame
use the NeuralGLM.combine_weights method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – ‘sklearn’ or ‘minimize’, describes the fitting method used to obtain weights.
Scikit-learn uses weight normalization and regularization and will return significantly
different results from ‘minimize’, which simply minimizes the negative log likelihood
of the data given the covariates, by default ‘sklearn’</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Regularization strength for scikit-learn implementation of GLM fitting, where 0 is
effectively unregularized weights. Does not function in the minimize
option, by default 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>coefs</strong> (<em>list</em>) – List of coefficients fit. Not recommended to use these for interpretation. Use
the .combine_weights() method instead.</p></li>
<li><p><strong>intercepts</strong> (<em>list</em>) – List of intercepts (bias terms) fit. Not recommended to use these for interpretation.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainbox.modeling.glm.NeuralGLM.combine_weights">
<code class="sig-name descname">combine_weights</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#NeuralGLM.combine_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.NeuralGLM.combine_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Combined fit coefficients and intercepts to produce kernels where appropriate, which
describe activity.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>DataFrame in which each row is the fit weights for a given spiking unit. Columns are
individual covariates added during the construction process. Indices are the cluster
IDs for each of the cells that were fit (NOT a simple range(start, stop) index.)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainbox.modeling.glm.NeuralGLM.score">
<code class="sig-name descname">score</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#NeuralGLM.score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.NeuralGLM.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the squared deviance of the model, i.e. how much variance beyond the null model
(a poisson process with the same mean, defined by the intercept, at every time step) the
model which was fit explains.
For a detailed explanation see <a class="reference external" href="https://bookdown.org/egarpor/PM-UC3M/glm-deviance">https://bookdown.org/egarpor/PM-UC3M/glm-deviance</a>.html`</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A series in which the index are cluster IDs and each entry is the D^2 for the model fit
to that cluster</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pandas.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainbox.modeling.glm.NeuralGLM.binf">
<code class="sig-name descname">binf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#NeuralGLM.binf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.NeuralGLM.binf" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin function for a given timestep. Returns the number of bins after trial start a given t
would occur at.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>t</strong> (<em>float</em>) – Seconds after trial start</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of bins corresponding to t using the binwidth of the model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="brainbox.modeling.glm.convbasis">
<code class="sig-name descname">convbasis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stim</span></em>, <em class="sig-param"><span class="n">bases</span></em>, <em class="sig-param"><span class="n">offset</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#convbasis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.convbasis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="brainbox.modeling.glm.denseconv">
<code class="sig-name descname">denseconv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">bases</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#denseconv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.denseconv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="brainbox.modeling.glm.raised_cosine">
<code class="sig-name descname">raised_cosine</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">duration</span></em>, <em class="sig-param"><span class="n">nbases</span></em>, <em class="sig-param"><span class="n">binfun</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#raised_cosine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.raised_cosine" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="brainbox.modeling.glm.full_rcos">
<code class="sig-name descname">full_rcos</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">duration</span></em>, <em class="sig-param"><span class="n">nbases</span></em>, <em class="sig-param"><span class="n">binfun</span></em>, <em class="sig-param"><span class="n">n_before</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#full_rcos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.full_rcos" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="brainbox.modeling.glm.neglog">
<code class="sig-name descname">neglog</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#neglog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.neglog" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="brainbox.modeling.glm.d_neglog">
<code class="sig-name descname">d_neglog</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#d_neglog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.d_neglog" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="brainbox.modeling.glm.dd_neglog">
<code class="sig-name descname">dd_neglog</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/modeling/glm.html#dd_neglog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.modeling.glm.dd_neglog" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="brainbox.modeling.parameter.html" class="btn btn-neutral float-right" title="brainbox.modeling.parameter" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="brainbox.modeling.fitting_method.html" class="btn btn-neutral float-left" title="brainbox.modeling.fitting_method" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, International Brain Laboratory

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>