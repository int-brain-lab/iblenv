<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>brainbox.plot &mdash; IBL Library  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="brainbox.plot_base" href="brainbox.plot_base.html" />
    <link rel="prev" title="brainbox.metrics.single_units" href="brainbox.metrics.single_units.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            IBL Library
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The Open Neurophysiology Environment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/one_quickstart.html">ONE Quick Start</a></li>
<li class="toctree-l1"><a class="reference external" href="https://int-brain-lab.github.io/ONE/">Full documentation Website for ONE</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Public</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/public_introduction.html">Publicly available IBL data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_release_behavior.html">Data Release - Behavior</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/data_release_pilot.html">Data Release - Pilot Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_release_repro_ephys.html">Data Release - Reproducible Ephys Paper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_release_brainwidemap.html">Data Release - Brain Wide Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_release_spikesorting_benchmarks.html">Data Release - Spike sorting benchmark datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/information_contact.html">Information and troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exploring IBL Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_structure.html">Get to know the datasets and folder structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_download.html">Download the public datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../loading_examples.html">Loading Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_installation.html">Unified Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09_contribution.html">How to contribute</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples &amp; Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../atlas_examples.html">Atlas Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/docs_wheel_moves.html">Working with wheel data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../010_api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ibllib.html">ibllib</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="brainbox.html">brainbox</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="brainbox.atlas.html">brainbox.atlas</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.behavior.html">brainbox.behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.core.html">brainbox.core</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.ephys_plots.html">brainbox.ephys_plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.io.html">brainbox.io</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.lfp.html">brainbox.lfp</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.metrics.html">brainbox.metrics</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">brainbox.plot</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#brainbox.plot.feat_vars"><code class="docutils literal notranslate"><span class="pre">feat_vars()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainbox.plot.missed_spikes_est"><code class="docutils literal notranslate"><span class="pre">missed_spikes_est()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainbox.plot.wf_comp"><code class="docutils literal notranslate"><span class="pre">wf_comp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainbox.plot.amp_heatmap"><code class="docutils literal notranslate"><span class="pre">amp_heatmap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainbox.plot.firing_rate"><code class="docutils literal notranslate"><span class="pre">firing_rate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainbox.plot.peri_event_time_histogram"><code class="docutils literal notranslate"><span class="pre">peri_event_time_histogram()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainbox.plot.driftmap"><code class="docutils literal notranslate"><span class="pre">driftmap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainbox.plot.pres_ratio"><code class="docutils literal notranslate"><span class="pre">pres_ratio()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#brainbox.plot.driftmap_color"><code class="docutils literal notranslate"><span class="pre">driftmap_color()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.plot_base.html">brainbox.plot_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.population.html">brainbox.population</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.processing.html">brainbox.processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.quality.html">brainbox.quality</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.singlecell.html">brainbox.singlecell</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.spike_features.html">brainbox.spike_features</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.task.html">brainbox.task</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.tests.html">brainbox.tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.video.html">brainbox.video</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="iblatlas.html">iblatlas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IBL Library</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../010_api_reference.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="brainbox.html">brainbox</a></li>
      <li class="breadcrumb-item active">brainbox.plot</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/brainbox.plot.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-brainbox.plot">
<span id="brainbox-plot"></span><h1>brainbox.plot<a class="headerlink" href="#module-brainbox.plot" title="Link to this heading"></a></h1>
<p>Plots metrics that assess quality of single units. Some functions here generate plots for the
output of functions in the brainbox <cite>single_units.py</cite> module.</p>
<p>Run the following to set-up the workspace to run the docstring examples:
&gt;&gt;&gt; from brainbox import processing
&gt;&gt;&gt; import one.alf.io as alfio
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; import ibllib.ephys.spikes as e_spks
# (<a href="#id1"><span class="problematic" id="id2">*</span></a>Note, if there is no ‘alf’ directory, make ‘alf’ directory from ‘ks2’ output directory):
&gt;&gt;&gt; e_spks.ks2_to_alf(path_to_ks_out, path_to_alf_out)
# Load the alf spikes bunch and clusters bunch, and get a units bunch.
&gt;&gt;&gt; spks_b = alfio.load_object(path_to_alf_out, ‘spikes’)
&gt;&gt;&gt; clstrs_b = alfio.load_object(path_to_alf_out, ‘clusters’)
&gt;&gt;&gt; units_b = processing.get_units_bunch(spks_b)  # may take a few mins to compute</p>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.plot.amp_heatmap" title="brainbox.plot.amp_heatmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">amp_heatmap</span></code></a></p></td>
<td><p>Plots a heatmap of the normalized voltage values over time and space for given timestamps and channels, after (optionally) common-average-referencing.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.plot.driftmap" title="brainbox.plot.driftmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">driftmap</span></code></a></p></td>
<td><p>Plots the values of a spike feature array (y-axis) over time (x-axis).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.plot.driftmap_color" title="brainbox.plot.driftmap_color"><code class="xref py py-obj docutils literal notranslate"><span class="pre">driftmap_color</span></code></a></p></td>
<td><p>Plots the driftmap of a session or a trial</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.plot.feat_vars" title="brainbox.plot.feat_vars"><code class="xref py py-obj docutils literal notranslate"><span class="pre">feat_vars</span></code></a></p></td>
<td><p>Plots the coefficients of variation of a particular spike feature for all units as a bar plot, where each bar is color-coded corresponding to the depth of the max amplitude channel of the respective unit.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.plot.firing_rate" title="brainbox.plot.firing_rate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">firing_rate</span></code></a></p></td>
<td><p>Plots the instantaneous firing rate of for given spike timestamps over time, and optionally overlays the value of the coefficient of variation of the firing rate for a specified number of bins.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.plot.missed_spikes_est" title="brainbox.plot.missed_spikes_est"><code class="xref py py-obj docutils literal notranslate"><span class="pre">missed_spikes_est</span></code></a></p></td>
<td><p>Plots the pdf of an estimated symmetric spike feature distribution, with a vertical cutoff line that indicates the approximate fraction of spikes missing from the distribution, assuming the true distribution is symmetric.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.plot.peri_event_time_histogram" title="brainbox.plot.peri_event_time_histogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">peri_event_time_histogram</span></code></a></p></td>
<td><p>Plot peri-event time histograms, with the meaning firing rate of units centered on a given series of events.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.plot.pres_ratio" title="brainbox.plot.pres_ratio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pres_ratio</span></code></a></p></td>
<td><p>Plots the presence ratio of spike counts: the number of bins where there is at least one spike, over the total number of bins, given a specified bin width.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.plot.wf_comp" title="brainbox.plot.wf_comp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wf_comp</span></code></a></p></td>
<td><p>Plots two different sets of waveforms across specified channels after (optionally) common-average-referencing.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="brainbox.plot.feat_vars">
<span class="sig-name descname"><span class="pre">feat_vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'amps'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'norm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ks'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coolwarm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/plot.html#feat_vars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.plot.feat_vars" title="Link to this definition"></a></dt>
<dd><p>Plots the coefficients of variation of a particular spike feature for all units as a bar plot,
where each bar is color-coded corresponding to the depth of the max amplitude channel of the
respective unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>units_b</strong> (<em>bunch</em>) – A units bunch containing fields with spike information (e.g. cluster IDs, times, features,
etc.) for all units.</p></li>
<li><p><strong>units</strong> (<em>array-like</em><em> (</em><em>optional</em><em>)</em>) – A subset of all units for which to create the bar plot. (If <cite>None</cite>, all units are used)</p></li>
<li><p><strong>feat_name</strong> (<em>string</em><em> (</em><em>optional</em><em>)</em>) – The spike feature to plot.</p></li>
<li><p><strong>dist</strong> (<em>string</em><em> (</em><em>optional</em><em>)</em>) – The type of hypothetical null distribution from which the empirical spike feature
distributions are presumed to belong to.</p></li>
<li><p><strong>test</strong> (<em>string</em><em> (</em><em>optional</em><em>)</em>) – The statistical test used to calculate the probability that the empirical spike feature
distributions come from <cite>dist</cite>.</p></li>
<li><p><strong>cmap_name</strong> (<em>string</em><em> (</em><em>optional</em><em>)</em>) – The name of the colormap associated with the plot.</p></li>
<li><p><strong>ax</strong> (<em>axessubplot</em><em> (</em><em>optional</em><em>)</em>) – The axis handle to plot the histogram on. (if <cite>None</cite>, a new figure and axis is created)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cv_vals</strong> (<em>ndarray</em>) – The coefficients of variation of <cite>feat_name</cite> for each unit.</p></li>
<li><p><strong>p_vals</strong> (<em>ndarray</em>) – The probabilites that the distribution for <cite>feat_name</cite> for each unit comes from a
<cite>dist</cite> distribution based on the <cite>test</cite> statistical test.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics.unit_stability</span></code></p>
</div>
<p class="rubric">Examples</p>
<ol class="arabic">
<li><dl>
<dt>Create a bar plot of the coefficients of variation of the spike amplitudes for all units.</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">var_vals</span><span class="p">,</span> <span class="n">p_vals</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">feat_vars</span><span class="p">(</span><span class="n">units_b</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.plot.missed_spikes_est">
<span class="sig-name descname"><span class="pre">missed_spikes_est</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spks_per_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_num_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/plot.html#missed_spikes_est"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.plot.missed_spikes_est" title="Link to this definition"></a></dt>
<dd><p>Plots the pdf of an estimated symmetric spike feature distribution, with a vertical cutoff line
that indicates the approximate fraction of spikes missing from the distribution, assuming the
true distribution is symmetric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> (<em>ndarray</em>) – The spikes’ feature values.</p></li>
<li><p><strong>feat_name</strong> (<em>string</em>) – The spike feature to plot.</p></li>
<li><p><strong>spks_per_bin</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – The number of spikes per bin from which to compute the spike feature histogram.</p></li>
<li><p><strong>sigma</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – The standard deviation for the gaussian kernel used to compute the pdf from the spike
feature histogram.</p></li>
<li><p><strong>min_num_bins</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – The minimum number of bins used to compute the spike feature histogram.</p></li>
<li><p><strong>ax</strong> (<em>axessubplot</em><em> (</em><em>optional</em><em>)</em>) – The axis handle to plot the histogram on. (if <cite>None</cite>, a new figure and axis is created)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fraction_missing</strong> – The fraction of missing spikes (0-0.5). <a href="#id3"><span class="problematic" id="id4">*</span></a>Note: If more than 50% of spikes are missing, an
accurate estimate isn’t possible.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">single_units.feature_cutoff</span></code></p>
</div>
<p class="rubric">Examples</p>
<p>1) Plot cutoff line indicating the fraction of spikes missing from a unit based on the recorded
unit’s spike amplitudes, assuming the distribution of the unit’s spike amplitudes is symmetric.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">feat</span> <span class="o">=</span> <span class="n">units_b</span><span class="p">[</span><span class="s1">&#39;amps&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fraction_missing</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">missed_spikes_est</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">feat_name</span><span class="o">=</span><span class="s1">&#39;amps&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.plot.wf_comp">
<span class="sig-name descname"><span class="pre">wf_comp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ephys_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ch_probe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">385</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int16'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">car</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['b',</span> <span class="pre">'r']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/plot.html#wf_comp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.plot.wf_comp" title="Link to this definition"></a></dt>
<dd><p>Plots two different sets of waveforms across specified channels after (optionally)
common-average-referencing. In this way, waveforms can be compared to see if there is,
e.g. drift during the recording, or if two units should be merged, or one unit should be split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ephys_file</strong> (<em>string</em>) – The file path to the binary ephys data.</p></li>
<li><p><strong>ts1</strong> (<em>array_like</em>) – A set of timestamps for which to compare waveforms with <cite>ts2</cite>.</p></li>
<li><p><strong>ts2</strong> (<em>array_like</em>) – A set of timestamps for which to compare waveforms with <cite>ts1</cite>.</p></li>
<li><p><strong>ch</strong> (<em>array-like</em>) – The channels to use for extracting and plotting the waveforms.</p></li>
<li><p><strong>sr</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – The sampling rate (in hz) that the ephys data was acquired at.</p></li>
<li><p><strong>n_ch_probe</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – The number of channels of the recording.</p></li>
<li><p><strong>dtype</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – The datatype represented by the bytes in <cite>ephys_file</cite>.</p></li>
<li><p><strong>car</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – A flag for whether or not to perform common-average-referencing before extracting waveforms</p></li>
<li><p><strong>col</strong> (<em>list</em><em> of </em><em>strings</em><em> or </em><em>float arrays</em><em> (</em><em>optional</em><em>)</em>) – Two elements in the list, where each specifies the color the <cite>ts1</cite> and <cite>ts2</cite> waveforms
will be plotted in, respectively.</p></li>
<li><p><strong>ax</strong> (<em>axessubplot</em><em> (</em><em>optional</em><em>)</em>) – The axis handle to plot the histogram on. (if <cite>None</cite>, a new figure and axis is created)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>wf1</strong> (<em>ndarray</em>) – The waveforms for the spikes in <cite>ts1</cite>: an array of shape (#spikes, #samples, #channels).</p></li>
<li><p><strong>wf2</strong> (<em>ndarray</em>) – The waveforms for the spikes in <cite>ts2</cite>: an array of shape (#spikes, #samples, #channels).</p></li>
<li><p><strong>s</strong> (<em>float</em>) – The similarity score between the two sets of waveforms, calculated by
<cite>single_units.wf_similarity</cite></p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">io.extract_waveforms</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">single_units.wf_similarity</span></code></p>
</div>
<p class="rubric">Examples</p>
<p>1) Compare first and last 100 spike waveforms for unit1, across 20 channels around the channel
of max amplitude, and compare the waveforms in the first minute to the waveforms in the fourth
minutes for unit2, across 10 channels around the mean.</p>
<blockquote>
<div><p># Get first and last 100 spikes, and 20 channels around channel of max amp for unit 1:
&gt;&gt;&gt; ts1 = units_b[‘times’][‘1’][:100]
&gt;&gt;&gt; ts2 = units_b[‘times’][‘1’][-100:]
&gt;&gt;&gt; max_ch = clstrs_b[‘channels’][1]
&gt;&gt;&gt; if max_ch &lt; n_c_ch:  # take only channels greater than <cite>max_ch</cite>.
&gt;&gt;&gt;     ch = np.arange(max_ch, max_ch + 20)
&gt;&gt;&gt; elif (max_ch + n_c_ch) &gt; n_ch_probe:  # take only channels less than <cite>max_ch</cite>.
&gt;&gt;&gt;     ch = np.arange(max_ch - 20, max_ch)
&gt;&gt;&gt; else:  # take <cite>n_c_ch</cite> around <cite>max_ch</cite>.
&gt;&gt;&gt;     ch = np.arange(max_ch - 10, max_ch + 10)
&gt;&gt;&gt; wf1, wf2, s = bb.plot.wf_comp(path_to_ephys_file, ts1, ts2, ch)
# Plot waveforms for unit2 from the first and fourth minutes across 10 channels.
&gt;&gt;&gt; ts = units_b[‘times’][‘2’]
&gt;&gt;&gt; ts1_2 = ts[np.where(ts&lt;60)[0]]
&gt;&gt;&gt; ts2_2 = ts[np.where(ts&gt;180)[0][:len(ts1)]]
&gt;&gt;&gt; max_ch = clstrs_b[‘channels’][2]
&gt;&gt;&gt; if max_ch &lt; n_c_ch:  # take only channels greater than <cite>max_ch</cite>.
&gt;&gt;&gt;     ch = np.arange(max_ch, max_ch + 10)
&gt;&gt;&gt; elif (max_ch + n_c_ch) &gt; n_ch_probe:  # take only channels less than <cite>max_ch</cite>.
&gt;&gt;&gt;     ch = np.arange(max_ch - 10, max_ch)
&gt;&gt;&gt; else:  # take <cite>n_c_ch</cite> around <cite>max_ch</cite>.
&gt;&gt;&gt;     ch = np.arange(max_ch - 5, max_ch + 5)
&gt;&gt;&gt; wf1_2, wf2_2, s_2 = bb.plot.wf_comp(path_to_ephys_file, ts1_2, ts2_2, ch)</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.plot.amp_heatmap">
<span class="sig-name descname"><span class="pre">amp_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ephys_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ch_probe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">385</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'int16'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RdBu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">car</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/plot.html#amp_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.plot.amp_heatmap" title="Link to this definition"></a></dt>
<dd><p>Plots a heatmap of the normalized voltage values over time and space for given timestamps and
channels, after (optionally) common-average-referencing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ephys_file</strong> (<em>string</em>) – The file path to the binary ephys data.</p></li>
<li><p><strong>ts</strong> (<em>array_like</em>) – A set of timestamps for which to get the voltage values.</p></li>
<li><p><strong>ch</strong> (<em>array-like</em>) – The channels to use for extracting the voltage values.</p></li>
<li><p><strong>sr</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – The sampling rate (in hz) that the ephys data was acquired at.</p></li>
<li><p><strong>n_ch_probe</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – The number of channels of the recording.</p></li>
<li><p><strong>dtype</strong> (<em>str</em><em> (</em><em>optional</em><em>)</em>) – The datatype represented by the bytes in <cite>ephys_file</cite>.</p></li>
<li><p><strong>cmap_name</strong> (<em>string</em><em> (</em><em>optional</em><em>)</em>) – The name of the colormap associated with the plot.</p></li>
<li><p><strong>car</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – A flag for whether or not to perform common-average-referencing before extracting waveforms</p></li>
<li><p><strong>ax</strong> (<em>axessubplot</em><em> (</em><em>optional</em><em>)</em>) – The axis handle to plot the histogram on. (if <cite>None</cite>, a new figure and axis is created)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>v_vals</strong> – The voltage values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>1) Plot a heatmap of the spike amplitudes across 20 channels around the channel of max
amplitude for all spikes in unit 1.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">units_b</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_ch</span> <span class="o">=</span> <span class="n">clstrs_b</span><span class="p">[</span><span class="s1">&#39;channels&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">max_ch</span> <span class="o">&lt;</span> <span class="n">n_c_ch</span><span class="p">:</span>  <span class="c1"># take only channels greater than `max_ch`.</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">max_ch</span><span class="p">,</span> <span class="n">max_ch</span> <span class="o">+</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">elif</span> <span class="p">(</span><span class="n">max_ch</span> <span class="o">+</span> <span class="n">n_c_ch</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">n_ch_probe</span><span class="p">:</span>  <span class="c1"># take only channels less than `max_ch`.</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">max_ch</span> <span class="o">-</span> <span class="mi">20</span><span class="p">,</span> <span class="n">max_ch</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">else</span><span class="p">:</span>  <span class="c1"># take `n_c_ch` around `max_ch`.</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">ch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">max_ch</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="n">max_ch</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">amp_heatmap</span><span class="p">(</span><span class="n">path_to_ephys_file</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">ch</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.plot.firing_rate">
<span class="sig-name descname"><span class="pre">firing_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist_win</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fr_win</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_fr_cv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/plot.html#firing_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.plot.firing_rate" title="Link to this definition"></a></dt>
<dd><p>Plots the instantaneous firing rate of for given spike timestamps over time, and optionally
overlays the value of the coefficient of variation of the firing rate for a specified number
of bins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> (<em>ndarray</em>) – The spike timestamps from which to compute the firing rate.</p></li>
<li><p><strong>hist_win</strong> (<em>float</em><em> (</em><em>optional</em><em>)</em>) – The time window (in s) to use for computing spike counts.</p></li>
<li><p><strong>fr_win</strong> (<em>float</em><em> (</em><em>optional</em><em>)</em>) – The time window (in s) to use as a moving slider to compute the instantaneous firing rate.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em> (</em><em>optional</em><em>)</em>) – The number of bins in which to compute coefficients of variation of the firing rate.</p></li>
<li><p><strong>show_fr_cv</strong> (<em>bool</em><em> (</em><em>optional</em><em>)</em>) – A flag for whether or not to compute and show the coefficients of variation of the firing
rate for <cite>n_bins</cite>.</p></li>
<li><p><strong>ax</strong> (<em>axessubplot</em><em> (</em><em>optional</em><em>)</em>) – The axis handle to plot the histogram on. (if <cite>None</cite>, a new figure and axis is created)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fr</strong> (<em>ndarray</em>) – The instantaneous firing rate over time (in hz).</p></li>
<li><p><strong>cv</strong> (<em>float</em>) – The mean coefficient of variation of the firing rate of the <cite>n_bins</cite> number of coefficients
computed. Can only be returned if <cite>show_fr_cv</cite> is True.</p></li>
<li><p><strong>cvs</strong> (<em>ndarray</em>) – The coefficients of variation of the firing for each bin of <cite>n_bins</cite>. Can only be returned
if <cite>show_fr_cv</cite> is True.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">single_units.firing_rate_cv</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">singecell.firing_rate</span></code></p>
</div>
<p class="rubric">Examples</p>
<p>1) Plot the firing rate for unit 1 from the time of its first to last spike, showing the cv
of the firing rate for 10 evenly spaced bins.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">units_b</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fr</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">cvs</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">firing_rate</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.plot.peri_event_time_histogram">
<span class="sig-name descname"><span class="pre">peri_event_time_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spike_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spike_clusters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">events</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_before</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_raster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_rasters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_bars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'std'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pethline_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'color':</span> <span class="pre">'blue',</span> <span class="pre">'lw':</span> <span class="pre">2}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errbar_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.5,</span> <span class="pre">'color':</span> <span class="pre">'blue'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eventline_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">0.5,</span> <span class="pre">'color':</span> <span class="pre">'black'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raster_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'color':</span> <span class="pre">'black',</span> <span class="pre">'lw':</span> <span class="pre">0.5}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/plot.html#peri_event_time_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.plot.peri_event_time_histogram" title="Link to this definition"></a></dt>
<dd><p>Plot peri-event time histograms, with the meaning firing rate of units centered on a given
series of events. Can optionally add a raster underneath the PETH plot of individual spike
trains about the events.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spike_times</strong> (<em>array_like</em>) – Spike times (in seconds)</p></li>
<li><p><strong>spike_clusters</strong> (<em>array-like</em>) – Cluster identities for each element of spikes</p></li>
<li><p><strong>events</strong> (<em>array-like</em>) – Times to align the histogram(s) to</p></li>
<li><p><strong>cluster_id</strong> (<em>int</em>) – Identity of the cluster for which to plot a PETH</p></li>
<li><p><strong>t_before</strong> (<em>float</em><em>, </em><em>optional</em>) – Time before event to plot (default: 0.2s)</p></li>
<li><p><strong>t_after</strong> (<em>float</em><em>, </em><em>optional</em>) – Time after event to plot (default: 0.5s)</p></li>
<li><p><strong>bin_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Width of bin for histograms (default: 0.025s)</p></li>
<li><p><strong>smoothing</strong> (<em>float</em><em>, </em><em>optional</em>) – Sigma of gaussian smoothing to use in histograms. (default: 0.025s)</p></li>
<li><p><strong>as_rate</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to use spike counts or rates in the plot (default: <cite>True</cite>, uses rates)</p></li>
<li><p><strong>include_raster</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to put a raster below the PETH of individual spike trains (default: <cite>False</cite>)</p></li>
<li><p><strong>n_rasters</strong> (<em>int</em><em>, </em><em>optional</em>) – If include_raster is True, the number of rasters to include. If <cite>None</cite>
will default to plotting rasters around all provided events. (default: <cite>None</cite>)</p></li>
<li><p><strong>error_bars</strong> (<em>{'std'</em><em>, </em><em>'sem'</em><em>, </em><em>'none'}</em><em>, </em><em>optional</em>) – Defines which type of error bars to plot. Options are:
– <cite>‘std’</cite> for 1 standard deviation
– <cite>‘sem’</cite> for standard error of the mean
– <cite>‘none’</cite> for only plotting the mean value
(default: <cite>‘std’</cite>)</p></li>
<li><p><strong>ax</strong> (<em>matplotlib axes</em><em>, </em><em>optional</em>) – If passed, the function will plot on the passed axes. Note: current
behavior causes whatever was on the axes to be cleared before plotting!
(default: <cite>None</cite>)</p></li>
<li><p><strong>pethline_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dict containing line properties to define PETH plot line. Default
is a blue line with weight of 2. Needs to have color. See matplotlib plot documentation
for more options.
(default: <cite>{‘color’: ‘blue’, ‘lw’: 2}</cite>)</p></li>
<li><p><strong>errbar_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dict containing fill-between properties to define PETH error bars.
Default is a blue fill with 50 percent opacity.. Needs to have color. See matplotlib
fill_between documentation for more options.
(default: <cite>{‘color’: ‘blue’, ‘alpha’: 0.5}</cite>)</p></li>
<li><p><strong>eventline_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dict containing fill-between properties to define line at event.
Default is a black line with 50 percent opacity.. Needs to have color. See matplotlib
vlines documentation for more options.
(default: <cite>{‘color’: ‘black’, ‘alpha’: 0.5}</cite>)</p></li>
<li><p><strong>raster_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dict containing properties defining lines in the raster plot.
Default is black lines with line width of 0.5. See matplotlib vlines for more options.
(default: <cite>{‘color’: ‘black’, ‘lw’: 0.5}</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong> – Axes with all of the plots requested.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.plot.driftmap">
<span class="sig-name descname"><span class="pre">driftmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bincount'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/plot.html#driftmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.plot.driftmap" title="Link to this definition"></a></dt>
<dd><p>Plots the values of a spike feature array (y-axis) over time (x-axis).
Two arguments can be given for the plot_style of the drift map:
- ‘scatter’ : whereby each value is plotted as a marker (up to 100’000 data point)
- ‘bincount’ : whereby the values are binned (optimised to represent spike raster)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feat</strong> (<em>ndarray</em>) – The spikes’ feature values.</p></li>
<li><p><strong>ts</strong> (<em>ndarray</em>) – The spike timestamps from which to compute the firing rate.</p></li>
<li><p><strong>ax</strong> (<em>axessubplot</em><em> (</em><em>optional</em><em>)</em>) – The axis handle to plot the histogram on. (if <cite>None</cite>, a new figure and axis is created)</p></li>
<li><p><strong>t_bin</strong> (<em>time bin used when plot_style='bincount'</em>) – </p></li>
<li><p><strong>d_bin</strong> (<em>depth bin used when plot_style='bincount'</em>) – </p></li>
<li><p><strong>plot_style</strong> (<em>'scatter'</em><em>, </em><em>'bincount'</em>) – </p></li>
<li><p><strong>**kwargs</strong> (<em>matplotlib.imshow arguments</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cd</strong> (<em>float</em>) – The cumulative drift of <cite>feat</cite>.</p></li>
<li><p><strong>md</strong> (<em>float</em>) – The maximum drift of <cite>feat</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics.cum_drift</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics.max_drift</span></code></p>
</div>
<p class="rubric">Examples</p>
<ol class="arabic">
<li><dl>
<dt>Plot the amplitude driftmap for unit 1.</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">units_b</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">amps</span> <span class="o">=</span> <span class="n">units_b</span><span class="p">[</span><span class="s1">&#39;amps&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">driftmap</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">amps</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Plot the depth driftmap for unit 1.</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">units_b</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">depths</span> <span class="o">=</span> <span class="n">units_b</span><span class="p">[</span><span class="s1">&#39;depths&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">driftmap</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">depths</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.plot.pres_ratio">
<span class="sig-name descname"><span class="pre">pres_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist_win</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/plot.html#pres_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.plot.pres_ratio" title="Link to this definition"></a></dt>
<dd><p>Plots the presence ratio of spike counts: the number of bins where there is at least one
spike, over the total number of bins, given a specified bin width.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> (<em>ndarray</em>) – The spike timestamps from which to compute the presence ratio.</p></li>
<li><p><strong>hist_win</strong> (<em>float</em>) – The time window (in s) to use for computing the presence ratio.</p></li>
<li><p><strong>ax</strong> (<em>axessubplot</em><em> (</em><em>optional</em><em>)</em>) – The axis handle to plot the histogram on. (if <cite>None</cite>, a new figure and axis is created)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>pr</strong> (<em>float</em>) – The presence ratio.</p></li>
<li><p><strong>spks_bins</strong> (<em>ndarray</em>) – The number of spks in each bin.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics.pres_ratio</span></code></p>
</div>
<p class="rubric">Examples</p>
<ol class="arabic">
<li><dl>
<dt>Plot the presence ratio for unit 1, given a window of 10 s.</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">units_b</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pr</span><span class="p">,</span> <span class="n">pr_bins</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pres_ratio</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.plot.driftmap_color">
<span class="sig-name descname"><span class="pre">driftmap_color</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clusters_depths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spikes_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spikes_amps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spikes_depths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spikes_clusters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axesoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_lims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/plot.html#driftmap_color"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.plot.driftmap_color" title="Link to this definition"></a></dt>
<dd><p>Plots the driftmap of a session or a trial</p>
<p>The plot shows the spike times vs spike depths.
Each dot is a spike, whose color indicates the cluster
and opacity indicates the spike amplitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clusters_depths</strong> (<em>ndarray</em>) – depths of all clusters</p></li>
<li><p><strong>spikes_times</strong> (<em>ndarray</em>) – spike times of all clusters</p></li>
<li><p><strong>spikes_amps</strong> (<em>ndarray</em>) – amplitude of each spike</p></li>
<li><p><strong>spikes_depths</strong> (<em>ndarray</em>) – depth of each spike</p></li>
<li><p><strong>spikes_clusters</strong> (<em>ndarray</em>) – cluster idx of each spike</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes object</em><em> (</em><em>optional</em><em>)</em>) – The axis object to plot the driftmap on
(if <cite>None</cite>, a new figure and axis is created)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes object</em>) – The axis object with driftmap plotted</p></li>
<li><p><strong>x_lim</strong> (<em>list of two elements</em>) – range of x axis</p></li>
<li><p><strong>y_lim</strong> (<em>list of two elements</em>) – range of y axis</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="brainbox.metrics.single_units.html" class="btn btn-neutral float-left" title="brainbox.metrics.single_units" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="brainbox.plot_base.html" class="btn btn-neutral float-right" title="brainbox.plot_base" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, International Brain Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>