

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>iblatlas.atlas &mdash; IBL Library  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/css/style.css?v=17142d56" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="iblatlas.atlas.ALLEN_CCF_LANDMARKS_MLAPDV_UM" href="iblatlas.atlas.ALLEN_CCF_LANDMARKS_MLAPDV_UM.html" />
    <link rel="prev" title="iblatlas" href="iblatlas.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            IBL Library
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The Open Neurophysiology Environment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/one_quickstart.html">ONE Quick Start</a></li>
<li class="toctree-l1"><a class="reference external" href="https://int-brain-lab.github.io/ONE/">Full documentation Website for ONE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/public_introduction.html">Publicly Available IBL Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/dataset_overview.html">What is available for download ?</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Datasets - Collaboration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/2025_data_release_brainwidemap.html">2025 - Brain Wide Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/2024_data_release_repro_ephys.html">2024 - Reproducible Ephys</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/2021_data_release_behavior.html">2021 - Behavior</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Datasets - Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/2025_data_release_autism_noel.html">2025 - Autism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/2022_data_release_spikesorting_benchmarks.html">2022 - Spike sorting benchmark datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/data_release_pilot.html">Data Release - Pilot Dataset</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exploring IBL Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_installation.html">Installation of IBL Unified Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_structure.html">Get to know the datasets and folder structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_download.html">Setting up credentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_download.html#Explore-and-download-data-using-the-ONE-api">Explore and download data using the ONE-api</a></li>
<li class="toctree-l1"><a class="reference internal" href="../loading_examples.html">Loading Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../09_contribution.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/information_contact.html">Getting Help: Information and Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples &amp; Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../atlas_examples.html">Atlas Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/docs_wheel_moves.html">Working with wheel data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/docs_wheel_screen_stimulus.html">Computing the stimulus position using the wheel</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../010_api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ibllib.html">ibllib</a></li>
<li class="toctree-l2"><a class="reference internal" href="brainbox.html">brainbox</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="iblatlas.html">iblatlas</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">iblatlas.atlas</a><ul>
<li class="toctree-l4"><a class="reference internal" href="iblatlas.atlas.ALLEN_CCF_LANDMARKS_MLAPDV_UM.html">iblatlas.atlas.ALLEN_CCF_LANDMARKS_MLAPDV_UM</a></li>
<li class="toctree-l4"><a class="reference internal" href="iblatlas.atlas.PAXINOS_CCF_LANDMARKS_MLAPDV_UM.html">iblatlas.atlas.PAXINOS_CCF_LANDMARKS_MLAPDV_UM</a></li>
<li class="toctree-l4"><a class="reference internal" href="iblatlas.atlas.S3_BUCKET_IBL.html">iblatlas.atlas.S3_BUCKET_IBL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.ALLEN_CCF_LANDMARKS_MLAPDV_UM"><code class="docutils literal notranslate"><span class="pre">ALLEN_CCF_LANDMARKS_MLAPDV_UM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.PAXINOS_CCF_LANDMARKS_MLAPDV_UM"><code class="docutils literal notranslate"><span class="pre">PAXINOS_CCF_LANDMARKS_MLAPDV_UM</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.S3_BUCKET_IBL"><code class="docutils literal notranslate"><span class="pre">S3_BUCKET_IBL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.cart2sph"><code class="docutils literal notranslate"><span class="pre">cart2sph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.sph2cart"><code class="docutils literal notranslate"><span class="pre">sph2cart()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.rodrigues_rotation"><code class="docutils literal notranslate"><span class="pre">rodrigues_rotation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.tilt_spherical"><code class="docutils literal notranslate"><span class="pre">tilt_spherical()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.BrainCoordinates"><code class="docutils literal notranslate"><span class="pre">BrainCoordinates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.BrainAtlas"><code class="docutils literal notranslate"><span class="pre">BrainAtlas</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.Trajectory"><code class="docutils literal notranslate"><span class="pre">Trajectory</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.Insertion"><code class="docutils literal notranslate"><span class="pre">Insertion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.AllenAtlas"><code class="docutils literal notranslate"><span class="pre">AllenAtlas</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.NeedlesAtlas"><code class="docutils literal notranslate"><span class="pre">NeedlesAtlas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.MRITorontoAtlas"><code class="docutils literal notranslate"><span class="pre">MRITorontoAtlas()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.FranklinPaxinosAtlas"><code class="docutils literal notranslate"><span class="pre">FranklinPaxinosAtlas</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.atlas.get_bc"><code class="docutils literal notranslate"><span class="pre">get_bc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.flatmaps.html">iblatlas.flatmaps</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.genomics.html">iblatlas.genomics</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.gui.html">iblatlas.gui</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.plots.html">iblatlas.plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.regions.html">iblatlas.regions</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.streamlines.html">iblatlas.streamlines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="iblutil.html">iblutil</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IBL Library</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../010_api_reference.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="iblatlas.html">iblatlas</a></li>
      <li class="breadcrumb-item active">iblatlas.atlas</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/iblatlas.atlas.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-iblatlas.atlas">
<span id="iblatlas-atlas"></span><h1>iblatlas.atlas<a class="headerlink" href="#module-iblatlas.atlas" title="Link to this heading"></a></h1>
<p>Classes for manipulating brain atlases, insertions, and coordinates.</p>
<p class="rubric">Module attributes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="iblatlas.atlas.ALLEN_CCF_LANDMARKS_MLAPDV_UM.html#iblatlas.atlas.ALLEN_CCF_LANDMARKS_MLAPDV_UM" title="iblatlas.atlas.ALLEN_CCF_LANDMARKS_MLAPDV_UM"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ALLEN_CCF_LANDMARKS_MLAPDV_UM</span></code></a></p></td>
<td><p>The ML AP DV voxel coordinates of brain landmarks in the Allen atlas.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="iblatlas.atlas.PAXINOS_CCF_LANDMARKS_MLAPDV_UM.html#iblatlas.atlas.PAXINOS_CCF_LANDMARKS_MLAPDV_UM" title="iblatlas.atlas.PAXINOS_CCF_LANDMARKS_MLAPDV_UM"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PAXINOS_CCF_LANDMARKS_MLAPDV_UM</span></code></a></p></td>
<td><p>The ML AP DV voxel coordinates of brain landmarks in the Franklin &amp; Paxinos atlas.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="iblatlas.atlas.S3_BUCKET_IBL.html#iblatlas.atlas.S3_BUCKET_IBL" title="iblatlas.atlas.S3_BUCKET_IBL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">S3_BUCKET_IBL</span></code></a></p></td>
<td><p>The name of the public IBL S3 bucket containing atlas data.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.atlas.MRITorontoAtlas" title="iblatlas.atlas.MRITorontoAtlas"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MRITorontoAtlas</span></code></a></p></td>
<td><p>The MRI Toronto brain atlas.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.atlas.NeedlesAtlas" title="iblatlas.atlas.NeedlesAtlas"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NeedlesAtlas</span></code></a></p></td>
<td><p>Instantiates an atlas.BrainAtlas corresponding to the Allen CCF at the given resolution using the IBL Bregma and coordinate system.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.atlas.cart2sph" title="iblatlas.atlas.cart2sph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cart2sph</span></code></a></p></td>
<td><p>Converts cartesian to spherical coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.atlas.get_bc" title="iblatlas.atlas.get_bc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bc</span></code></a></p></td>
<td><p>Get BrainCoordinates object for Allen Atlas with bregma origin without reading in volumes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.atlas.rodrigues_rotation" title="iblatlas.atlas.rodrigues_rotation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rodrigues_rotation</span></code></a></p></td>
<td><p>Rotate vector v around axis k by angle theta using Rodrigues' rotation formula.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.atlas.sph2cart" title="iblatlas.atlas.sph2cart"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sph2cart</span></code></a></p></td>
<td><p>Converts Spherical to Cartesian coordinates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.atlas.tilt_spherical" title="iblatlas.atlas.tilt_spherical"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tilt_spherical</span></code></a></p></td>
<td><p>Rotate the coordinates (theta, phi) around the x-axis by tilt_angle degrees.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Classes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.atlas.AllenAtlas" title="iblatlas.atlas.AllenAtlas"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AllenAtlas</span></code></a></p></td>
<td><p>The Allan Common Coordinate Framework (CCF) brain atlas.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.atlas.BrainAtlas" title="iblatlas.atlas.BrainAtlas"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BrainAtlas</span></code></a></p></td>
<td><p>Objects that holds image, labels and coordinate transforms for a brain Atlas.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.atlas.BrainCoordinates" title="iblatlas.atlas.BrainCoordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BrainCoordinates</span></code></a></p></td>
<td><p>Class for mapping and indexing a 3D array to real-world coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.atlas.FranklinPaxinosAtlas" title="iblatlas.atlas.FranklinPaxinosAtlas"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FranklinPaxinosAtlas</span></code></a></p></td>
<td><p>pathlib.PurePosixPath: The default relative path of the atlas file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.atlas.Insertion" title="iblatlas.atlas.Insertion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Insertion</span></code></a></p></td>
<td><p>Defines an ephys probe insertion in 3D coordinate.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.atlas.Trajectory" title="iblatlas.atlas.Trajectory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Trajectory</span></code></a></p></td>
<td><p>3D Trajectory (usually for a linear probe), minimally defined by a vector and a point.</p></td>
</tr>
</tbody>
</table>
<dl class="py data">
<dt class="sig sig-object py" id="iblatlas.atlas.ALLEN_CCF_LANDMARKS_MLAPDV_UM">
<span class="sig-name descname"><span class="pre">ALLEN_CCF_LANDMARKS_MLAPDV_UM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'bregma':</span> <span class="pre">array([5739,</span> <span class="pre">5400,</span>&#160; <span class="pre">332])}</span></em><a class="headerlink" href="#iblatlas.atlas.ALLEN_CCF_LANDMARKS_MLAPDV_UM" title="Link to this definition"></a></dt>
<dd><p>The ML AP DV voxel coordinates of brain landmarks in the Allen atlas.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="iblatlas.atlas.PAXINOS_CCF_LANDMARKS_MLAPDV_UM">
<span class="sig-name descname"><span class="pre">PAXINOS_CCF_LANDMARKS_MLAPDV_UM</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'bregma':</span> <span class="pre">array([5700,</span> <span class="pre">4460,</span>&#160; <span class="pre">330])}</span></em><a class="headerlink" href="#iblatlas.atlas.PAXINOS_CCF_LANDMARKS_MLAPDV_UM" title="Link to this definition"></a></dt>
<dd><p>The ML AP DV voxel coordinates of brain landmarks in the Franklin &amp; Paxinos atlas.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="iblatlas.atlas.S3_BUCKET_IBL">
<span class="sig-name descname"><span class="pre">S3_BUCKET_IBL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ibl-brain-wide-map-public'</span></em><a class="headerlink" href="#iblatlas.atlas.S3_BUCKET_IBL" title="Link to this definition"></a></dt>
<dd><p>The name of the public IBL S3 bucket containing atlas data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.atlas.cart2sph">
<span class="sig-name descname"><span class="pre">cart2sph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#cart2sph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.cart2sph" title="Link to this definition"></a></dt>
<dd><p>Converts cartesian to spherical coordinates.</p>
<p>Returns spherical coordinates (r, theta, phi).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.array</em>) – A 1D array of x-axis coordinates.</p></li>
<li><p><strong>y</strong> (<em>numpy.array</em>) – A 1D array of y-axis coordinates.</p></li>
<li><p><strong>z</strong> (<em>numpy.array</em>) – A 1D array of z-axis coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy.array</em> – The radial distance of each point.</p></li>
<li><p><em>numpy.array</em> – The polar angle.</p></li>
<li><p><em>numpy.array</em> – The azimuthal angle.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#iblatlas.atlas.sph2cart" title="iblatlas.atlas.sph2cart"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sph2cart</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.atlas.sph2cart">
<span class="sig-name descname"><span class="pre">sph2cart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#sph2cart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.sph2cart" title="Link to this definition"></a></dt>
<dd><p>Converts Spherical to Cartesian coordinates.</p>
<p>Returns Cartesian coordinates (x, y, z).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>numpy.array</em>) – A 1D array of radial distances.</p></li>
<li><p><strong>theta</strong> (<em>numpy.array</em>) – A 1D array of polar angles.</p></li>
<li><p><strong>phi</strong> (<em>numpy.array</em>) – A 1D array of azimuthal angles.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.array</em>) – A 1D array of x-axis coordinates.</p></li>
<li><p><strong>y</strong> (<em>numpy.array</em>) – A 1D array of y-axis coordinates.</p></li>
<li><p><strong>z</strong> (<em>numpy.array</em>) – A 1D array of z-axis coordinates.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#iblatlas.atlas.cart2sph" title="iblatlas.atlas.cart2sph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cart2sph</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.atlas.rodrigues_rotation">
<span class="sig-name descname"><span class="pre">rodrigues_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/iblatlas/atlas.html#rodrigues_rotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.rodrigues_rotation" title="Link to this definition"></a></dt>
<dd><p>Rotate vector v around axis k by angle theta using Rodrigues’ rotation formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>np.ndarray</em>) – The vector to be rotated, shape (3,)</p></li>
<li><p><strong>k</strong> (<em>np.ndarray</em>) – The axis of rotation (should be a unit vector), shape (3,)</p></li>
<li><p><strong>theta</strong> (<em>float</em>) – The angle of rotation in radians</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The rotated vector, shape (3,)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Rodrigues%27_rotation_formula">https://en.wikipedia.org/wiki/Rodrigues%27_rotation_formula</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.atlas.tilt_spherical">
<span class="sig-name descname"><span class="pre">tilt_spherical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tilt_angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/iblatlas/atlas.html#tilt_spherical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.tilt_spherical" title="Link to this definition"></a></dt>
<dd><p>Rotate the coordinates (theta, phi) around the x-axis by tilt_angle degrees.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<em>float</em>) – Polar angle from z+ (up) in degrees</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – Azimuthal angle from x+ (right), counter-clockwise, in degrees</p></li>
<li><p><strong>tilt_angle</strong> (<em>float</em><em>, </em><em>optional</em>) – The angle of rotation around the x-axis in degrees. Default is -5.
A positive tilt_angle lifts the mouse chin upwards.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>theta_</strong> (<em>float</em>) – The new polar angle in degrees after tilt correction</p></li>
<li><p><strong>phi_</strong> (<em>float</em>) – The new azimuthal angle in degrees after tilt correction,
normalized to the range [0, 360)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function uses the Rodrigues rotation formula to apply the tilt.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BrainCoordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nxyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dxyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainCoordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for mapping and indexing a 3D array to real-world coordinates.</p>
<ul class="simple">
<li><p>x = ml, right positive</p></li>
<li><p>y = ap, anterior positive</p></li>
<li><p>z = dv, dorsal positive</p></li>
</ul>
<p>The layout of the Atlas dimension is done according to the most used sections so they lay
contiguous on disk assuming C-ordering: V[iap, iml, idv]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nxyz</strong> (<em>array_like</em>) – Number of elements along each Cartesian axis (nx, ny, nz) = (nml, nap, ndv).</p></li>
<li><p><strong>xyz0</strong> (<em>array_like</em>) – Coordinates of the element volume[0, 0, 0] in the coordinate space.</p></li>
<li><p><strong>dxyz</strong> (<em>array_like</em><em>, </em><em>float</em>) – Spatial interval of the volume along the 3 dimensions.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.xyz0">
<span class="sig-name descname"><span class="pre">xyz0</span></span><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.xyz0" title="Link to this definition"></a></dt>
<dd><p>The Cartesian coordinates of the element volume[0, 0, 0], i.e. the origin.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.x0">
<span class="sig-name descname"><span class="pre">x0</span></span><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.x0" title="Link to this definition"></a></dt>
<dd><p>The x-axis origin coordinate of the element volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.y0">
<span class="sig-name descname"><span class="pre">y0</span></span><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.y0" title="Link to this definition"></a></dt>
<dd><p>The y-axis origin coordinate of the element volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.z0">
<span class="sig-name descname"><span class="pre">z0</span></span><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.z0" title="Link to this definition"></a></dt>
<dd><p>The z-axis origin coordinate of the element volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.dxyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dxyz</span></span><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.dxyz" title="Link to this definition"></a></dt>
<dd><p>Spatial interval of the volume along the 3 dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.nxyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nxyz</span></span><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.nxyz" title="Link to this definition"></a></dt>
<dd><p>Coordinates of the element volume[0, 0, 0] in the coordinate space.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.x2i">
<span class="sig-name descname"><span class="pre">x2i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainCoordinates.x2i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.x2i" title="Link to this definition"></a></dt>
<dd><p>Find the nearest volume image index to a given x-axis coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em><em>, </em><em>numpy.array</em>) – One or more x-axis coordinates, relative to the origin, x0.</p></li>
<li><p><strong>round</strong> (<em>bool</em>) – If true, round to the nearest index, replacing NaN values with 0.</p></li>
<li><p><strong>mode</strong> (<em>{'raise'</em><em>, </em><em>'clip'</em><em>, </em><em>'wrap'}</em><em>, </em><em>default='raise'</em>) – How to behave if the coordinate lies outside of the volume: raise (default) will raise
a ValueError; ‘clip’ will replace the index with the closest index inside the volume;
‘wrap’ will return the index as is.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The nearest indices of the image volume along the first dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – At least one x value lies outside of the atlas volume. Change ‘mode’ input to ‘wrap’ to
    keep these values unchanged, or ‘clip’ to return the nearest valid indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.y2i">
<span class="sig-name descname"><span class="pre">y2i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainCoordinates.y2i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.y2i" title="Link to this definition"></a></dt>
<dd><p>Find the nearest volume image index to a given y-axis coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>float</em><em>, </em><em>numpy.array</em>) – One or more y-axis coordinates, relative to the origin, y0.</p></li>
<li><p><strong>round</strong> (<em>bool</em>) – If true, round to the nearest index, replacing NaN values with 0.</p></li>
<li><p><strong>mode</strong> (<em>{'raise'</em><em>, </em><em>'clip'</em><em>, </em><em>'wrap'}</em>) – How to behave if the coordinate lies outside of the volume: raise (default) will raise
a ValueError; ‘clip’ will replace the index with the closest index inside the volume;
‘wrap’ will return the index as is.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The nearest indices of the image volume along the second dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – At least one y value lies outside of the atlas volume. Change ‘mode’ input to ‘wrap’ to
    keep these values unchanged, or ‘clip’ to return the nearest valid indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.z2i">
<span class="sig-name descname"><span class="pre">z2i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainCoordinates.z2i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.z2i" title="Link to this definition"></a></dt>
<dd><p>Find the nearest volume image index to a given z-axis coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>float</em><em>, </em><em>numpy.array</em>) – One or more z-axis coordinates, relative to the origin, z0.</p></li>
<li><p><strong>round</strong> (<em>bool</em>) – If true, round to the nearest index, replacing NaN values with 0.</p></li>
<li><p><strong>mode</strong> (<em>{'raise'</em><em>, </em><em>'clip'</em><em>, </em><em>'wrap'}</em>) – How to behave if the coordinate lies outside of the volume: raise (default) will raise
a ValueError; ‘clip’ will replace the index with the closest index inside the volume;
‘wrap’ will return the index as is.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The nearest indices of the image volume along the third dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – At least one z value lies outside of the atlas volume. Change ‘mode’ input to ‘wrap’ to
    keep these values unchanged, or ‘clip’ to return the nearest valid indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.xyz2i">
<span class="sig-name descname"><span class="pre">xyz2i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainCoordinates.xyz2i"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.xyz2i" title="Link to this definition"></a></dt>
<dd><p>Find the nearest volume image indices to the given Cartesian coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> (<em>array_like</em>) – One or more Cartesian coordinates, relative to the origin, xyz0.</p></li>
<li><p><strong>round</strong> (<em>bool</em>) – If true, round to the nearest index, replacing NaN values with 0.</p></li>
<li><p><strong>mode</strong> (<em>{'raise'</em><em>, </em><em>'clip'</em><em>, </em><em>'wrap'}</em>) – How to behave if any coordinate lies outside of the volume: raise (default) will raise
a ValueError; ‘clip’ will replace the index with the closest index inside the volume;
‘wrap’ will return the index as is.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The nearest indices of the image volume.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – At least one coordinate lies outside of the atlas volume. Change ‘mode’ input to ‘wrap’
    to keep these values unchanged, or ‘clip’ to return the nearest valid indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.i2x">
<span class="sig-name descname"><span class="pre">i2x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ind</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainCoordinates.i2x"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.i2x" title="Link to this definition"></a></dt>
<dd><p>Return the x-axis coordinate of a given index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ind</strong> (<em>int</em><em>, </em><em>numpy.array</em>) – One or more indices along the first dimension of the image volume.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The corresponding x-axis coordinate(s), relative to the origin, x0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.i2y">
<span class="sig-name descname"><span class="pre">i2y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ind</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainCoordinates.i2y"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.i2y" title="Link to this definition"></a></dt>
<dd><p>Return the y-axis coordinate of a given index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ind</strong> (<em>int</em><em>, </em><em>numpy.array</em>) – One or more indices along the second dimension of the image volume.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The corresponding y-axis coordinate(s), relative to the origin, y0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.i2z">
<span class="sig-name descname"><span class="pre">i2z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ind</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainCoordinates.i2z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.i2z" title="Link to this definition"></a></dt>
<dd><p>Return the z-axis coordinate of a given index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ind</strong> (<em>int</em><em>, </em><em>numpy.array</em>) – One or more indices along the third dimension of the image volume.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The corresponding z-axis coordinate(s), relative to the origin, z0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float, numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.i2xyz">
<span class="sig-name descname"><span class="pre">i2xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iii</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainCoordinates.i2xyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.i2xyz" title="Link to this definition"></a></dt>
<dd><p>Return the Cartesian coordinates of a given index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>iii</strong> (<em>array_like</em>) – One or more image volume indices.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The corresponding xyz coordinates, relative to the origin, xyz0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.xlim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xlim</span></span><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.xlim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.ylim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ylim</span></span><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.ylim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.zlim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zlim</span></span><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.zlim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.lim">
<span class="sig-name descname"><span class="pre">lim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainCoordinates.lim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.lim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.xscale">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xscale</span></span><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.xscale" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.yscale">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">yscale</span></span><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.yscale" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.zscale">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zscale</span></span><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.zscale" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainCoordinates.mgrid">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mgrid</span></span><a class="headerlink" href="#iblatlas.atlas.BrainCoordinates.mgrid" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BrainAtlas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dxyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iorigin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims2xyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz2dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1,</span> <span class="pre">2]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Objects that holds image, labels and coordinate transforms for a brain Atlas.
Currently this is designed for the AllenCCF at several resolutions,
yet this class can be used for other atlases arises.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.volumes">
<span class="sig-name descname"><span class="pre">volumes</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.volumes" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.image">
<span class="sig-name descname"><span class="pre">image</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.image" title="Link to this definition"></a></dt>
<dd><p>A 3D annotation label volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.label">
<span class="sig-name descname"><span class="pre">label</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.label" title="Link to this definition"></a></dt>
<dd><p>One or several optional data volumes, the 3 last dimensions should match
the image and the label volumes dimensions</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.mask">
<span class="sig-name descname"><span class="pre">mask</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas.mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.mask" title="Link to this definition"></a></dt>
<dd><p>Returns a Boolean mask volume of the brain atlas, where 1 is inside the convex brain and 0 is outside
This returns an ovoid volume shaped like the brain and this will contain void values in the ventricules.
:return: np.array Bool (nap, nml, ndv)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.compute_surface">
<span class="sig-name descname"><span class="pre">compute_surface</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas.compute_surface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.compute_surface" title="Link to this definition"></a></dt>
<dd><p>Get the volume top, bottom, left and right surfaces, and from these the outer surface of
the image volume. This is needed to compute probe insertions intersections.</p>
<p>NOTE: In places where the top or bottom surface touch the top or bottom of the atlas volume, the surface
will be set to np.nan. If you encounter issues working with these surfaces check if this might be the cause.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.get_labels">
<span class="sig-name descname"><span class="pre">get_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_um</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas.get_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.get_labels" title="Link to this definition"></a></dt>
<dd><p>Performs a 3D lookup from real world coordinates to the volume labels
and return the regions ids according to the mapping</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> – [n, 3] array of coordinates</p></li>
<li><p><strong>mapping</strong> – brain region mapping (defaults to original Allen mapping)</p></li>
<li><p><strong>radius_um</strong> – if not null, returns a regions ids array and an array of proportion
of regions in a sphere of size radius around the coordinates.</p></li>
<li><p><strong>mode</strong> – {‘raise’, ‘clip’} determines what to do when determined index lies outside the atlas volume</p></li>
</ul>
</dd>
</dl>
<p>‘raise’ will raise a ValueError (default)
‘clip’ will replace the index with the closest index inside the volume
:return: n array of region ids</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.tilted_slice">
<span class="sig-name descname"><span class="pre">tilted_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'image'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas.tilted_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.tilted_slice" title="Link to this definition"></a></dt>
<dd><p>From line coordinates, extracts the tilted plane containing the line from the 3D volume</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xyz</strong> – np.array: points defining a probe trajectory in 3D space (xyz triplets)</p>
</dd>
</dl>
<p>if more than 2 points are provided will take the best fit
:param axis:</p>
<blockquote>
<div><p>0: along ml = sagittal-slice
1: along ap = coronal-slice
2: along dv = horizontal-slice</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>volume</strong> – ‘image’ or ‘annotation’</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>np.array, abscissa extent (width), ordinate extent (height),</p>
</dd>
</dl>
<p>squeezed axis extent (depth)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.plot_tilted_slice">
<span class="sig-name descname"><span class="pre">plot_tilted_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'image'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas.plot_tilted_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.plot_tilted_slice" title="Link to this definition"></a></dt>
<dd><p>From line coordinates, extracts the tilted plane containing the line from the 3D volume</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xyz</strong> – np.array: points defining a probe trajectory in 3D space (xyz triplets)</p>
</dd>
</dl>
<p>if more than 2 points are provided will take the best fit
:param axis:</p>
<blockquote>
<div><p>0: along ml = sagittal-slice
1: along ap = coronal-slice
2: along dv = horizontal-slice</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>volume</strong> – ‘image’ or ‘annotation’</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib axis</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.extent">
<span class="sig-name descname"><span class="pre">extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas.extent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.extent" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axis</strong> – direction along which the volume is stacked:
(2 = z for horizontal slice)
(1 = y for coronal slice)
(0 = x for sagittal slice)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.slice">
<span class="sig-name descname"><span class="pre">slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'image'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas.slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.slice" title="Link to this definition"></a></dt>
<dd><p>Get slice through atlas</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coordinate</strong> – coordinate to slice in metres, float</p></li>
<li><p><strong>axis</strong> – xyz convention:  0 for ml, 1 for ap, 2 for dv
- 0: sagittal slice (along ml axis)
- 1: coronal slice (along ap axis)
- 2: horizontal slice (along dv axis)</p></li>
<li><p><strong>volume</strong> – <ul>
<li><p>‘image’ - allen image volume</p></li>
<li><p>’rindex’ - brain region index value</p></li>
<li><p>’annotation’ - allen annotation volume</p></li>
<li><p>’surface’ - outer surface of mesh</p></li>
<li><p>’boundary’ - outline of boundaries between all regions</p></li>
<li><p>’volume’ - custom volume, must pass in volume of shape ba.image.shape as regions_value argument</p></li>
<li><p>’value’ - custom value per allen region, must pass in array of shape ba.regions.id as regions_value argument</p></li>
</ul>
</p></li>
<li><p><strong>mode</strong> – error mode for out of bounds coordinates
-   ‘raise’ raise an error
-   ‘clip’ gets the first or last index</p></li>
<li><p><strong>region_values</strong> – custom values to plot
- if volume=’volume’, region_values must have shape ba.image.shape
- if volume=’value’, region_values must have shape ba.regions.id</p></li>
<li><p><strong>mapping</strong> – mapping to use. Options can be found using ba.regions.mappings.keys()</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2d array or 3d RGB numpy int8 array of dimensions:
- 0: nap x ndv (sagittal slice)
- 1: nml x ndv (coronal slice)
- 2: nap x nml (horizontal slice)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.compute_boundaries">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_boundaries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas.compute_boundaries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.compute_boundaries" title="Link to this definition"></a></dt>
<dd><p>Compute the boundaries between regions on slice</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.plot_slices">
<span class="sig-name descname"><span class="pre">plot_slices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas.plot_slices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.plot_slices" title="Link to this definition"></a></dt>
<dd><p>From a single coordinate, plots the 3 slices that intersect at this point in a single
matplotlib figure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> – mlapdv coordinate in m</p></li>
<li><p><strong>args</strong> – arguments to be forwarded to plot slices</p></li>
<li><p><strong>kwargs</strong> – keyword arguments to be forwarded to plot slices</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2 by 2 array of axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.plot_cslice">
<span class="sig-name descname"><span class="pre">plot_cslice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ap_coordinate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'image'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas.plot_cslice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.plot_cslice" title="Link to this definition"></a></dt>
<dd><p>Plot coronal slice through atlas at given ap_coordinate</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>ap_coordinate (m)</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>volume</strong> – <ul>
<li><p>‘image’ - allen image volume</p></li>
<li><p>’annotation’ - allen annotation volume</p></li>
<li><p>’surface’ - outer surface of mesh</p></li>
<li><p>’boundary’ - outline of boundaries between all regions</p></li>
<li><p>’volume’ - custom volume, must pass in volume of shape ba.image.shape as regions_value argument</p></li>
<li><p>’value’ - custom value per allen region, must pass in array of shape ba.regions.id as regions_value argument</p></li>
</ul>
</p></li>
<li><p><strong>mapping</strong> – mapping to use. Options can be found using ba.regions.mappings.keys()</p></li>
<li><p><strong>region_values</strong> – custom values to plot
- if volume=’volume’, region_values must have shape ba.image.shape
- if volume=’value’, region_values must have shape ba.regions.id</p></li>
<li><p><strong>mapping</strong> – mapping to use. Options can be found using ba.regions.mappings.keys()</p></li>
<li><p><strong>**kwargs</strong> – <p>matplotlib.pyplot.imshow kwarg arguments</p>
</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib ax object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.plot_hslice">
<span class="sig-name descname"><span class="pre">plot_hslice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dv_coordinate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'image'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas.plot_hslice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.plot_hslice" title="Link to this definition"></a></dt>
<dd><p>Plot horizontal slice through atlas at given dv_coordinate</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>dv_coordinate (m)</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>volume</strong> – <ul>
<li><p>‘image’ - allen image volume</p></li>
<li><p>’annotation’ - allen annotation volume</p></li>
<li><p>’surface’ - outer surface of mesh</p></li>
<li><p>’boundary’ - outline of boundaries between all regions</p></li>
<li><p>’volume’ - custom volume, must pass in volume of shape ba.image.shape as regions_value argument</p></li>
<li><p>’value’ - custom value per allen region, must pass in array of shape ba.regions.id as regions_value argument</p></li>
</ul>
</p></li>
<li><p><strong>mapping</strong> – mapping to use. Options can be found using ba.regions.mappings.keys()</p></li>
<li><p><strong>region_values</strong> – custom values to plot
- if volume=’volume’, region_values must have shape ba.image.shape
- if volume=’value’, region_values must have shape ba.regions.id</p></li>
<li><p><strong>mapping</strong> – mapping to use. Options can be found using ba.regions.mappings.keys()</p></li>
<li><p><strong>**kwargs</strong> – <p>matplotlib.pyplot.imshow kwarg arguments</p>
</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib ax object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.plot_sslice">
<span class="sig-name descname"><span class="pre">plot_sslice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ml_coordinate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'image'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas.plot_sslice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.plot_sslice" title="Link to this definition"></a></dt>
<dd><p>Plot sagittal slice through atlas at given ml_coordinate</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>ml_coordinate (m)</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>volume</strong> – <ul>
<li><p>‘image’ - allen image volume</p></li>
<li><p>’annotation’ - allen annotation volume</p></li>
<li><p>’surface’ - outer surface of mesh</p></li>
<li><p>’boundary’ - outline of boundaries between all regions</p></li>
<li><p>’volume’ - custom volume, must pass in volume of shape ba.image.shape as regions_value argument</p></li>
<li><p>’value’ - custom value per allen region, must pass in array of shape ba.regions.id as regions_value argument</p></li>
</ul>
</p></li>
<li><p><strong>mapping</strong> – mapping to use. Options can be found using ba.regions.mappings.keys()</p></li>
<li><p><strong>region_values</strong> – custom values to plot
- if volume=’volume’, region_values must have shape ba.image.shape
- if volume=’value’, region_values must have shape ba.regions.id</p></li>
<li><p><strong>mapping</strong> – mapping to use. Options can be found using ba.regions.mappings.keys()</p></li>
<li><p><strong>**kwargs</strong> – <p>matplotlib.pyplot.imshow kwarg arguments</p>
</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib ax object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.BrainAtlas.plot_top">
<span class="sig-name descname"><span class="pre">plot_top</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'annotation'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#BrainAtlas.plot_top"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.BrainAtlas.plot_top" title="Link to this definition"></a></dt>
<dd><p>Plot top view of atlas</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume</strong> – <ul>
<li><p>‘image’ - allen image volume</p></li>
<li><p>’annotation’ - allen annotation volume</p></li>
<li><p>’boundary’ - outline of boundaries between all regions</p></li>
<li><p>’volume’ - custom volume, must pass in volume of shape ba.image.shape as regions_value argument</p></li>
<li><p>’value’ - custom value per allen region, must pass in array of shape ba.regions.id as regions_value argument</p></li>
</ul>
</p></li>
<li><p><strong>mapping</strong> – mapping to use. Options can be found using ba.regions.mappings.keys()</p></li>
<li><p><strong>region_values</strong></p></li>
<li><p><strong>ax</strong></p></li>
<li><p><strong>kwargs</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="iblatlas.atlas.Trajectory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Trajectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#Trajectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.Trajectory" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>3D Trajectory (usually for a linear probe), minimally defined by a vector and a point.</p>
<p class="rubric">Examples</p>
<p>Instantiate from a best fit from an n by 3 array containing xyz coordinates:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trj</span> <span class="o">=</span> <span class="n">Trajectory</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.Trajectory.vector">
<span class="sig-name descname"><span class="pre">vector</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#iblatlas.atlas.Trajectory.vector" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.Trajectory.point">
<span class="sig-name descname"><span class="pre">point</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#iblatlas.atlas.Trajectory.point" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.Trajectory.fit">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#Trajectory.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.Trajectory.fit" title="Link to this definition"></a></dt>
<dd><p>Fits a line to a 3D cloud of points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xyz</strong> (<em>numpy.array</em>) – An n by 3 array containing a cloud of points to fit a line to.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new trajectory object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#iblatlas.atlas.Trajectory" title="iblatlas.atlas.Trajectory">Trajectory</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.Trajectory.eval_x">
<span class="sig-name descname"><span class="pre">eval_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#Trajectory.eval_x"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.Trajectory.eval_x" title="Link to this definition"></a></dt>
<dd><p>given an array of x coordinates, returns the xyz array of coordinates along the insertion</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – n by 1 or numpy array containing x-coordinates</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>n by 3 numpy array containing xyz-coordinates</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.Trajectory.eval_y">
<span class="sig-name descname"><span class="pre">eval_y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#Trajectory.eval_y"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.Trajectory.eval_y" title="Link to this definition"></a></dt>
<dd><p>given an array of y coordinates, returns the xyz array of coordinates along the insertion</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y</strong> – n by 1 or numpy array containing y-coordinates</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>n by 3 numpy array containing xyz-coordinates</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.Trajectory.eval_z">
<span class="sig-name descname"><span class="pre">eval_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#Trajectory.eval_z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.Trajectory.eval_z" title="Link to this definition"></a></dt>
<dd><p>given an array of z coordinates, returns the xyz array of coordinates along the insertion</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> – n by 1 or numpy array containing z-coordinates</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>n by 3 numpy array containing xyz-coordinates</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.Trajectory.project">
<span class="sig-name descname"><span class="pre">project</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#Trajectory.project"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.Trajectory.project" title="Link to this definition"></a></dt>
<dd><p>projects a point onto the trajectory line</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>point</strong> – np.array(x, y, z) coordinates</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.Trajectory.mindist">
<span class="sig-name descname"><span class="pre">mindist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#Trajectory.mindist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.Trajectory.mindist" title="Link to this definition"></a></dt>
<dd><p>Computes the minimum distance to the trajectory line for one or a set of points.
If bounds are provided, computes the minimum distance to the segment instead of an
infinite line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> – […, 3]</p></li>
<li><p><strong>bounds</strong> – defaults to None.  np.array [2, 3]: segment boundaries, inf line if None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>minimum distance […]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.Trajectory.exit_points">
<span class="sig-name descname"><span class="pre">exit_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#Trajectory.exit_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.Trajectory.exit_points" title="Link to this definition"></a></dt>
<dd><p>Given a Trajectory and a BrainCoordinates object, computes the intersection of the
trajectory with the brain coordinates bounding box</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bc</strong> – BrainCoordinate objects</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray 2 y 3 corresponding to exit points xyz coordinates</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Insertion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#Insertion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.Insertion" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines an ephys probe insertion in 3D coordinate. IBL conventions.</p>
<p>To instantiate, use the static methods: <cite>Insertion.from_track</cite> and <cite>Insertion.from_dict</cite>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.x">
<span class="sig-name descname"><span class="pre">x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#iblatlas.atlas.Insertion.x" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.y">
<span class="sig-name descname"><span class="pre">y</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#iblatlas.atlas.Insertion.y" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.z">
<span class="sig-name descname"><span class="pre">z</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#iblatlas.atlas.Insertion.z" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.phi">
<span class="sig-name descname"><span class="pre">phi</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#iblatlas.atlas.Insertion.phi" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.theta">
<span class="sig-name descname"><span class="pre">theta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#iblatlas.atlas.Insertion.theta" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.depth">
<span class="sig-name descname"><span class="pre">depth</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#iblatlas.atlas.Insertion.depth" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.label">
<span class="sig-name descname"><span class="pre">label</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#iblatlas.atlas.Insertion.label" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.beta">
<span class="sig-name descname"><span class="pre">beta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#iblatlas.atlas.Insertion.beta" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.from_track">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_track</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyzs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_atlas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#Insertion.from_track"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.Insertion.from_track" title="Link to this definition"></a></dt>
<dd><p>Define an insersion from one or more trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyzs</strong> (<em>numpy.array</em>) – An n by 3 array xyz coordinates representing an insertion trajectory.</p></li>
<li><p><strong>brain_atlas</strong> (<a class="reference internal" href="#iblatlas.atlas.BrainAtlas" title="iblatlas.atlas.BrainAtlas"><em>BrainAtlas</em></a>) – A brain atlas instance, used to attain the point of entry.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#iblatlas.atlas.Insertion" title="iblatlas.atlas.Insertion">Insertion</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.from_dict">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_atlas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#Insertion.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.Insertion.from_dict" title="Link to this definition"></a></dt>
<dd><p>Constructs an Insertion object from the json information stored in probes.description file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>dict</em>) – A dictionary containing at least the following keys {‘x’, ‘y’, ‘z’, ‘phi’, ‘theta’,
‘depth’}.  The depth and xyz coordinates must be in um.</p></li>
<li><p><strong>brain_atlas</strong> (<a class="reference internal" href="#iblatlas.atlas.BrainAtlas" title="iblatlas.atlas.BrainAtlas"><em>BrainAtlas</em></a><em>, </em><em>default=None</em>) – If provided, disregards the z coordinate and locks the insertion point to the z of the
brain surface.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#iblatlas.atlas.Insertion" title="iblatlas.atlas.Insertion">Insertion</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tri</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mf">544.0</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mf">1285.0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;phi&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;theta&#39;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">:</span> <span class="mf">4501.0</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ins</span> <span class="o">=</span> <span class="n">Insertion</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">tri</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.trajectory">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trajectory</span></span><a class="headerlink" href="#iblatlas.atlas.Insertion.trajectory" title="Link to this definition"></a></dt>
<dd><p>Gets the trajectory object matching insertion coordinates
:return: atlas.Trajectory</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.xyz">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xyz</span></span><a class="headerlink" href="#iblatlas.atlas.Insertion.xyz" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.entry">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">entry</span></span><a class="headerlink" href="#iblatlas.atlas.Insertion.entry" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.tip">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tip</span></span><a class="headerlink" href="#iblatlas.atlas.Insertion.tip" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.get_brain_exit">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_brain_exit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_atlas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#Insertion.get_brain_exit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.Insertion.get_brain_exit" title="Link to this definition"></a></dt>
<dd><p>Given a Trajectory and a BrainAtlas object, computes the brain exit coordinate as the
intersection of the trajectory and the brain surface (brain_atlas.surface)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>brain_atlas</strong></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3 element array x,y,z</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.Insertion.get_brain_entry">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_brain_entry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_atlas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#Insertion.get_brain_entry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.Insertion.get_brain_entry" title="Link to this definition"></a></dt>
<dd><p>Given a Trajectory and a BrainAtlas object, computes the brain entry coordinate as the
intersection of the trajectory and the brain surface (brain_atlas.surface)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>brain_atlas</strong></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3 element array x,y,z</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="iblatlas.atlas.AllenAtlas">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AllenAtlas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res_um</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#AllenAtlas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.AllenAtlas" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#iblatlas.atlas.BrainAtlas" title="iblatlas.atlas.BrainAtlas"><code class="xref py py-class docutils literal notranslate"><span class="pre">BrainAtlas</span></code></a></p>
<p>The Allan Common Coordinate Framework (CCF) brain atlas.</p>
<p>Instantiates an atlas.BrainAtlas corresponding to the Allen CCF at the given resolution
using the IBL Bregma and coordinate system.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.AllenAtlas.atlas_rel_path">
<span class="sig-name descname"><span class="pre">atlas_rel_path</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">PurePosixPath('histology/ATLAS/Needles/Allen')</span></em><a class="headerlink" href="#iblatlas.atlas.AllenAtlas.atlas_rel_path" title="Link to this definition"></a></dt>
<dd><p>A diffusion weighted imaging (DWI) image volume.</p>
<p>This average template brain was created from images of 1,675 young adult C57BL/6J mouse brains
acquired using serial two-photon tomography.
This volume has a C-ordered shape of (ap, ml, dv) and contains uint16
values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.AllenAtlas.image">
<span class="sig-name descname"><span class="pre">image</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#iblatlas.atlas.AllenAtlas.image" title="Link to this definition"></a></dt>
<dd><p>An annotation label volume.</p>
<p>The Allen atlas label volume has with the shape (ap, ml, dv) and contains uint16 indices
of the Allen CCF brain regions to which each voxel belongs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.AllenAtlas.label">
<span class="sig-name descname"><span class="pre">label</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#iblatlas.atlas.AllenAtlas.label" title="Link to this definition"></a></dt>
<dd><p>One or several optional data volumes, the 3 last dimensions should match
the image and the label volumes dimensions</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.AllenAtlas.xyz2ccf">
<span class="sig-name descname"><span class="pre">xyz2ccf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccf_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mlapdv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'raise'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#AllenAtlas.xyz2ccf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.AllenAtlas.xyz2ccf" title="Link to this definition"></a></dt>
<dd><p>Converts anatomical coordinates to CCF coordinates.</p>
<p>Anatomical coordinates are in meters, relative to bregma, which CFF coordinates are
assumed to be the volume indices multiplied by the spacing in micormeters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> (<em>numpy.array</em>) – An N by 3 array of anatomical coordinates in meters, relative to bregma.</p></li>
<li><p><strong>ccf_order</strong> (<em>{'mlapdv'</em><em>, </em><em>'apdvml'}</em><em>, </em><em>default='mlapdv'</em>) – The order of the CCF coordinates returned. For IBL (the default) this is (ML, AP, DV),
for Allen MCC vertices, this is (AP, DV, ML).</p></li>
<li><p><strong>mode</strong> (<em>{'raise'</em><em>, </em><em>'clip'</em><em>, </em><em>'wrap'}</em><em>, </em><em>default='raise'</em>) – How to behave if the coordinate lies outside of the volume: raise (default) will raise
a ValueError; ‘clip’ will replace the index with the closest index inside the volume;
‘wrap’ will return the index as is.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy.array</em> – Coordinates in CCF space (um, origin is the front left top corner of the data</p></li>
<li><p><em>volume, order determined by ccf_order</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.AllenAtlas.ccf2xyz">
<span class="sig-name descname"><span class="pre">ccf2xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ccf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ccf_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mlapdv'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#AllenAtlas.ccf2xyz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.AllenAtlas.ccf2xyz" title="Link to this definition"></a></dt>
<dd><p>Convert anatomical coordinates from CCF coordinates.</p>
<p>Anatomical coordinates are in meters, relative to bregma, which CFF coordinates are
assumed to be the volume indices multiplied by the spacing in micormeters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ccf</strong> (<em>numpy.array</em>) – An N by 3 array of coordinates in CCF space (atlas volume indices * um resolution). The
origin is the front left top corner of the data volume.</p></li>
<li><p><strong>ccf_order</strong> (<em>{'mlapdv'</em><em>, </em><em>'apdvml'}</em><em>, </em><em>default='mlapdv'</em>) – The order of the CCF coordinates given. For IBL (the default) this is (ML, AP, DV),
for Allen MCC vertices, this is (AP, DV, ML).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The MLAPDV coordinates in meters, relative to bregma.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="iblatlas.atlas.AllenAtlas.compute_regions_volume">
<span class="sig-name descname"><span class="pre">compute_regions_volume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cumsum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#AllenAtlas.compute_regions_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.AllenAtlas.compute_regions_volume" title="Link to this definition"></a></dt>
<dd><p>Sums the number of voxels in the labels volume for each region.
Then compute volumes for all of the levels of hierarchy in cubic mm.</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>cumsum: computes the cumulative sum of the volume as per the hierarchy (defaults to False)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.atlas.NeedlesAtlas">
<span class="sig-name descname"><span class="pre">NeedlesAtlas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#iblatlas.atlas.AllenAtlas" title="iblatlas.atlas.AllenAtlas"><span class="pre">AllenAtlas</span></a></span></span><a class="reference internal" href="../_modules/iblatlas/atlas.html#NeedlesAtlas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.NeedlesAtlas" title="Link to this definition"></a></dt>
<dd><p>Instantiates an atlas.BrainAtlas corresponding to the Allen CCF at the given resolution
using the IBL Bregma and coordinate system. The Needles atlas defines a stretch along AP
axis and a squeeze along the DV axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res_um</strong> (<em>{10</em><em>, </em><em>25</em><em>, </em><em>50} int</em>) – The Atlas resolution in micrometres; one of 10, 25 or 50um.</p></li>
<li><p><strong>**kwargs</strong> – See AllenAtlas.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An Allen atlas object with MRI atlas scaling applied.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#iblatlas.atlas.AllenAtlas" title="iblatlas.atlas.AllenAtlas">AllenAtlas</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The scaling was determined by manually transforming the DSURQE atlas <a href="#id11"><span class="problematic" id="id7">[1]_</span></a> onto the Allen CCF.
The DSURQE atlas is an MRI atlas acquired from 40 C57BL/6J mice post-mortem, with 40um
isometric resolution.  The alignment was performed by Mayo Faulkner.
The atlas data can be found <a class="reference external" href="http://repo.mouseimaging.ca/repo/DSURQE_40micron_nifti/">here</a>.
More information on the dataset and segmentation can be found
<a class="reference external" href="http://repo.mouseimaging.ca/repo/DSURQE_40micron/notes_on_DSURQE_atlas">here</a>.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Dorr AE, Lerch JP, Spring S, Kabani N, Henkelman RM (2008). High resolution
three-dimensional brain atlas using an average magnetic resonance image of 40 adult C57Bl/6J
mice. Neuroimage 42(1):60-9. [doi 10.1016/j.neuroimage.2008.03.037]</p>
</aside>
</aside>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.atlas.MRITorontoAtlas">
<span class="sig-name descname"><span class="pre">MRITorontoAtlas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#MRITorontoAtlas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.MRITorontoAtlas" title="Link to this definition"></a></dt>
<dd><p>The MRI Toronto brain atlas.</p>
<p>Instantiates an atlas.BrainAtlas corresponding to the Allen CCF at the given resolution
using the IBL Bregma and coordinate system. The MRI Toronto atlas defines a stretch along AP
a squeeze along DV <em>and</em> a squeeze along ML. These are based on 12 p65 mice MRIs averaged <a href="#id12"><span class="problematic" id="id9">[1]_</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res_um</strong> (<em>{10</em><em>, </em><em>25</em><em>, </em><em>50} int</em>) – The Atlas resolution in micrometres; one of 10, 25 or 50um.</p></li>
<li><p><strong>**kwargs</strong> – See AllenAtlas.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An Allen atlas object with MRI atlas scaling applied.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#iblatlas.atlas.AllenAtlas" title="iblatlas.atlas.AllenAtlas">AllenAtlas</a></p>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id10" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Qiu, LR, Fernandes, DJ, Szulc-Lerch, KU et al. (2018) Mouse MRI shows brain areas
relatively larger in males emerge before those larger in females. Nat Commun 9, 2615.
[doi 10.1038/s41467-018-04921-2]</p>
</aside>
</aside>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="iblatlas.atlas.FranklinPaxinosAtlas">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FranklinPaxinosAtlas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res_um</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">100,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mock</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#FranklinPaxinosAtlas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.FranklinPaxinosAtlas" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#iblatlas.atlas.BrainAtlas" title="iblatlas.atlas.BrainAtlas"><code class="xref py py-class docutils literal notranslate"><span class="pre">BrainAtlas</span></code></a></p>
<p>pathlib.PurePosixPath: The default relative path of the atlas file.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="iblatlas.atlas.FranklinPaxinosAtlas.atlas_rel_path">
<span class="sig-name descname"><span class="pre">atlas_rel_path</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">PurePosixPath('histology/ATLAS/Needles/FranklinPaxinos')</span></em><a class="headerlink" href="#iblatlas.atlas.FranklinPaxinosAtlas.atlas_rel_path" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.atlas.get_bc">
<span class="sig-name descname"><span class="pre">get_bc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res_um</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/atlas.html#get_bc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.atlas.get_bc" title="Link to this definition"></a></dt>
<dd><p>Get BrainCoordinates object for Allen Atlas with bregma origin without reading in volumes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>res_um</strong> (<em>float</em><em> or </em><em>int</em>) – The resolution of the brain coordinates object to return in um. Options are 50, 25 or 10</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>BrainCoordinates object with bregma origin</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="iblatlas.html" class="btn btn-neutral float-left" title="iblatlas" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="iblatlas.atlas.ALLEN_CCF_LANDMARKS_MLAPDV_UM.html" class="btn btn-neutral float-right" title="iblatlas.atlas.ALLEN_CCF_LANDMARKS_MLAPDV_UM" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, International Brain Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>