<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ibllib.dsp.smooth &mdash; IBL Library  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ibllib.dsp.utils" href="ibllib.dsp.utils.html" />
    <link rel="prev" title="ibllib.dsp.savitzky_golay" href="ibllib.dsp.savitzky_golay.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> IBL Library
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The Open Neurophysiology Environment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/one_quickstart.html">ONE Quick Start</a></li>
<li class="toctree-l1"><a class="reference external" href="https://int-brain-lab.github.io/ONE/">Full documentation Website for ONE</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DataJoint</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dj_docs/dj_introduction.html">Introduction to DataJoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dj_docs/dj_public.html">Publicly available IBL data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dj_docs/dj_credentials.html">DataJoint credentials for internal IBL users</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Public</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/public_introduction.html">Publicly available IBL data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exploring IBL Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../loading_examples.html">Loading Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_installation.html">Unified Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09_contribution.html">How to contribute</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples &amp; Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../06_examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/dj_intro/dj_intro.html">Datajoint Introductory Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/dj_basics/dj_basics.html">Exploring the IBL Data Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/docs_wheel_moves.html">Working with wheel data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../010_api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="ibllib.html">ibllib</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ibllib.atlas.html">ibllib.atlas</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="ibllib.dsp.html">ibllib.dsp</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="ibllib.dsp.cadzow.html">ibllib.dsp.cadzow</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibllib.dsp.fourier.html">ibllib.dsp.fourier</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibllib.dsp.savitzky_golay.html">ibllib.dsp.savitzky_golay</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">ibllib.dsp.smooth</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibllib.dsp.utils.html">ibllib.dsp.utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibllib.dsp.voltage.html">ibllib.dsp.voltage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.ephys.html">ibllib.ephys</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.exceptions.html">ibllib.exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.graphic.html">ibllib.graphic</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.io.html">ibllib.io</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.misc.html">ibllib.misc</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.oneibl.html">ibllib.oneibl</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.pipes.html">ibllib.pipes</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.plots.html">ibllib.plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.qc.html">ibllib.qc</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.tests.html">ibllib.tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.time.html">ibllib.time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="brainbox.html">brainbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="iblviewer.html">iblviewer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Detailed Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IBL Library</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../010_api_reference.html">API Reference</a> &raquo;</li>
          <li><a href="ibllib.html">ibllib</a> &raquo;</li>
          <li><a href="ibllib.dsp.html">ibllib.dsp</a> &raquo;</li>
      <li>ibllib.dsp.smooth</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/ibllib.dsp.smooth.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="module-ibllib.dsp.smooth">
<span id="ibllib-dsp-smooth"></span><h1>ibllib.dsp.smooth<a class="headerlink" href="#module-ibllib.dsp.smooth" title="Permalink to this headline"></a></h1>
<p class="rubric">Functions</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibllib.dsp.smooth.lp" title="ibllib.dsp.smooth.lp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lp</span></code></a></p></td>
<td><p>Smooth the data in frequency domain (assumes a uniform sampling rate), using edge padding</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibllib.dsp.smooth.non_uniform_savgol" title="ibllib.dsp.smooth.non_uniform_savgol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_uniform_savgol</span></code></a></p></td>
<td><p>Applies a Savitzky-Golay filter to y with non-uniform spacing as defined in x.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibllib.dsp.smooth.rolling_window" title="ibllib.dsp.smooth.rolling_window"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rolling_window</span></code></a></p></td>
<td><p>Smooth the data using a window with requested size.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#ibllib.dsp.smooth.smooth_demo" title="ibllib.dsp.smooth.smooth_demo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smooth_demo</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibllib.dsp.smooth.smooth_interpolate_savgol" title="ibllib.dsp.smooth.smooth_interpolate_savgol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smooth_interpolate_savgol</span></code></a></p></td>
<td><p>Run savitzy-golay filter on signal, interpolate through nan points.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="ibllib.dsp.smooth.lp">
<span class="sig-name descname"><span class="pre">lp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/dsp/smooth.html#lp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ibllib.dsp.smooth.lp" title="Permalink to this definition"></a></dt>
<dd><p>Smooth the data in frequency domain (assumes a uniform sampling rate), using edge padding</p>
<p>ibllib.dsp.smooth.lp(ts, [.1, .15])</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> – input signal to be smoothed</p></li>
<li><p><strong>fac</strong> – 2 element vector of the frequency edges relative to Nyquist: [0.15, 0.2] keeps</p></li>
</ul>
</dd>
</dl>
<p>everything up to 15% of the full band tapering down to 20%
:param pad: padding on the edges of the time serie, between 0 and 1 (0.2 means 20% of the size)
:return: smoothed time series</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ibllib.dsp.smooth.rolling_window">
<span class="sig-name descname"><span class="pre">rolling_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'blackman'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/dsp/smooth.html#rolling_window"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ibllib.dsp.smooth.rolling_window" title="Permalink to this definition"></a></dt>
<dd><p>Smooth the data using a window with requested size.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the beginning and end part of the output signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>list</em><em> or </em><em>numpy.array</em>) – The input signal</p></li>
<li><p><strong>window_len</strong> (<em>int</em><em>, </em><em>optional</em>) – The dimension of the smoothing window,
should be an <strong>odd</strong> integer, defaults to 11</p></li>
<li><p><strong>window</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of window from [‘flat’, ‘hanning’, ‘hamming’,
‘bartlett’, ‘blackman’]
flat window will produce a moving average smoothing,
defaults to ‘blackman’</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Smooth only accepts 1 dimension arrays.</p></li>
<li><p><strong>ValueError</strong> – Input vector needs to be bigger than window size.</p></li>
<li><p><strong>ValueError</strong> – Window is not one of ‘flat’, ‘hanning’, ‘hamming’,
‘bartlett’, ‘blackman’</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Smoothed array</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ibllib.dsp.smooth.non_uniform_savgol">
<span class="sig-name descname"><span class="pre">non_uniform_savgol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polynom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/dsp/smooth.html#non_uniform_savgol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ibllib.dsp.smooth.non_uniform_savgol" title="Permalink to this definition"></a></dt>
<dd><p>Applies a Savitzky-Golay filter to y with non-uniform spacing as defined in x.
This is based on
<a class="reference external" href="https://dsp.stackexchange.com/questions/1676/savitzky-golay-smoothing-filter-for-not-equally-spaced-data">https://dsp.stackexchange.com/questions/1676/savitzky-golay-smoothing-filter-for-not-equally-spaced-data</a>
The borders are interpolated like scipy.signal.savgol_filter would do
<a class="reference external" href="https://dsp.stackexchange.com/a/64313">https://dsp.stackexchange.com/a/64313</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array_like</em>) – List of floats representing the x values of the data</p></li>
<li><p><strong>y</strong> (<em>array_like</em>) – List of floats representing the y values. Must have same length as x</p></li>
<li><p><strong>window</strong> (<em>int</em><em> (</em><em>odd</em><em>)</em>) – Window length of datapoints. Must be odd and smaller than x</p></li>
<li><p><strong>polynom</strong> (<em>int</em>) – The order of polynom used. Must be smaller than the window size</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The smoothed y values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ibllib.dsp.smooth.smooth_interpolate_savgol">
<span class="sig-name descname"><span class="pre">smooth_interpolate_savgol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">31</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cubic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/dsp/smooth.html#smooth_interpolate_savgol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ibllib.dsp.smooth.smooth_interpolate_savgol" title="Permalink to this definition"></a></dt>
<dd><p>Run savitzy-golay filter on signal, interpolate through nan points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>signal</strong> (<em>np.ndarray</em>) – original noisy signal of shape (t,), may contain nans</p></li>
<li><p><strong>window</strong> (<em>int</em>) – window of polynomial fit for savitzy-golay filter</p></li>
<li><p><strong>order</strong> (<em>int</em>) – order of polynomial for savitzy-golay filter</p></li>
<li><p><strong>interp_kind</strong> (<em>str</em>) – type of interpolation for nans, e.g. ‘linear’, ‘quadratic’, ‘cubic’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>smoothed, interpolated signal for each time point, shape (t,)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="ibllib.dsp.smooth.smooth_demo">
<span class="sig-name descname"><span class="pre">smooth_demo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/dsp/smooth.html#smooth_demo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#ibllib.dsp.smooth.smooth_demo" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ibllib.dsp.savitzky_golay.html" class="btn btn-neutral float-left" title="ibllib.dsp.savitzky_golay" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ibllib.dsp.utils.html" class="btn btn-neutral float-right" title="ibllib.dsp.utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, International Brain Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>