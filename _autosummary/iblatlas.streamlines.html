

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>iblatlas.streamlines &mdash; IBL Library  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/css/style.css?v=17142d56" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="iblatlas.streamlines.utils" href="iblatlas.streamlines.utils.html" />
    <link rel="prev" title="iblatlas.regions" href="iblatlas.regions.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            IBL Library
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The Open Neurophysiology Environment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/one_quickstart.html">ONE Quick Start</a></li>
<li class="toctree-l1"><a class="reference external" href="https://int-brain-lab.github.io/ONE/">Full documentation Website for ONE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/public_introduction.html">Publicly Available IBL Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/dataset_overview.html">What is available for download ?</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Datasets - Collaboration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/2025_data_release_brainwidemap.html">2025 - Brain Wide Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/2024_data_release_repro_ephys.html">2024 - Reproducible Ephys</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/2021_data_release_behavior.html">2021 - Behavior</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Datasets - Projects</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/2025_data_release_autism_noel.html">2025 - Autism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/2022_data_release_spikesorting_benchmarks.html">2022 - Spike sorting benchmark datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/data_release_pilot.html">Data Release - Pilot Dataset</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exploring IBL Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_installation.html">Installation of IBL Unified Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_structure.html">Get to know the datasets and folder structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_download.html">Setting up credentials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_download.html#Explore-and-download-data-using-the-ONE-api">Explore and download data using the ONE-api</a></li>
<li class="toctree-l1"><a class="reference internal" href="../loading_examples.html">Loading Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../09_contribution.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/information_contact.html">Getting Help: Information and Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples &amp; Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../atlas_examples.html">Atlas Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/docs_wheel_moves.html">Working with wheel data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/docs_wheel_screen_stimulus.html">Computing the stimulus position using the wheel</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../010_api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ibllib.html">ibllib</a></li>
<li class="toctree-l2"><a class="reference internal" href="brainbox.html">brainbox</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="iblatlas.html">iblatlas</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="iblatlas.atlas.html">iblatlas.atlas</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.flatmaps.html">iblatlas.flatmaps</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.genomics.html">iblatlas.genomics</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.gui.html">iblatlas.gui</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.plots.html">iblatlas.plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.regions.html">iblatlas.regions</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">iblatlas.streamlines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="iblatlas.streamlines.utils.html">iblatlas.streamlines.utils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="iblutil.html">iblutil</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IBL Library</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../010_api_reference.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="iblatlas.html">iblatlas</a></li>
      <li class="breadcrumb-item active">iblatlas.streamlines</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/iblatlas.streamlines.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-iblatlas.streamlines">
<span id="iblatlas-streamlines"></span><h1>iblatlas.streamlines<a class="headerlink" href="#module-iblatlas.streamlines" title="Link to this heading"></a></h1>
<p>A package for working with Allen streamlines data.</p>
<p>This package provides a way to use the Allen streamline data to
1. Do a lookup of xyz position to depth from the surface of the cortex
2. Project a volume or xyz positions along the streamlines to display them on a flattened dorsal cortex flatmap</p>
<p>Streamlines are the paths that connect the surface of the isocortex to the white matter surface while following the
curvature of these surfaces.</p>
<p>For the xyz to depth position lookup the following files have been generated with 10, 25 and 50 um resolution</p>
<blockquote>
<div><p>depths/
├── depths_ind_{res}.npy
├── depths_per_{res}.npy
├── depths_um_{res}.npy</p>
</div></blockquote>
<ul class="simple">
<li><p>The depths_ind_{res}.npy contains the flattened index for all voxels contained within the isocortex of the Allen</p></li>
</ul>
<p>volume at the specified resolution. The ordering of the flattened index is AP, DV, ML
- The depths_per_{res}.npy contains the depth in percentage from the surface of the cortex of each voxel in the isocortex.
The percentage values were taken from the laplacian provided by the Allen institute. Voxels at the surface have a percentage</p>
<blockquote>
<div><p>depth of 0 while those at the white matter boundary have a percentage depth of 1.</p>
</div></blockquote>
<ul class="simple">
<li><p>The depths_um_{res}.npy contains the depth in um from the surface of the cortex of each voxel in the isocortex. The depth</p></li>
</ul>
<p>values have been computed using the streamlines provided by the Allen institute. For each streamline the length of
the streamline was computed and voxels assigned a depth based on the steps along the streamline. When multiple streamlines
pass through a given voxel the median depth has been taken.</p>
<p>The 25 and 50 um resolution datasets have been computed by subsampling the 10 um datasets.</p>
<p>To enable the projection onto the dorsal flatmap the following files have been generated with 10, 25 and 50 um resolution</p>
<blockquote>
<div><p>depths/
├── paths_{res}.pqt
├── dorsal_flatmap.npy
├── dorsal_annotation.npy
├── dorsal_image.npy</p>
</div></blockquote>
<ul class="simple">
<li><p>The paths_{res}.pqt files contain information about the voxels that correspond to each streamline. They have been</p></li>
</ul>
<p>derived from the dorsal_flatmap_paths_10.h5 paths provided by the Allen institute. We store the values as a pqt file and remove
values that correspond to no streamline (paths=0) and duplicate voxels per streamline. As we have removed duplicate
voxels per streamline this means that when taking the average or std along the streamline the behavior will differ
from the Allen code.
- The dorsal_flatmap.npy is a 2D numpy array with the dorsal cortex flatmap. The value in each voxel corresponds the
streamline index that corresponds to that voxel.
- The dorsal_annotation is 2D numpy array with the dorsal cortex flatmap. The value in each voxel corresponds to the
region id on the surface of the cortex that corresponds to that voxel
- The dorsal_image is a 2D numpy array with the dorsal cortex flatmap. The value in each voxel corresponds to the Allen
image volume projected onto the flatmap display</p>
<dl class="simple">
<dt>[1] Wang, Quanxin et al., “The Allen Mouse Brain Common Coordinate Framework: A 3D Reference Atlas”</dt><dd><p>Cell, Volume 181, Issue 4, 936 - 953.e20 May. 2020, <a class="reference external" href="https://doi.org/10.1016/j.cell.2020.04.007">https://doi.org/10.1016/j.cell.2020.04.007</a></p>
</dd>
</dl>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="iblatlas.streamlines.utils.html#module-iblatlas.streamlines.utils" title="iblatlas.streamlines.utils"><code class="xref py py-obj docutils literal notranslate"><span class="pre">utils</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="iblatlas.regions.html" class="btn btn-neutral float-left" title="iblatlas.regions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="iblatlas.streamlines.utils.html" class="btn btn-neutral float-right" title="iblatlas.streamlines.utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, International Brain Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>