

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>brainbox.population.population &mdash; IBL Library  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="brainbox.processing" href="brainbox.processing.html" />
    <link rel="prev" title="brainbox.population.cca" href="brainbox.population.cca.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> IBL Library
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../01_overview.html">IBL data structure</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_installation.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../03_one.html">ONE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../04_datajoint.html">Datajoint</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../05_tutorials.html">Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../06_examples.html">Examples</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../07_developers.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="alf.html">alf</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibllib.html">ibllib</a></li>
<li class="toctree-l2"><a class="reference internal" href="oneibl.html">oneibl</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="brainbox.html">brainbox</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="brainbox.behavior.html">brainbox.behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.core.html">brainbox.core</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.experimental.html">brainbox.experimental</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.io.html">brainbox.io</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.lfp.html">brainbox.lfp</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.metrics.html">brainbox.metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.plot.html">brainbox.plot</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="brainbox.population.html">brainbox.population</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="brainbox.population.cca.html">brainbox.population.cca</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">brainbox.population.population</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.processing.html">brainbox.processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.quality.html">brainbox.quality</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.simulation.html">brainbox.simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.singlecell.html">brainbox.singlecell</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.spike_features.html">brainbox.spike_features</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.task.html">brainbox.task</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.tests.html">brainbox.tests</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IBL Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../07_developers.html">API Reference</a> &raquo;</li>
        
          <li><a href="brainbox.html">brainbox</a> &raquo;</li>
        
          <li><a href="brainbox.population.html">brainbox.population</a> &raquo;</li>
        
      <li>brainbox.population.population</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/_autosummary/brainbox.population.population.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-brainbox.population.population">
<span id="brainbox-population-population"></span><h1>brainbox.population.population<a class="headerlink" href="#module-brainbox.population.population" title="Permalink to this headline">¶</a></h1>
<p>Population functions.</p>
<p>Code from <a class="reference external" href="https://github.com/cortex-lab/phylib/blob/master/phylib/stats/ccg.py">https://github.com/cortex-lab/phylib/blob/master/phylib/stats/ccg.py</a> by C. Rossant.
Code for decoding by G. Meijer</p>
<p class="rubric">Functions</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.population.population.decode" title="brainbox.population.population.decode"><code class="xref py py-obj docutils literal notranslate"><span class="pre">decode</span></code></a></p></td>
<td><p>Use decoding to classify groups of trials (e.g.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.population.population.lda_project" title="brainbox.population.population.lda_project"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lda_project</span></code></a></p></td>
<td><p>Use linear discriminant analysis to project population vectors to the line that best separates the two groups.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.population.population.xcorr" title="brainbox.population.population.xcorr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xcorr</span></code></a></p></td>
<td><p>Compute all pairwise cross-correlograms among the clusters appearing in <cite>spike_clusters</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt id="brainbox.population.population.xcorr">
<code class="sig-name descname">xcorr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spike_times</span></em>, <em class="sig-param"><span class="n">spike_clusters</span></em>, <em class="sig-param"><span class="n">bin_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">window_size</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/population/population.html#xcorr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.population.population.xcorr" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute all pairwise cross-correlograms among the clusters appearing in <cite>spike_clusters</cite>.</p>
<p>:param :
:type : param spike_times: Spike times in seconds.
:param :
:type : type spike_times: array-like
:param :
:type : param spike_clusters: Spike-cluster mapping.
:param :
:type : type spike_clusters: array-like
:param :
:type : param bin_size: Size of the bin, in seconds.
:param :
:type : type bin_size: float
:param :
:type : param window_size: Size of the window, in seconds.
:param :
:type : type window_size: float
:param Returns an <cite>(n_clusters:
:param n_clusters:
:param winsize_samples)</cite> array with all pairwise:
:param cross-correlograms.:</p>
</dd></dl>

<dl class="py function">
<dt id="brainbox.population.population.decode">
<code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spike_times</span></em>, <em class="sig-param"><span class="n">spike_clusters</span></em>, <em class="sig-param"><span class="n">event_times</span></em>, <em class="sig-param"><span class="n">event_groups</span></em>, <em class="sig-param"><span class="n">pre_time</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">post_time</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">classifier</span><span class="o">=</span><span class="default_value">'bayes'</span></em>, <em class="sig-param"><span class="n">cross_validation</span><span class="o">=</span><span class="default_value">'kfold'</span></em>, <em class="sig-param"><span class="n">num_splits</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">prob_left</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">custom_validation</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_neurons</span><span class="o">=</span><span class="default_value">'all'</span></em>, <em class="sig-param"><span class="n">iterations</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">shuffle</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/population/population.html#decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.population.population.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Use decoding to classify groups of trials (e.g. stim left/right). Classification is done using
the population vector of summed spike counts from the specified time window. Cross-validation
is achieved using n-fold cross validation or leave-one-out cross validation. Decoders can
decode any number of groups. When providing the classfier with an imbalanced dataset (not
the same number of trials in each group) the chance level will not be 1/groups. In that case,
to compare the classification performance against change one has to either determine chance
level by decoding a shuffled dataset or use the ‘auroc’ metric as readout (this metric is
robust against imbalanced datasets)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spike_times</strong> (<em>1D array</em>) – spike times (in seconds)</p></li>
<li><p><strong>spike_clusters</strong> (<em>1D array</em>) – cluster ids corresponding to each event in <cite>spikes</cite></p></li>
<li><p><strong>event_times</strong> (<em>1D array</em>) – times (in seconds) of the events from the two groups</p></li>
<li><p><strong>event_groups</strong> (<em>1D array</em>) – group identities of the events, can be any number of groups, accepts integers and strings</p></li>
<li><p><strong>pre_time</strong> (<em>float</em>) – time (in seconds) preceding the event times</p></li>
<li><p><strong>post_time</strong> (<em>float</em>) – time (in seconds) following the event times</p></li>
<li><p><strong>classifier</strong> (<em>string</em>) – <dl class="simple">
<dt>which decoder to use, options are:</dt><dd><p>’bayes’         Naive Bayes
‘forest’        Random forest (with 100 trees)
‘regression’    Logistic regression
‘lda’           Linear Discriminant Analysis</p>
</dd>
</dl>
</p></li>
<li><p><strong>cross_validation</strong> (<em>string</em>) – <dl class="simple">
<dt>which cross-validation method to use, options are:</dt><dd><p>’none’              No cross-validation
‘kfold’             K-fold cross-validation
‘leave-one-out’     Leave out the trial that is being decoded
‘block’             Leave out the block the to-be-decoded trial is in
‘custom’            Any custom cross-validation provided by the user</p>
</dd>
</dl>
</p></li>
<li><p><strong>num_splits</strong> (<em>integer</em>) – ** only for ‘kfold’ cross-validation **
Number of splits to use for k-fold cross validation, a value of 5 means that the decoder
will be trained on 4/5th of the data and used to predict the remaining 1/5th. This process
is repeated five times so that all data has been used as both training and test set.</p></li>
<li><p><strong>prob_left</strong> (<em>1D array</em>) – ** only for ‘block’ cross-validation **
the probability of the stimulus appearing on the left for each trial in event_times</p></li>
<li><p><strong>custom_validation</strong> (<em>generator</em>) – <p>** only for ‘custom’ cross-validation **
a generator object with the splits to be used for cross validation using this format:</p>
<blockquote>
<div><dl>
<dt>(</dt><dd><blockquote>
<div><p>(split1_train_idxs, split1_test_idxs),
(split2_train_idxs, split2_test_idxs),
(split3_train_idxs, split3_test_idxs),</p>
</div></blockquote>
<p>…)</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>n_neurons</strong> (<em>string</em><em> or </em><em>integer</em>) – number of neurons to randomly subselect from the population (default is ‘all’)</p></li>
<li><p><strong>iterations</strong> (<em>int</em>) – number of times to repeat the decoding (especially usefull when subselecting neurons)</p></li>
<li><p><strong>shuffle</strong> (<em>boolean</em>) – whether to shuffle the trial labels each decoding iteration</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>results</strong> – dictionary with decoding results</p>
<dl class="simple">
<dt>accuracy<span class="classifier">float</span></dt><dd><p>accuracy of the classifier in percentage correct</p>
</dd>
<dt>f1<span class="classifier">float</span></dt><dd><p>F1 score of the classifier</p>
</dd>
<dt>auroc<span class="classifier">float</span></dt><dd><p>the area under the ROC curve of the classification performance</p>
</dd>
<dt>confusion_matrix<span class="classifier">2D array</span></dt><dd><p>normalized confusion matrix</p>
</dd>
<dt>predictions<span class="classifier">2D array with dimensions iterations x trials</span></dt><dd><p>predicted group label for all trials in every iteration</p>
</dd>
<dt>probabilities<span class="classifier">2D array with dimensions iterations x trials</span></dt><dd><p>classification probability for all trials in every iteration</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="brainbox.population.population.lda_project">
<code class="sig-name descname">lda_project</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spike_times</span></em>, <em class="sig-param"><span class="n">spike_clusters</span></em>, <em class="sig-param"><span class="n">event_times</span></em>, <em class="sig-param"><span class="n">event_groups</span></em>, <em class="sig-param"><span class="n">pre_time</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">post_time</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">cross_validation</span><span class="o">=</span><span class="default_value">'kfold'</span></em>, <em class="sig-param"><span class="n">num_splits</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">prob_left</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">custom_validation</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/population/population.html#lda_project"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#brainbox.population.population.lda_project" title="Permalink to this definition">¶</a></dt>
<dd><p>Use linear discriminant analysis to project population vectors to the line that best separates
the two groups. When cross-validation is used, the LDA projection is fitted on the training
data after which the test data is projected to this projection.</p>
<dl>
<dt>spike_times<span class="classifier">1D array</span></dt><dd><p>spike times (in seconds)</p>
</dd>
<dt>spike_clusters<span class="classifier">1D array</span></dt><dd><p>cluster ids corresponding to each event in <cite>spikes</cite></p>
</dd>
<dt>event_times<span class="classifier">1D array</span></dt><dd><p>times (in seconds) of the events from the two groups</p>
</dd>
<dt>event_groups<span class="classifier">1D array</span></dt><dd><p>group identities of the events, can be any number of groups, accepts integers and strings</p>
</dd>
<dt>pre_time<span class="classifier">float</span></dt><dd><p>time (in seconds) preceding the event times</p>
</dd>
<dt>post_time<span class="classifier">float</span></dt><dd><p>time (in seconds) following the event times</p>
</dd>
<dt>cross_validation<span class="classifier">string</span></dt><dd><dl class="simple">
<dt>which cross-validation method to use, options are:</dt><dd><p>‘none’              No cross-validation
‘kfold’             K-fold cross-validation
‘leave-one-out’     Leave out the trial that is being decoded
‘block’             Leave out the block the to-be-decoded trial is in
‘custom’            Any custom cross-validation provided by the user</p>
</dd>
</dl>
</dd>
<dt>num_splits<span class="classifier">integer</span></dt><dd><p>** only for ‘kfold’ cross-validation **
Number of splits to use for k-fold cross validation, a value of 5 means that the decoder
will be trained on 4/5th of the data and used to predict the remaining 1/5th. This process
is repeated five times so that all data has been used as both training and test set.</p>
</dd>
<dt>prob_left<span class="classifier">1D array</span></dt><dd><p>** only for ‘block’ cross-validation **
the probability of the stimulus appearing on the left for each trial in event_times</p>
</dd>
<dt>custom_validation<span class="classifier">generator</span></dt><dd><p>** only for ‘custom’ cross-validation **
a generator object with the splits to be used for cross validation using this format:</p>
<blockquote>
<div><dl>
<dt>(</dt><dd><blockquote>
<div><p>(split1_train_idxs, split1_test_idxs),
(split2_train_idxs, split2_test_idxs),
(split3_train_idxs, split3_test_idxs),</p>
</div></blockquote>
<p>…)</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt>n_neurons<span class="classifier">int</span></dt><dd><p>Group size of number of neurons to be sub-selected</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>lda_projection</strong> – the position along the LDA projection axis for the population vector of each trial</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>1D array</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="brainbox.processing.html" class="btn btn-neutral float-right" title="brainbox.processing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="brainbox.population.cca.html" class="btn btn-neutral float-left" title="brainbox.population.cca" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, International Brain Laboratory

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>