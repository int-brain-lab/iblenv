

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ibllib.qc.alignment_qc &mdash; IBL Library  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ibllib.qc.base" href="ibllib.qc.base.html" />
    <link rel="prev" title="ibllib.qc" href="ibllib.qc.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> IBL Library
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../01_overview.html">IBL data structure</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_installation.html">Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../03_one.html">ONE</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../04_alf.html">Alyx Files (ALF)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../05_datajoint.html">Datajoint</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../06_examples.html">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../07_tutorials.html">Tutorials</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../08_public.html">IBL Public Data</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../09_contribution.html">Contribution Statement</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../010_api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="one.html">one</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="ibllib.html">ibllib</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ibllib.atlas.html">ibllib.atlas</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.dsp.html">ibllib.dsp</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.ephys.html">ibllib.ephys</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.exceptions.html">ibllib.exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.graphic.html">ibllib.graphic</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.io.html">ibllib.io</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.misc.html">ibllib.misc</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.pipes.html">ibllib.pipes</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.plots.html">ibllib.plots</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="ibllib.qc.html">ibllib.qc</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">ibllib.qc.alignment_qc</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibllib.qc.base.html">ibllib.qc.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibllib.qc.camera.html">ibllib.qc.camera</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibllib.qc.critical_reasons.html">ibllib.qc.critical_reasons</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibllib.qc.dlc.html">ibllib.qc.dlc</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibllib.qc.qcplots.html">ibllib.qc.qcplots</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibllib.qc.task_extractors.html">ibllib.qc.task_extractors</a></li>
<li class="toctree-l4"><a class="reference internal" href="ibllib.qc.task_metrics.html">ibllib.qc.task_metrics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.tests.html">ibllib.tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="ibllib.time.html">ibllib.time</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="brainbox.html">brainbox</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IBL Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../010_api_reference.html">API Reference</a> &raquo;</li>
        
          <li><a href="ibllib.html">ibllib</a> &raquo;</li>
        
          <li><a href="ibllib.qc.html">ibllib.qc</a> &raquo;</li>
        
      <li>ibllib.qc.alignment_qc</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/_autosummary/ibllib.qc.alignment_qc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-ibllib.qc.alignment_qc">
<span id="ibllib-qc-alignment-qc"></span><h1>ibllib.qc.alignment_qc<a class="headerlink" href="#module-ibllib.qc.alignment_qc" title="Permalink to this headline">¶</a></h1>
<p class="rubric">Classes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#ibllib.qc.alignment_qc.AlignmentQC" title="ibllib.qc.alignment_qc.AlignmentQC"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AlignmentQC</span></code></a></p></td>
<td><p>Class that is used to update the extended_qc of the probe insertion fields with the results from the ephys alignment procedure</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt id="ibllib.qc.alignment_qc.AlignmentQC">
<em class="property">class </em><code class="sig-name descname">AlignmentQC</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">probe_id</span></em>, <em class="sig-param"><span class="n">one</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">brain_atlas</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">channels</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/qc/alignment_qc.html#AlignmentQC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibllib.qc.alignment_qc.AlignmentQC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="ibllib.qc.base.html#ibllib.qc.base.QC" title="ibllib.qc.base.QC"><code class="xref py py-class docutils literal notranslate"><span class="pre">ibllib.qc.base.QC</span></code></a></p>
<p>Class that is used to update the extended_qc of the probe insertion fields with the results
from the ephys alignment procedure</p>
<dl class="py method">
<dt id="ibllib.qc.alignment_qc.AlignmentQC.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">probe_id</span></em>, <em class="sig-param"><span class="n">one</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">brain_atlas</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">channels</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/qc/alignment_qc.html#AlignmentQC.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibllib.qc.alignment_qc.AlignmentQC.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>endpoint_id</strong> – Eid for endpoint. If using sessions can also be a session path</p></li>
<li><p><strong>log</strong> – A logging.Logger instance, if None the ‘ibllib’ logger is used</p></li>
<li><p><strong>one</strong> – An ONE instance for fetching and setting the QC on Alyx</p></li>
<li><p><strong>endpoint</strong> – The enpoint name to apply qc to. Default is ‘sessions’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="ibllib.qc.alignment_qc.AlignmentQC.load_data">
<code class="sig-name descname">load_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prev_alignments</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xyz_picks</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">depths</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cluster_chns</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/qc/alignment_qc.html#AlignmentQC.load_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibllib.qc.alignment_qc.AlignmentQC.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>”
Load data required to assess alignment qc and compute similarity matrix. If no arguments
are given load_data will fetch all the relevant data required</p>
</dd></dl>

<dl class="py method">
<dt id="ibllib.qc.alignment_qc.AlignmentQC.compute">
<code class="sig-name descname">compute</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/qc/alignment_qc.html#AlignmentQC.compute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibllib.qc.alignment_qc.AlignmentQC.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the similarity matrix if &gt; 2 alignments. If no data loaded, wraps around load_data
to get all relevant data needed</p>
</dd></dl>

<dl class="py method">
<dt id="ibllib.qc.alignment_qc.AlignmentQC.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">update</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">upload_alyx</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">upload_flatiron</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/qc/alignment_qc.html#AlignmentQC.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibllib.qc.alignment_qc.AlignmentQC.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute alignment_qc for a specified probe insertion and updates extended qc field in alyx.
If alignment is resolved and upload flags set to True channels from resolved
alignment will be updated to alyx and datasets sent to ibl-ftp-patcher to be uploaded to
flatiron</p>
</dd></dl>

<dl class="py method">
<dt id="ibllib.qc.alignment_qc.AlignmentQC.resolve_manual">
<code class="sig-name descname">resolve_manual</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">align_key</span></em>, <em class="sig-param"><span class="n">update</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">upload_alyx</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">upload_flatiron</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">force</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/qc/alignment_qc.html#AlignmentQC.resolve_manual"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibllib.qc.alignment_qc.AlignmentQC.resolve_manual" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to manually resolve the alignment of a probe insertion with a given alignment
regardless of the number of alignments or the alignment qc value. Channels from specified
alignment will be uploaded to alyx and datasets sent to ibl-ftp-patcher to be uploaded to
flatiron. If alignment already resolved will only upload if force flag set to True</p>
</dd></dl>

<dl class="py method">
<dt id="ibllib.qc.alignment_qc.AlignmentQC.compute_similarity_matrix">
<code class="sig-name descname">compute_similarity_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/qc/alignment_qc.html#AlignmentQC.compute_similarity_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibllib.qc.alignment_qc.AlignmentQC.compute_similarity_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the similarity matrix between each alignment stored in the ephys aligned
trajectory. Similarity matrix based on number of clusters that share brain region and
parent brain region</p>
</dd></dl>

<dl class="py method">
<dt id="ibllib.qc.alignment_qc.AlignmentQC.compute_alignment_status">
<code class="sig-name descname">compute_alignment_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/qc/alignment_qc.html#AlignmentQC.compute_alignment_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibllib.qc.alignment_qc.AlignmentQC.compute_alignment_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether alignments agree based on value in similarity matrix. If any alignments
have similarity of 0.8 set the alignment to be resolved</p>
</dd></dl>

<dl class="py method">
<dt id="ibllib.qc.alignment_qc.AlignmentQC.upload_channels">
<code class="sig-name descname">upload_channels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alignment_key</span></em>, <em class="sig-param"><span class="n">upload_alyx</span></em>, <em class="sig-param"><span class="n">upload_flatiron</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/qc/alignment_qc.html#AlignmentQC.upload_channels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibllib.qc.alignment_qc.AlignmentQC.upload_channels" title="Permalink to this definition">¶</a></dt>
<dd><p>Upload channels to alyx and flatiron based on the alignment specified by the alignment key</p>
</dd></dl>

<dl class="py method">
<dt id="ibllib.qc.alignment_qc.AlignmentQC.update_experimenter_evaluation">
<code class="sig-name descname">update_experimenter_evaluation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prev_alignments</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">override</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ibllib/qc/alignment_qc.html#AlignmentQC.update_experimenter_evaluation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ibllib.qc.alignment_qc.AlignmentQC.update_experimenter_evaluation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="ibllib.qc.alignment_qc.AlignmentQC.__doc__">
<code class="sig-name descname">__doc__</code><em class="property"> = '\n    Class that is used to update the extended_qc of the probe insertion fields with the results\n    from the ephys alignment procedure\n    '</em><a class="headerlink" href="#ibllib.qc.alignment_qc.AlignmentQC.__doc__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="ibllib.qc.alignment_qc.AlignmentQC.__module__">
<code class="sig-name descname">__module__</code><em class="property"> = 'ibllib.qc.alignment_qc'</em><a class="headerlink" href="#ibllib.qc.alignment_qc.AlignmentQC.__module__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ibllib.qc.base.html" class="btn btn-neutral float-right" title="ibllib.qc.base" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ibllib.qc.html" class="btn btn-neutral float-left" title="ibllib.qc" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, International Brain Laboratory

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>