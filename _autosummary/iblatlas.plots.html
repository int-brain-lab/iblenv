<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>iblatlas.plots &mdash; IBL Library  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/css/style.css?v=17142d56" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="iblatlas.regions" href="iblatlas.regions.html" />
    <link rel="prev" title="iblatlas.genomics.merfish" href="iblatlas.genomics.merfish.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            IBL Library
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The Open Neurophysiology Environment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/one_quickstart.html">ONE Quick Start</a></li>
<li class="toctree-l1"><a class="reference external" href="https://int-brain-lab.github.io/ONE/">Full documentation Website for ONE</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Public</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/public_introduction.html">Publicly available IBL data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_release_behavior.html">Data Release - Behavior</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/data_release_pilot.html">Data Release - Pilot Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_release_repro_ephys.html">Data Release - Reproducible Ephys Paper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_release_brainwidemap.html">Data Release - Brain Wide Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_release_spikesorting_benchmarks.html">Data Release - Spike sorting benchmark datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/information_contact.html">Information and troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exploring IBL Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_structure.html">Get to know the datasets and folder structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_download.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_download.html#Explore-and-download-data-using-the-ONE-api">Explore and download data using the ONE-api</a></li>
<li class="toctree-l1"><a class="reference internal" href="../loading_examples.html">Loading Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_installation.html">Unified Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09_contribution.html">How to contribute</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples &amp; Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../atlas_examples.html">Atlas Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/docs_wheel_moves.html">Working with wheel data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/docs_wheel_screen_stimulus.html">Computing the stimulus position using the wheel</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../010_api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ibllib.html">ibllib</a></li>
<li class="toctree-l2"><a class="reference internal" href="brainbox.html">brainbox</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="iblatlas.html">iblatlas</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="iblatlas.html#terminology">Terminology</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.html#atlases">Atlases</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.html#scalings">Scalings</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.html#brain-regions-mappings">Brain Regions Mappings</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.html#fixtures">Fixtures</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.atlas.html">iblatlas.atlas</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.flatmaps.html">iblatlas.flatmaps</a></li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.genomics.html">iblatlas.genomics</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">iblatlas.plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.get_bc_10"><code class="docutils literal notranslate"><span class="pre">get_bc_10()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.plot_polygon"><code class="docutils literal notranslate"><span class="pre">plot_polygon()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.plot_polygon_with_hole"><code class="docutils literal notranslate"><span class="pre">plot_polygon_with_hole()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.coords_for_poly_hole"><code class="docutils literal notranslate"><span class="pre">coords_for_poly_hole()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.prepare_lr_data"><code class="docutils literal notranslate"><span class="pre">prepare_lr_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.reorder_data"><code class="docutils literal notranslate"><span class="pre">reorder_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.load_slice_files"><code class="docutils literal notranslate"><span class="pre">load_slice_files()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.plot_scalar_on_slice"><code class="docutils literal notranslate"><span class="pre">plot_scalar_on_slice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.plot_scalar_on_flatmap"><code class="docutils literal notranslate"><span class="pre">plot_scalar_on_flatmap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.plot_volume_on_slice"><code class="docutils literal notranslate"><span class="pre">plot_volume_on_slice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.plot_points_on_slice"><code class="docutils literal notranslate"><span class="pre">plot_points_on_slice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.compute_volume_from_points"><code class="docutils literal notranslate"><span class="pre">compute_volume_from_points()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.plot_scalar_on_barplot"><code class="docutils literal notranslate"><span class="pre">plot_scalar_on_barplot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.plot_swanson_vector"><code class="docutils literal notranslate"><span class="pre">plot_swanson_vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.plot_swanson"><code class="docutils literal notranslate"><span class="pre">plot_swanson()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#iblatlas.plots.annotate_swanson"><code class="docutils literal notranslate"><span class="pre">annotate_swanson()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="iblatlas.regions.html">iblatlas.regions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="iblutil.html">iblutil</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IBL Library</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../010_api_reference.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="iblatlas.html">iblatlas</a></li>
      <li class="breadcrumb-item active">iblatlas.plots</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/iblatlas.plots.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-iblatlas.plots">
<span id="iblatlas-plots"></span><h1>iblatlas.plots<a class="headerlink" href="#module-iblatlas.plots" title="Link to this heading"></a></h1>
<p>Module that has convenience plotting functions for 2D atlas slices and flatmaps.</p>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.plots.annotate_swanson" title="iblatlas.plots.annotate_swanson"><code class="xref py py-obj docutils literal notranslate"><span class="pre">annotate_swanson</span></code></a></p></td>
<td><p>Display annotations on a Swanson flatmap.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.plots.compute_volume_from_points" title="iblatlas.plots.compute_volume_from_points"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_volume_from_points</span></code></a></p></td>
<td><p>Creates a 3D volume with xyz points placed in corresponding voxel in volume.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.plots.coords_for_poly_hole" title="iblatlas.plots.coords_for_poly_hole"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coords_for_poly_hole</span></code></a></p></td>
<td><p>Function to convert</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.plots.get_bc_10" title="iblatlas.plots.get_bc_10"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bc_10</span></code></a></p></td>
<td><p>Get BrainCoordinates object for 10um Allen Atlas</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.plots.load_slice_files" title="iblatlas.plots.load_slice_files"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_slice_files</span></code></a></p></td>
<td><p>Function to load in set of vectorised atlas slices for a given atlas axis and mapping.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.plots.plot_points_on_slice" title="iblatlas.plots.plot_points_on_slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_points_on_slice</span></code></a></p></td>
<td><p>Plot xyz points on slice.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.plots.plot_polygon" title="iblatlas.plots.plot_polygon"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_polygon</span></code></a></p></td>
<td><p>Function to plot matplotlib polygon on an axis</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.plots.plot_polygon_with_hole" title="iblatlas.plots.plot_polygon_with_hole"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_polygon_with_hole</span></code></a></p></td>
<td><p>Function to plot matplotlib polygon that contains a hole on an axis</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.plots.plot_scalar_on_barplot" title="iblatlas.plots.plot_scalar_on_barplot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_scalar_on_barplot</span></code></a></p></td>
<td><p>Function to plot scalar value per allen region on a bar plot.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.plots.plot_scalar_on_flatmap" title="iblatlas.plots.plot_scalar_on_flatmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_scalar_on_flatmap</span></code></a></p></td>
<td><p>Function to plot scalar value per allen region on flatmap slice</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.plots.plot_scalar_on_slice" title="iblatlas.plots.plot_scalar_on_slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_scalar_on_slice</span></code></a></p></td>
<td><p>Function to plot scalar value per region on histology slice.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.plots.plot_swanson" title="iblatlas.plots.plot_swanson"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_swanson</span></code></a></p></td>
<td><p>Displays the 2D image corresponding to the swanson flatmap.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.plots.plot_swanson_vector" title="iblatlas.plots.plot_swanson_vector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_swanson_vector</span></code></a></p></td>
<td><p>Function to plot scalar value per allen region on the swanson projection.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.plots.plot_volume_on_slice" title="iblatlas.plots.plot_volume_on_slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_volume_on_slice</span></code></a></p></td>
<td><p>Plot slice through a volume</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#iblatlas.plots.prepare_lr_data" title="iblatlas.plots.prepare_lr_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_lr_data</span></code></a></p></td>
<td><p>Prepare data in format needed for plotting when providing different region values per hemisphere</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#iblatlas.plots.reorder_data" title="iblatlas.plots.reorder_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reorder_data</span></code></a></p></td>
<td><p>Reorder list of acronyms and values to match the Allen ordering.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.get_bc_10">
<span class="sig-name descname"><span class="pre">get_bc_10</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#get_bc_10"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.get_bc_10" title="Link to this definition"></a></dt>
<dd><p>Get BrainCoordinates object for 10um Allen Atlas</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>BrainCoordinates object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.plot_polygon">
<span class="sig-name descname"><span class="pre">plot_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#plot_polygon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.plot_polygon" title="Link to this definition"></a></dt>
<dd><p>Function to plot matplotlib polygon on an axis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – An axis object to plot onto.</p></li>
<li><p><strong>xy</strong> (<em>numpy.array</em>) – 2D array of x and y coordinates of vertices of polygon</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>tuple</em><em> of </em><em>int</em>) – The color to fill the polygon</p></li>
<li><p><strong>reg_id</strong> (<em>str</em><em>, </em><em>int</em>) – An id to assign to the polygon</p></li>
<li><p><strong>edgecolor</strong> (<em>str</em><em>, </em><em>tuple</em><em> of </em><em>int</em>) – The color of the edge of the polgon</p></li>
<li><p><strong>linewidth</strong> (<em>int</em>) – The width of the edges of the polygon</p></li>
<li><p><strong>alpha</strong> (<em>float between 0 and 1</em>) – The opacitiy of the polygon</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.plot_polygon_with_hole">
<span class="sig-name descname"><span class="pre">plot_polygon_with_hole</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">codes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#plot_polygon_with_hole"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.plot_polygon_with_hole" title="Link to this definition"></a></dt>
<dd><p>Function to plot matplotlib polygon that contains a hole on an axis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – An axis object to plot onto.</p></li>
<li><p><strong>vertices</strong> (<em>numpy.array</em>) – 2D array of x and y coordinates of vertices of polygon</p></li>
<li><p><strong>codes</strong> (<em>numpy.array</em>) – 1D array of path codes used to link the vertices
(<a class="reference external" href="https://matplotlib.org/stable/tutorials/advanced/path_tutorial.html">https://matplotlib.org/stable/tutorials/advanced/path_tutorial.html</a>)</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>tuple</em><em> of </em><em>int</em>) – The color to fill the polygon</p></li>
<li><p><strong>reg_id</strong> (<em>str</em><em>, </em><em>int</em>) – An id to assign to the polygon</p></li>
<li><p><strong>edgecolor</strong> (<em>str</em><em>, </em><em>tuple</em><em> of </em><em>int</em>) – The color of the edge of the polgon</p></li>
<li><p><strong>linewidth</strong> (<em>int</em>) – The width of the edges of the polygon</p></li>
<li><p><strong>alpha</strong> (<em>float between 0 and 1</em>) – The opacitiy of the polygon</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.coords_for_poly_hole">
<span class="sig-name descname"><span class="pre">coords_for_poly_hole</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#coords_for_poly_hole"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.coords_for_poly_hole" title="Link to this definition"></a></dt>
<dd><p>Function to convert</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coords</strong> (<em>dict</em>) – Dictionary containing keys x, y and invert. x and y contain numpy.array of x coordinates, y coordinates
for the vertices of the polgyon. The invert key is either 1 or -1 and deterimine how to assign the paths.
The value for invert for each polygon was assigned manually after looking at the result</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>all_coords</strong> (<em>numpy.array</em>) – 2D array of x and y coordinates of vertices of polygon</p></li>
<li><p><strong>all_codes</strong> (<em>numpy.array</em>) – 1D array of path codes used to link the vertices
(<a class="reference external" href="https://matplotlib.org/stable/tutorials/advanced/path_tutorial.html">https://matplotlib.org/stable/tutorials/advanced/path_tutorial.html</a>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.prepare_lr_data">
<span class="sig-name descname"><span class="pre">prepare_lr_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acronyms_lh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_lh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acronyms_rh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_rh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#prepare_lr_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.prepare_lr_data" title="Link to this definition"></a></dt>
<dd><p>Prepare data in format needed for plotting when providing different region values per hemisphere</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acronyms_lh</strong> – array of acronyms on left hemisphere</p></li>
<li><p><strong>values_lh</strong> – values for each acronym on left hemisphere</p></li>
<li><p><strong>acronyms_rh</strong> – array of acronyms on right hemisphere</p></li>
<li><p><strong>values_rh</strong> – values for each acronym on left hemisphere</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>combined acronyms and two column array of values</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.reorder_data">
<span class="sig-name descname"><span class="pre">reorder_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acronyms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_regions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#reorder_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.reorder_data" title="Link to this definition"></a></dt>
<dd><p>Reorder list of acronyms and values to match the Allen ordering.</p>
<p>TODO Document more</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acronyms</strong> (<em>array_like</em><em> of </em><em>str</em>) – The acronyms to match the Allen ordering, whatever that means.</p></li>
<li><p><strong>values</strong> (<em>array_like</em>) – An array of some sort of values I guess…</p></li>
<li><p><strong>brain_regions</strong> (<a class="reference internal" href="iblatlas.regions.html#iblatlas.regions.BrainRegions" title="iblatlas.regions.BrainRegions"><em>iblatlas.regions.BrainRegions</em></a>) – A brain regions object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy.array of str</em> – An ordered array of acronyms</p></li>
<li><p><em>numpy.array</em> – An ordered array of values. I don’t know what those values are, not IDs, so maybe indices?</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.load_slice_files">
<span class="sig-name descname"><span class="pre">load_slice_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#load_slice_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.load_slice_files" title="Link to this definition"></a></dt>
<dd><p>Function to load in set of vectorised atlas slices for a given atlas axis and mapping.</p>
<p>If the data does not exist locally, it will download the files automatically stored in a AWS S3
bucket.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slice</strong> (<em>{'coronal'</em><em>, </em><em>'sagittal'</em><em>, </em><em>'horizontal'</em><em>, </em><em>'top'}</em>) – The axis of the atlas to load.</p></li>
<li><p><strong>mapping</strong> (<em>{'Allen'</em><em>, </em><em>'Beryl'</em><em>, </em><em>'Cosmos'}</em>) – The mapping to load.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>slice_data</strong> – A json containing the vertices to draw each region for each slice in the Allen annotation volume.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.plot_scalar_on_slice">
<span class="sig-name descname"><span class="pre">plot_scalar_on_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coronal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hemisphere</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'image'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clevels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'silver'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_atlas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#plot_scalar_on_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.plot_scalar_on_slice" title="Link to this definition"></a></dt>
<dd><p>Function to plot scalar value per region on histology slice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regions</strong> (<em>array_like</em>) – An array of brain region acronyms.</p></li>
<li><p><strong>values</strong> (<em>numpy.array</em>) – An array of scalar value per acronym. If hemisphere is ‘both’ and different values want to
be shown on each hemisphere, values should contain 2 columns, 1st column for LH values, 2nd
column for RH values.</p></li>
<li><p><strong>coord</strong> (<em>float</em>) – Coordinate of slice in um (not needed when slice=’top’).</p></li>
<li><p><strong>slice</strong> (<em>{'coronal'</em><em>, </em><em>'sagittal'</em><em>, </em><em>'horizontal'</em><em>, </em><em>'top'}</em><em>, </em><em>default='coronal'</em>) – Orientation of slice.</p></li>
<li><p><strong>mapping</strong> (<em>str</em><em>, </em><em>optional</em>) – Atlas mapping to use, options are depend on atlas used (see <cite>iblatlas.regions.BrainRegions</cite>).
If None, the atlas default mapping is used.</p></li>
<li><p><strong>hemisphere</strong> (<em>{'left'</em><em>, </em><em>'right'</em><em>, </em><em>'both'}</em><em>, </em><em>default='left'</em>) – The hemisphere to display.</p></li>
<li><p><strong>background</strong> (<em>{image'</em><em>, </em><em>'boundary'}</em><em>, </em><em>default='image'</em>) – Background slice to overlay onto, options are ‘image’ or ‘boundary’. If <cite>vector</cite> is false,
this argument is ignored.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>default='viridis'</em>) – Colormap to use.</p></li>
<li><p><strong>clevels</strong> (<em>array_like</em>) – The min and max color levels to use.</p></li>
<li><p><strong>show_cbar</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to display a colorbar.</p></li>
<li><p><strong>empty_color</strong> (<em>str</em><em>, </em><em>default='silver'</em>) – Color to use for regions without any values (only used when <cite>vector</cite> is true).</p></li>
<li><p><strong>brain_atlas</strong> (<a class="reference internal" href="iblatlas.atlas.html#iblatlas.atlas.AllenAtlas" title="iblatlas.atlas.AllenAtlas"><em>iblatlas.atlas.AllenAtlas</em></a>) – A brain atlas object.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – An axis object to plot onto.</p></li>
<li><p><strong>vector</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Whether to show as bitmap or vector graphic.</p></li>
<li><p><strong>slice_files</strong> (<em>numpy.array</em>) – The set of vectorised slices for this slice, obtained using <cite>load_slice_files(slice, mapping)</cite>.</p></li>
<li><p><strong>**kwargs</strong> – Set of kwargs passed into matplotlib.patches.Polygon, e.g. linewidth=2, edgecolor=’None’
(only used when vector = True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure</em>) – The plotted figure.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – The plotted axes.</p></li>
<li><p><strong>cbar</strong> (<em>matplotlib.pyplot.colorbar, optional</em>) – matplotlib colorbar object, only returned if show_cbar=True.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.plot_scalar_on_flatmap">
<span class="sig-name descname"><span class="pre">plot_scalar_on_flatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flatmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dorsal_cortex'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Allen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hemisphere</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boundary'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clevels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flmap_atlas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#plot_scalar_on_flatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.plot_scalar_on_flatmap" title="Link to this definition"></a></dt>
<dd><p>Function to plot scalar value per allen region on flatmap slice</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>regions</strong> – array of acronyms of Allen regions</p></li>
<li><p><strong>values</strong> – array of scalar value per acronym. If hemisphere is ‘both’ and different values want to be shown on each</p></li>
</ul>
</dd>
</dl>
<p>hemispheres, values should contain 2 columns, 1st column for LH values, 2nd column for RH values
:param depth: depth in flatmap in um
:param flatmap: name of flatmap (currently only option is ‘dorsal_cortex’)
:param mapping: atlas mapping to use, options are ‘Allen’, ‘Beryl’ or ‘Cosmos’
:param hemisphere: hemisphere to display, options are ‘left’, ‘right’, ‘both’
:param background: background slice to overlay onto, options are ‘image’ or ‘boundary’
:param cmap: colormap to use
:param clevels: min max color levels [cmin, cmax]
:param show_cbar: whether to add colorbar to axis
:param flmap_atlas: FlatMap object
:param ax: optional axis object to plot on
:return:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.plot_volume_on_slice">
<span class="sig-name descname"><span class="pre">plot_volume_on_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coronal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Allen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boundary'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Reds'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clevels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_atlas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#plot_volume_on_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.plot_volume_on_slice" title="Link to this definition"></a></dt>
<dd><p>Plot slice through a volume</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume</strong> – 3D array of volume (must be same shape as brain_atlas object)</p></li>
<li><p><strong>coord</strong> – coordinate of slice in um</p></li>
<li><p><strong>slice</strong> – orientation of slice, options are ‘coronal’, ‘sagittal’, ‘horizontal’</p></li>
<li><p><strong>mapping</strong> – atlas mapping to use, options are ‘Allen’, ‘Beryl’ or ‘Cosmos’</p></li>
<li><p><strong>background</strong> – background slice to overlay onto, options are ‘image’ or ‘boundary’</p></li>
<li><p><strong>cmap</strong> – colormap to use</p></li>
<li><p><strong>clevels</strong> – min max color levels [cmin, cmax]</p></li>
<li><p><strong>show_cbar</strong> – whether to add colorbar to axis</p></li>
<li><p><strong>brain_atlas</strong> – AllenAtlas object</p></li>
<li><p><strong>ax</strong> – optional axis object to plot on</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.plot_points_on_slice">
<span class="sig-name descname"><span class="pre">plot_points_on_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coord</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slice</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coronal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Allen'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boundary'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Reds'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clevels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_atlas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#plot_points_on_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.plot_points_on_slice" title="Link to this definition"></a></dt>
<dd><p>Plot xyz points on slice. Points that lie in the same voxel within slice are aggregated according to method specified.
A 3D Gaussian smoothing kernel with distance specified by fwhm is applied to images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> – 3 column array of xyz coordinates of points in metres</p></li>
<li><p><strong>values</strong> – array of values per xyz coordinates, if no values are given the sum of xyz points in each voxel is</p></li>
</ul>
</dd>
</dl>
<p>returned
:param coord: coordinate of slice in um (not needed when slice=’top’)
:param slice: orientation of slice, options are ‘coronal’, ‘sagittal’, ‘horizontal’, ‘top’ (top view of brain)
:param mapping: atlas mapping to use, options are ‘Allen’, ‘Beryl’ or ‘Cosmos’
:param background: background slice to overlay onto, options are ‘image’ or ‘boundary’
:param cmap: colormap to use
:param clevels: min max color levels [cmin, cmax]
:param show_cbar: whether to add colorbar to axis
:param aggr: aggregation method. Options are sum, count, mean, std, median, min and max.
Can also give in custom function (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.binned_statistic.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.binned_statistic.html</a>)
:param fwhm: fwhm distance of gaussian kernel in um
:param brain_atlas: AllenAtlas object
:param ax: optional axis object to plot on</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.compute_volume_from_points">
<span class="sig-name descname"><span class="pre">compute_volume_from_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ba</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#compute_volume_from_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.compute_volume_from_points" title="Link to this definition"></a></dt>
<dd><p>Creates a 3D volume with xyz points placed in corresponding voxel in volume. Points that fall into the same voxel within the
volume are aggregated according to the method specified in aggr. Gaussian smoothing with a 3D kernel with distance specified
by fwhm (full width half max) argument is applied. If fwhm = 0, no gaussian smoothing is applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> – 3 column array of xyz coordinates of points in metres</p></li>
<li><p><strong>values</strong> – 1 column array of values per xyz coordinates, if no values are given the sum of xyz points in each voxel is</p></li>
</ul>
</dd>
</dl>
<p>returned
:param aggr: aggregation method. Options are sum, count, mean, std, median, min and max. Can also give in custom function
(<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.binned_statistic.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.binned_statistic.html</a>)
:param fwhm: full width at half maximum of gaussian kernel in um
:param ba: AllenAtlas object
:return:</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.plot_scalar_on_barplot">
<span class="sig-name descname"><span class="pre">plot_scalar_on_barplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acronyms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_regions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#plot_scalar_on_barplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.plot_scalar_on_barplot" title="Link to this definition"></a></dt>
<dd><p>Function to plot scalar value per allen region on a bar plot. If order=True, the acronyms and values are reordered
according to the order defined in the Allen structure tree</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acronyms</strong> (<em>numpy.array</em>) – A 1D array of acronyms</p></li>
<li><p><strong>values</strong> (<em>numpy.array</em>) – A 1D array of values corresponding to each acronym in the acronyms array</p></li>
<li><p><strong>errors</strong> (<em>numpy.array</em>) – A 1D array of error values corresponding to each acronym in the acronyms array</p></li>
<li><p><strong>order</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to order the acronyms according to the order defined by the Allen structure tree</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – An axis object to plot onto.</p></li>
<li><p><strong>brain_regions</strong> (<a class="reference internal" href="iblatlas.regions.html#iblatlas.regions.BrainRegions" title="iblatlas.regions.BrainRegions"><em>iblatlas.regions.BrainRegions</em></a>) – A brain regions object</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure</em>) – The plotted figure</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – The plotted axes.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.plot_swanson_vector">
<span class="sig-name descname"><span class="pre">plot_swanson_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acronyms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hemisphere</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">br</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'landscape'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'silver'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'top'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#plot_swanson_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.plot_swanson_vector" title="Link to this definition"></a></dt>
<dd><p>Function to plot scalar value per allen region on the swanson projection. Plots on a vecortised version of the
swanson projection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acronyms</strong> (<em>numpy.array</em>) – A 1D array of acronyms or atlas ids</p></li>
<li><p><strong>values</strong> (<em>numpy.array</em>) – A 1D array of values corresponding to each acronym in the acronyms array</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – An axis object to plot onto.</p></li>
<li><p><strong>hemisphere</strong> (<em>{'left'</em><em>, </em><em>'right'</em><em>, </em><em>'both'</em><em>, </em><em>'mirror'}</em>) – The hemisphere to display.</p></li>
<li><p><strong>br</strong> (<a class="reference internal" href="iblatlas.regions.html#iblatlas.regions.BrainRegions" title="iblatlas.regions.BrainRegions"><em>iblatlas.regions.BrainRegions</em></a>) – A brain regions object.</p></li>
<li><p><strong>orientation</strong> (<em>{landscape'</em><em>, </em><em>'portrait'}</em><em>, </em><em>default='landscape'</em>) – The plot orientation.</p></li>
<li><p><strong>empty_color</strong> (<em>str</em><em>, </em><em>tuple</em><em> of </em><em>int</em><em>, </em><em>default='silver'</em>) – The greyscale matplotlib color code or an RGBA int8 tuple defining the filling of brain
regions not provided.</p></li>
<li><p><strong>vmin</strong> (<em>float</em>) – Minimum value to restrict the colormap</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – Maximum value to restrict the colormap</p></li>
<li><p><strong>cmap</strong> (<em>string</em>) – matplotlib named colormap to use</p></li>
<li><p><strong>annotate</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If true, labels the regions with acronyms.</p></li>
<li><p><strong>annotate_n</strong> (<em>int</em>) – The number of regions to annotate</p></li>
<li><p><strong>annotate_order</strong> (<em>{'top'</em><em>, </em><em>'bottom'}</em>) – If annotate_n is specified, whether to annotate the n regions with the highest (top) or lowest (bottom) values</p></li>
<li><p><strong>annotate_list</strong> (<em>numpy.array</em><em> of </em><em>list</em>) – List of regions to annotate, if this is provided, if overwrites annotate_n and annotate_order</p></li>
<li><p><strong>mask</strong> (<em>numpy.array</em><em> or </em><em>list</em>) – List of regions to apply a mask to (fill them with a specific color)</p></li>
<li><p><strong>mask_color</strong> (<em>string</em><em>, </em><em>tuple</em><em> or </em><em>list</em>) – Color for the mask</p></li>
<li><p><strong>fontsize</strong> (<em>int</em>) – The annotation font size in points.</p></li>
<li><p><strong>**kwargs</strong> – See plot_polygon and plot_polygon_with_hole.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The plotted axes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.pyplot.Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.plot_swanson">
<span class="sig-name descname"><span class="pre">plot_swanson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acronyms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hemisphere</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">br</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'landscape'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'silver'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#plot_swanson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.plot_swanson" title="Link to this definition"></a></dt>
<dd><p>Displays the 2D image corresponding to the swanson flatmap.</p>
<p>This case is different from the others in the sense that only a region maps to another regions,
there is no correspondence to the spatial 3D coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>acronyms</strong> (<em>numpy.array</em>) – A 1D array of acronyms or atlas ids</p></li>
<li><p><strong>values</strong> (<em>numpy.array</em>) – A 1D array of values corresponding to each acronym in the acronyms array</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – An axis object to plot onto.</p></li>
<li><p><strong>hemisphere</strong> (<em>{'left'</em><em>, </em><em>'right'</em><em>, </em><em>'both'</em><em>, </em><em>'mirror'}</em>) – The hemisphere to display.</p></li>
<li><p><strong>br</strong> (<a class="reference internal" href="iblatlas.regions.html#iblatlas.regions.BrainRegions" title="iblatlas.regions.BrainRegions"><em>iblatlas.regions.BrainRegions</em></a>) – A brain regions object.</p></li>
<li><p><strong>orientation</strong> (<em>{landscape'</em><em>, </em><em>'portrait'}</em><em>, </em><em>default='landscape'</em>) – The plot orientation.</p></li>
<li><p><strong>empty_color</strong> (<em>str</em><em>, </em><em>tuple</em><em> of </em><em>int</em><em>, </em><em>default='silver'</em>) – The greyscale matplotlib color code or an RGBA int8 tuple defining the filling of brain
regions not provided.</p></li>
<li><p><strong>vmin</strong> (<em>float</em>) – Minimum value to restrict the colormap</p></li>
<li><p><strong>vmax</strong> (<em>float</em>) – Maximum value to restrict the colormap</p></li>
<li><p><strong>cmap</strong> (<em>string</em>) – matplotlib named colormap to use</p></li>
<li><p><strong>annotate</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If true, labels the regions with acronyms.</p></li>
<li><p><strong>**kwargs</strong> – See matplotlib.pyplot.imshow.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The plotted axes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.pyplot.Axes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="iblatlas.plots.annotate_swanson">
<span class="sig-name descname"><span class="pre">annotate_swanson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acronyms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'landscape'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">br</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thres</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/iblatlas/plots.html#annotate_swanson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#iblatlas.plots.annotate_swanson" title="Link to this definition"></a></dt>
<dd><p>Display annotations on a Swanson flatmap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.Axes</em>) – An axis object to plot onto.</p></li>
<li><p><strong>acronyms</strong> (<em>array_like</em>) – A list or numpy array of acronyms or Allen region IDs. If None plot all acronyms.</p></li>
<li><p><strong>orientation</strong> (<em>{landscape'</em><em>, </em><em>'portrait'}</em><em>, </em><em>default='landscape'</em>) – The plot orientation.</p></li>
<li><p><strong>br</strong> (<a class="reference internal" href="iblatlas.regions.html#iblatlas.regions.BrainRegions" title="iblatlas.regions.BrainRegions"><em>iblatlas.regions.BrainRegions</em></a>) – A brain regions object.</p></li>
<li><p><strong>thres</strong> (<em>int</em><em>, </em><em>default=20000</em>) – The number of pixels above which a region is labelled.</p></li>
<li><p><strong>**kwargs</strong> – See matplotlib.pyplot.Axes.annotate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="iblatlas.genomics.merfish.html" class="btn btn-neutral float-left" title="iblatlas.genomics.merfish" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="iblatlas.regions.html" class="btn btn-neutral float-right" title="iblatlas.regions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, International Brain Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>