<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>brainbox.io.one &mdash; IBL Library  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="brainbox.io.spikeglx" href="brainbox.io.spikeglx.html" />
    <link rel="prev" title="brainbox.io" href="brainbox.io.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> IBL Library
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The Open Neurophysiology Environment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/one_quickstart.html">ONE Quick Start</a></li>
<li class="toctree-l1"><a class="reference external" href="https://int-brain-lab.github.io/ONE/">Full documentation Website for ONE</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DataJoint</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dj_docs/dj_introduction.html">Introduction to DataJoint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dj_docs/dj_public.html">Publicly available IBL data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dj_docs/dj_credentials.html">DataJoint credentials for internal IBL users</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Public</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../public_docs/public_introduction.html">Publicly available IBL data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/data_release_repro_ephys.html">Data Release - Reproducible Ephys Paper</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Exploring IBL Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../loading_examples.html">Loading Data</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02_installation.html">Unified Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09_contribution.html">How to contribute</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples &amp; Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../atlas_examples.html">Atlas Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks_external/docs_wheel_moves.html">Working with wheel data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/dj_intro/dj_intro.html">Datajoint Introductory Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/dj_basics/dj_basics.html">Exploring the IBL Data Pipeline</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../010_api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ibllib.html">ibllib</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="brainbox.html">brainbox</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="brainbox.atlas.html">brainbox.atlas</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.behavior.html">brainbox.behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.core.html">brainbox.core</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.ephys_plots.html">brainbox.ephys_plots</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="brainbox.io.html">brainbox.io</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">brainbox.io.one</a></li>
<li class="toctree-l4"><a class="reference internal" href="brainbox.io.spikeglx.html">brainbox.io.spikeglx</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.lfp.html">brainbox.lfp</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.metrics.html">brainbox.metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.modeling.html">brainbox.modeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.plot.html">brainbox.plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.plot_base.html">brainbox.plot_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.population.html">brainbox.population</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.processing.html">brainbox.processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.quality.html">brainbox.quality</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.singlecell.html">brainbox.singlecell</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.spike_features.html">brainbox.spike_features</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.task.html">brainbox.task</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.tests.html">brainbox.tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="brainbox.video.html">brainbox.video</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Detailed Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">IBL Library</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../010_api_reference.html">API Reference</a> &raquo;</li>
          <li><a href="brainbox.html">brainbox</a> &raquo;</li>
          <li><a href="brainbox.io.html">brainbox.io</a> &raquo;</li>
      <li>brainbox.io.one</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_autosummary/brainbox.io.one.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="module-brainbox.io.one">
<span id="brainbox-io-one"></span><h1>brainbox.io.one<a class="headerlink" href="#module-brainbox.io.one" title="Permalink to this headline"></a></h1>
<p>Functions for loading IBL ephys and trial data using the Open Neurophysiology Environment.</p>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.io.one.channel_locations_interpolation" title="brainbox.io.one.channel_locations_interpolation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">channel_locations_interpolation</span></code></a></p></td>
<td><p>oftentimes the channel map for different spike sorters may be different so interpolate the alignment onto if there is no spike sorting in the base folder, the alignment doesn't have the localCoordinates field so we reconstruct from the Neuropixel map.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.io.one.load_channel_locations" title="brainbox.io.one.load_channel_locations"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_channel_locations</span></code></a></p></td>
<td><p>Load the brain locations of each channel for a given session/probe</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.io.one.load_channels_from_insertion" title="brainbox.io.one.load_channels_from_insertion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_channels_from_insertion</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.io.one.load_ephys_session" title="brainbox.io.one.load_ephys_session"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_ephys_session</span></code></a></p></td>
<td><p>From an eid, hits the Alyx database and downloads a standard default set of dataset types From a local session Path (pathlib.Path), loads a standard default set of dataset types  to perform analysis:     'clusters.channels',     'clusters.depths',     'clusters.metrics',     'spikes.clusters',     'spikes.times',     'probes.description'</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.io.one.load_lfp" title="brainbox.io.one.load_lfp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_lfp</span></code></a></p></td>
<td><p>TODO Verify works From an eid, hits the Alyx database and downloads the standard set of datasets needed for LFP</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.io.one.load_passive_rfmap" title="brainbox.io.one.load_passive_rfmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_passive_rfmap</span></code></a></p></td>
<td><p>For a given eid load in the passive receptive field mapping protocol data</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.io.one.load_spike_sorting" title="brainbox.io.one.load_spike_sorting"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_spike_sorting</span></code></a></p></td>
<td><p>From an eid, loads spikes and clusters for all probes The following set of dataset types are loaded:     'clusters.channels',     'clusters.depths',     'clusters.metrics',     'spikes.clusters',     'spikes.times',     'probes.description'</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.io.one.load_spike_sorting_fast" title="brainbox.io.one.load_spike_sorting_fast"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_spike_sorting_fast</span></code></a></p></td>
<td><p>From an eid, loads spikes and clusters for all probes The following set of dataset types are loaded:     'clusters.channels',     'clusters.depths',     'clusters.metrics',     'spikes.clusters',     'spikes.times',     'probes.description'</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.io.one.load_spike_sorting_with_channel" title="brainbox.io.one.load_spike_sorting_with_channel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_spike_sorting_with_channel</span></code></a></p></td>
<td><p>For a given eid, get spikes, clusters and channels information, and merges clusters and channels information before returning all three variables.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.io.one.load_trials_df" title="brainbox.io.one.load_trials_df"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_trials_df</span></code></a></p></td>
<td><p>Generate a pandas dataframe of per-trial timing information about a given session.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.io.one.load_wheel_reaction_times" title="brainbox.io.one.load_wheel_reaction_times"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_wheel_reaction_times</span></code></a></p></td>
<td><p>Return the calculated reaction times for session.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#brainbox.io.one.merge_clusters_channels" title="brainbox.io.one.merge_clusters_channels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_clusters_channels</span></code></a></p></td>
<td><p>Takes (default and any extra) values in given keys from channels and assign them to clusters.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Classes</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#brainbox.io.one.SpikeSortingLoader" title="brainbox.io.one.SpikeSortingLoader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpikeSortingLoader</span></code></a></p></td>
<td><p>Object that will load spike sorting data for a given probe insertion. This class can be instantiated in several manners - With Alyx database probe id:         SpikeSortingLoader(pid=pid, one=one) - With Alyx database eic and probe name:         SpikeSortingLoader(eid=eid, pname='probe00', one=one) - From a local session and probe name:         SpikeSortingLoader(session_path=session_path, pname='probe00') NB: When no ONE instance is passed, any datasets that are loaded will not be recorded.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="brainbox.io.one.load_lfp">
<span class="sig-name descname"><span class="pre">load_lfp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#load_lfp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.load_lfp" title="Permalink to this definition"></a></dt>
<dd><p>TODO Verify works
From an eid, hits the Alyx database and downloads the standard set of datasets
needed for LFP</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eid</strong> – </p></li>
<li><p><strong>dataset_types</strong> – additional dataset types to add to the list</p></li>
<li><p><strong>open</strong> – if True, spikeglx readers are opened</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>spikeglx.Reader</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.io.one.channel_locations_interpolation">
<span class="sig-name descname"><span class="pre">channel_locations_interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channels_aligned</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_regions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#channel_locations_interpolation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.channel_locations_interpolation" title="Permalink to this definition"></a></dt>
<dd><p>oftentimes the channel map for different spike sorters may be different so interpolate the alignment onto
if there is no spike sorting in the base folder, the alignment doesn’t have the localCoordinates field
so we reconstruct from the Neuropixel map. This only happens for early pykilosort sorts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channels_aligned</strong> – <p>Bunch or dictionary of aligned channels containing at least keys
‘localCoordinates’, ‘mlapdv’ and ‘brainLocationIds_ccf_2017’
OR</p>
<blockquote>
<div><p>’x’, ‘y’, ‘z’, ‘acronym’, ‘axial_um’
those are the guide for the interpolation</p>
</div></blockquote>
</p></li>
<li><p><strong>channels</strong> – Bunch or dictionary of aligned channels containing at least keys ‘localCoordinates’</p></li>
<li><p><strong>brain_regions</strong> – <p>None (default) or ibllib.atlas.BrainRegions object
if None will return a dict with keys ‘localCoordinates’, ‘mlapdv’, ‘brainLocationIds_ccf_2017
if a brain region object is provided, outputts a dict with keys</p>
<blockquote>
<div><p>’x’, ‘y’, ‘z’, ‘acronym’, ‘atlas_id’, ‘axial_um’, ‘lateral_um’</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bunch or dictionary of channels with brain coordinates keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.io.one.load_channel_locations">
<span class="sig-name descname"><span class="pre">load_channel_locations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aligned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_atlas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#load_channel_locations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.load_channel_locations" title="Permalink to this definition"></a></dt>
<dd><p>Load the brain locations of each channel for a given session/probe</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eid</strong> (<em>[</em><em>str</em><em>, </em><em>UUID</em><em>, </em><em>Path</em><em>, </em><em>dict</em><em>]</em>) – Experiment session identifier; may be a UUID, URL, experiment reference string
details dict or Path</p></li>
<li><p><strong>probe</strong> (<em>[</em><em>str</em><em>, </em><em>list of str</em><em>]</em>) – The probe label(s), e.g. ‘probe01’</p></li>
<li><p><strong>one</strong> (<a class="reference external" href="https://int-brain-lab.github.io/ONE/_autosummary/one.api.html#one.api.OneAlyx" title="(in ONE)"><em>one.api.OneAlyx</em></a>) – An instance of ONE (shouldn’t be in ‘local’ mode)</p></li>
<li><p><strong>aligned</strong> (<em>bool</em>) – Whether to get the latest user aligned channel when not resolved or use histology track</p></li>
<li><p><strong>brain_atlas</strong> (<em>ibllib.atlas.BrainAtlas</em>) – Brain atlas object (default: Allen atlas)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>dict of one.alf.io.AlfBunch</em> – A dict with probe labels as keys, contains channel locations with keys (‘acronym’,
‘atlas_id’, ‘x’, ‘y’, ‘z’).  Atlas IDs non-lateralized.</p></li>
<li><p><strong>optional</strong> (<em>string ‘resolved’, ‘aligned’, ‘traced’ or ‘’</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.io.one.load_spike_sorting_fast">
<span class="sig-name descname"><span class="pre">load_spike_sorting_fast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spike_sorter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">revision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_regions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nested</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_collection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#load_spike_sorting_fast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.load_spike_sorting_fast" title="Permalink to this definition"></a></dt>
<dd><p>From an eid, loads spikes and clusters for all probes
The following set of dataset types are loaded:</p>
<blockquote>
<div><p>‘clusters.channels’,
‘clusters.depths’,
‘clusters.metrics’,
‘spikes.clusters’,
‘spikes.times’,
‘probes.description’</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eid</strong> – experiment UUID or pathlib.Path of the local session</p></li>
<li><p><strong>one</strong> – an instance of OneAlyx</p></li>
<li><p><strong>probe</strong> – name of probe to load in, if not given all probes for session will be loaded</p></li>
<li><p><strong>dataset_types</strong> – additional spikes/clusters objects to add to the standard default list</p></li>
<li><p><strong>spike_sorter</strong> – name of the spike sorting you want to load (None for default)</p></li>
<li><p><strong>collection</strong> – name of the spike sorting collection to load - exclusive with spike sorter name ex: “alf/probe00”</p></li>
<li><p><strong>brain_regions</strong> – ibllib.atlas.regions.BrainRegions object - will label acronyms if provided</p></li>
<li><p><strong>nested</strong> – if a single probe is required, do not output a dictionary with the probe name as key</p></li>
<li><p><strong>return_collection</strong> – (False) if True, will return the collection used to load</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>spikes, clusters, channels (dict of bunch, 1 bunch per probe)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.io.one.load_spike_sorting">
<span class="sig-name descname"><span class="pre">load_spike_sorting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spike_sorter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">revision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_regions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_collection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#load_spike_sorting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.load_spike_sorting" title="Permalink to this definition"></a></dt>
<dd><p>From an eid, loads spikes and clusters for all probes
The following set of dataset types are loaded:</p>
<blockquote>
<div><p>‘clusters.channels’,
‘clusters.depths’,
‘clusters.metrics’,
‘spikes.clusters’,
‘spikes.times’,
‘probes.description’</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eid</strong> – experiment UUID or pathlib.Path of the local session</p></li>
<li><p><strong>one</strong> – an instance of OneAlyx</p></li>
<li><p><strong>probe</strong> – name of probe to load in, if not given all probes for session will be loaded</p></li>
<li><p><strong>dataset_types</strong> – additional spikes/clusters objects to add to the standard default list</p></li>
<li><p><strong>spike_sorter</strong> – name of the spike sorting you want to load (None for default)</p></li>
<li><p><strong>brain_regions</strong> – ibllib.atlas.regions.BrainRegions object - will label acronyms if provided</p></li>
</ul>
</dd>
</dl>
<p>:param return_collection:(bool - False) if True, returns the collection for loading the data
:return: spikes, clusters (dict of bunch, 1 bunch per probe)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.io.one.load_spike_sorting_with_channel">
<span class="sig-name descname"><span class="pre">load_spike_sorting_with_channel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aligned</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spike_sorter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_atlas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nested</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_collection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#load_spike_sorting_with_channel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.load_spike_sorting_with_channel" title="Permalink to this definition"></a></dt>
<dd><p>For a given eid, get spikes, clusters and channels information, and merges clusters
and channels information before returning all three variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eid</strong> (<em>[</em><em>str</em><em>, </em><em>UUID</em><em>, </em><em>Path</em><em>, </em><em>dict</em><em>]</em>) – Experiment session identifier; may be a UUID, URL, experiment reference string
details dict or Path</p></li>
<li><p><strong>one</strong> (<a class="reference external" href="https://int-brain-lab.github.io/ONE/_autosummary/one.api.html#one.api.OneAlyx" title="(in ONE)"><em>one.api.OneAlyx</em></a>) – An instance of ONE (shouldn’t be in ‘local’ mode)</p></li>
<li><p><strong>probe</strong> (<em>[</em><em>str</em><em>, </em><em>list of str</em><em>]</em>) – The probe label(s), e.g. ‘probe01’</p></li>
<li><p><strong>aligned</strong> (<em>bool</em>) – Whether to get the latest user aligned channel when not resolved or use histology track</p></li>
<li><p><strong>dataset_types</strong> (<em>list of str</em>) – Optional additional spikes/clusters objects to add to the standard default list</p></li>
<li><p><strong>spike_sorter</strong> (<em>str</em>) – Name of the spike sorting you want to load (None for default which is pykilosort if it’s
available otherwise the default MATLAB kilosort)</p></li>
<li><p><strong>brain_atlas</strong> (<em>ibllib.atlas.BrainAtlas</em>) – Brain atlas object (default: Allen atlas)</p></li>
<li><p><strong>return_collection</strong> (<em>bool</em>) – Returns an extra argument with the collection chosen</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>spikes</strong> (<em>dict of one.alf.io.AlfBunch</em>) – A dict with probe labels as keys, contains bunch(es) of spike data for the provided
session and spike sorter, with keys (‘clusters’, ‘times’)</p></li>
<li><p><strong>clusters</strong> (<em>dict of one.alf.io.AlfBunch</em>) – A dict with probe labels as keys, contains bunch(es) of cluster data, with keys
(‘channels’, ‘depths’, ‘metrics’)</p></li>
<li><p><strong>channels</strong> (<em>dict of one.alf.io.AlfBunch</em>) – A dict with probe labels as keys, contains channel locations with keys (‘acronym’,
‘atlas_id’, ‘x’, ‘y’, ‘z’).  Atlas IDs non-lateralized.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.io.one.load_ephys_session">
<span class="sig-name descname"><span class="pre">load_ephys_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#load_ephys_session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.load_ephys_session" title="Permalink to this definition"></a></dt>
<dd><p>From an eid, hits the Alyx database and downloads a standard default set of dataset types
From a local session Path (pathlib.Path), loads a standard default set of dataset types</p>
<blockquote>
<div><dl class="simple">
<dt>to perform analysis:</dt><dd><p>‘clusters.channels’,
‘clusters.depths’,
‘clusters.metrics’,
‘spikes.clusters’,
‘spikes.times’,
‘probes.description’</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eid</strong> (<em>[</em><em>str</em><em>, </em><em>UUID</em><em>, </em><em>Path</em><em>, </em><em>dict</em><em>]</em>) – Experiment session identifier; may be a UUID, URL, experiment reference string
details dict or Path</p></li>
<li><p><strong>one</strong> (<em>oneibl.one.OneAlyx</em><em>, </em><em>optional</em>) – ONE object to use for loading. Will generate internal one if not used, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>spikes</strong> (<em>dict of one.alf.io.AlfBunch</em>) – A dict with probe labels as keys, contains bunch(es) of spike data for the provided
session and spike sorter, with keys (‘clusters’, ‘times’)</p></li>
<li><p><strong>clusters</strong> (<em>dict of one.alf.io.AlfBunch</em>) – A dict with probe labels as keys, contains bunch(es) of cluster data, with keys
(‘channels’, ‘depths’, ‘metrics’)</p></li>
<li><p><strong>trials</strong> (<em>one.alf.io.AlfBunch of numpy.ndarray</em>) – The session trials data</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.io.one.merge_clusters_channels">
<span class="sig-name descname"><span class="pre">merge_clusters_channels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dic_clus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys_to_add_extra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#merge_clusters_channels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.merge_clusters_channels" title="Permalink to this definition"></a></dt>
<dd><p>Takes (default and any extra) values in given keys from channels and assign them to clusters.
If channels does not contain any data, the new keys are added to clusters but left empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dic_clus</strong> (<em>dict of one.alf.io.AlfBunch</em>) – 1 bunch per probe, containing cluster information</p></li>
<li><p><strong>channels</strong> (<em>dict of one.alf.io.AlfBunch</em>) – 1 bunch per probe, containing channels bunch with keys (‘acronym’, ‘atlas_id’, ‘x’, ‘y’, z’, ‘localCoordinates’)</p></li>
<li><p><strong>keys_to_add_extra</strong> (<em>list of str</em>) – Any extra keys to load into channels bunches</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>clusters (1 bunch per probe) with new keys values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of one.alf.io.AlfBunch</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.io.one.load_passive_rfmap">
<span class="sig-name descname"><span class="pre">load_passive_rfmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#load_passive_rfmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.load_passive_rfmap" title="Permalink to this definition"></a></dt>
<dd><p>For a given eid load in the passive receptive field mapping protocol data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eid</strong> (<em>[</em><em>str</em><em>, </em><em>UUID</em><em>, </em><em>Path</em><em>, </em><em>dict</em><em>]</em>) – Experiment session identifier; may be a UUID, URL, experiment reference string
details dict or Path</p></li>
<li><p><strong>one</strong> (<em>oneibl.one.OneAlyx</em><em>, </em><em>optional</em>) – An instance of ONE (may be in ‘local’ - offline - mode)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Passive receptive field mapping data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://int-brain-lab.github.io/ONE/_autosummary/one.alf.io.html#one.alf.io.AlfBunch" title="(in ONE)">one.alf.io.AlfBunch</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.io.one.load_wheel_reaction_times">
<span class="sig-name descname"><span class="pre">load_wheel_reaction_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#load_wheel_reaction_times"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.load_wheel_reaction_times" title="Permalink to this definition"></a></dt>
<dd><p>Return the calculated reaction times for session.  Reaction times are defined as the time
between the go cue (onset tone) and the onset of the first substantial wheel movement.   A
movement is considered sufficiently large if its peak amplitude is at least 1/3rd of the
distance to threshold (~0.1 radians).</p>
<p>Negative times mean the onset of the movement occurred before the go cue.  Nans may occur if
there was no detected movement withing the period, or when the goCue_times or feedback_times
are nan.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eid</strong> (<em>[</em><em>str</em><em>, </em><em>UUID</em><em>, </em><em>Path</em><em>, </em><em>dict</em><em>]</em>) – Experiment session identifier; may be a UUID, URL, experiment reference string
details dict or Path</p></li>
<li><p><strong>one</strong> (<a class="reference external" href="https://int-brain-lab.github.io/ONE/_autosummary/one.api.html#one.api.OneAlyx" title="(in ONE)"><em>one.api.OneAlyx</em></a><em>, </em><em>optional</em>) – one object to use for loading. Will generate internal one if not used, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>reaction times</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.io.one.load_trials_df">
<span class="sig-name descname"><span class="pre">load_trials_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_before</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_after</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_wheel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ret_abswheel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wheel_binsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">addtl_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#load_trials_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.load_trials_df" title="Permalink to this definition"></a></dt>
<dd><p>Generate a pandas dataframe of per-trial timing information about a given session.
Each row in the frame will correspond to a single trial, with timing values indicating timing
session-wide (i.e. time in seconds since session start). Can optionally return a resampled
wheel velocity trace of either the signed or absolute wheel velocity.</p>
<p>The resulting dataframe will have a new set of columns, trial_start and trial_end, which define
via t_before and t_after the span of time assigned to a given trial.
(useful for bb.modeling.glm)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eid</strong> (<em>[</em><em>str</em><em>, </em><em>UUID</em><em>, </em><em>Path</em><em>, </em><em>dict</em><em>]</em>) – Experiment session identifier; may be a UUID, URL, experiment reference string
details dict or Path</p></li>
<li><p><strong>one</strong> (<a class="reference external" href="https://int-brain-lab.github.io/ONE/_autosummary/one.api.html#one.api.OneAlyx" title="(in ONE)"><em>one.api.OneAlyx</em></a><em>, </em><em>optional</em>) – one object to use for loading. Will generate internal one if not used, by default None</p></li>
<li><p><strong>maxlen</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum trial length for inclusion in df. Trials where feedback - response is longer
than this value will not be included in the dataframe, by default None</p></li>
<li><p><strong>t_before</strong> (<em>float</em><em>, </em><em>optional</em>) – Time before stimulus onset to include for a given trial, as defined by the trial_start
column of the dataframe. If zero, trial_start will be identical to stimOn, by default 0.</p></li>
<li><p><strong>t_after</strong> (<em>float</em><em>, </em><em>optional</em>) – Time after feedback to include in the trail, as defined by the trial_end
column of the dataframe. If zero, trial_end will be identical to feedback, by default 0.</p></li>
<li><p><strong>ret_wheel</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the time-resampled wheel velocity trace, by default False</p></li>
<li><p><strong>ret_abswheel</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the time-resampled absolute wheel velocity trace, by default False</p></li>
<li><p><strong>wheel_binsize</strong> (<em>float</em><em>, </em><em>optional</em>) – Time bins to resample wheel velocity to, by default 0.02</p></li>
<li><p><strong>addtl_types</strong> (<em>list</em><em>, </em><em>optional</em>) – List of additional types from an ONE trials object to include in the dataframe. Must be
valid keys to the dict produced by one.load_object(eid, ‘trials’), by default empty.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dataframe with trial-wise information. Indices are the actual trial order in the original
data, preserved even if some trials do not meet the maxlen criterion. As a result will not
have a monotonic index. Has special columns trial_start and trial_end which define start
and end times via t_before and t_after</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="brainbox.io.one.load_channels_from_insertion">
<span class="sig-name descname"><span class="pre">load_channels_from_insertion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ba</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#load_channels_from_insertion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.load_channels_from_insertion" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SpikeSortingLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">one</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://int-brain-lab.github.io/ONE/_autosummary/one.api.html#one.api.One" title="(in ONE)"><span class="pre">one.api.One</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atlas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pathlib.Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collections</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datasets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">files</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">histology</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spike_sorting_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#SpikeSortingLoader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Object that will load spike sorting data for a given probe insertion.
This class can be instantiated in several manners
- With Alyx database probe id:</p>
<blockquote>
<div><p>SpikeSortingLoader(pid=pid, one=one)</p>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>With Alyx database eic and probe name:</dt><dd><p>SpikeSortingLoader(eid=eid, pname=’probe00’, one=one)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>From a local session and probe name:</dt><dd><p>SpikeSortingLoader(session_path=session_path, pname=’probe00’)</p>
</dd>
</dl>
</li>
</ul>
<p>NB: When no ONE instance is passed, any datasets that are loaded will not be recorded.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.one">
<span class="sig-name descname"><span class="pre">one</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://int-brain-lab.github.io/ONE/_autosummary/one.api.html#one.api.One" title="(in ONE)"><span class="pre">one.api.One</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.one" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.atlas">
<span class="sig-name descname"><span class="pre">atlas</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.atlas" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.pid">
<span class="sig-name descname"><span class="pre">pid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.pid" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.eid">
<span class="sig-name descname"><span class="pre">eid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.eid" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.pname">
<span class="sig-name descname"><span class="pre">pname</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.pname" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.session_path">
<span class="sig-name descname"><span class="pre">session_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.session_path" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.collections">
<span class="sig-name descname"><span class="pre">collections</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.collections" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.datasets">
<span class="sig-name descname"><span class="pre">datasets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.datasets" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.files">
<span class="sig-name descname"><span class="pre">files</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.files" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.collection">
<span class="sig-name descname"><span class="pre">collection</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.collection" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.histology">
<span class="sig-name descname"><span class="pre">histology</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.histology" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.spike_sorting_path">
<span class="sig-name descname"><span class="pre">spike_sorting_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.spike_sorting_path" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.download_spike_sorting_object">
<span class="sig-name descname"><span class="pre">download_spike_sorting_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spike_sorter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pykilosort'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#SpikeSortingLoader.download_spike_sorting_object"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.download_spike_sorting_object" title="Permalink to this definition"></a></dt>
<dd><p>Downloads an ALF object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – object name, str between ‘spikes’, ‘clusters’ or ‘channels’</p></li>
<li><p><strong>spike_sorter</strong> – (defaults to ‘pykilosort’)</p></li>
<li><p><strong>dataset_types</strong> – list of extra dataset types, for example [‘spikes.samples’]</p></li>
<li><p><strong>collection</strong> – string specifiying the collection, for example ‘alf/probe01/pykilosort’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.download_spike_sorting">
<span class="sig-name descname"><span class="pre">download_spike_sorting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#SpikeSortingLoader.download_spike_sorting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.download_spike_sorting" title="Permalink to this definition"></a></dt>
<dd><p>Downloads spikes, clusters and channels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spike_sorter</strong> – (defaults to ‘pykilosort’)</p></li>
<li><p><strong>dataset_types</strong> – list of extra dataset types</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.load_spike_sorting">
<span class="sig-name descname"><span class="pre">load_spike_sorting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#SpikeSortingLoader.load_spike_sorting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.load_spike_sorting" title="Permalink to this definition"></a></dt>
<dd><p>Loads spikes, clusters and channels</p>
<p>There could be several spike sorting collections, by default the loader will get the pykilosort collection</p>
<p>The channel locations can come from several sources, it will load the most advanced version of the histology available,
regardless of the spike sorting version loaded. The steps are (from most advanced to fresh out of the imaging):
-   alf: the final version of channel locations, same as resolved with the difference that data is on file
-   resolved: channel locations alignments have been agreed upon
-   aligned: channel locations have been aligned, but review or other alignments are pending, potentially not accurate
-   traced: the histology track has been recovered from microscopy, however the depths may not match, inaccurate data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spike_sorter</strong> – (defaults to ‘pykilosort’)</p></li>
<li><p><strong>dataset_types</strong> – list of extra dataset types</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.merge_clusters">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">merge_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spikes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clusters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/brainbox/io/one.html#SpikeSortingLoader.merge_clusters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.merge_clusters" title="Permalink to this definition"></a></dt>
<dd><p>merge metrics and channels info - optionally saves a clusters.pqt dataframe</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="brainbox.io.one.SpikeSortingLoader.url">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">url</span></span><a class="headerlink" href="#brainbox.io.one.SpikeSortingLoader.url" title="Permalink to this definition"></a></dt>
<dd><p>Gets flatiron URL for the session</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="brainbox.io.html" class="btn btn-neutral float-left" title="brainbox.io" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="brainbox.io.spikeglx.html" class="btn btn-neutral float-right" title="brainbox.io.spikeglx" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, International Brain Laboratory.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>